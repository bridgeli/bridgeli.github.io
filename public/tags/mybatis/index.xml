<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Mybatis on 分享技术带来的喜悦</title>
    <link>http://localhost:1313/tags/mybatis/</link>
    <description>Recent content in Mybatis on 分享技术带来的喜悦</description>
    <generator>Hugo -- 0.156.0</generator>
    <language>zh-cn</language>
    <lastBuildDate>Mon, 08 Jul 2019 03:30:12 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/mybatis/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>关于 MySQL 和 MyBatis 易错的几个点</title>
      <link>http://localhost:1313/posts/2019-07-08-%E5%85%B3%E4%BA%8E-mysql-%E5%92%8C-mybatis-%E6%98%93%E9%94%99%E7%9A%84%E5%87%A0%E4%B8%AA%E7%82%B9/</link>
      <pubDate>Mon, 08 Jul 2019 03:30:12 +0000</pubDate>
      <guid>http://localhost:1313/posts/2019-07-08-%E5%85%B3%E4%BA%8E-mysql-%E5%92%8C-mybatis-%E6%98%93%E9%94%99%E7%9A%84%E5%87%A0%E4%B8%AA%E7%82%B9/</guid>
      <description>&lt;p&gt;由于某些不可抗拒力原因，自从开博以来断更了一个月，昨天晚上突然发现竟然解封了，今天立即写一篇小文章感谢党感谢政府感谢人民。话说，这一周有一个实习的同学，在写一个小东西的时候，发现一个问题，排序没有生效，刚好之前我也看过另外一个问题，现在算是总结一下。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ORDER BY 不生效&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;代码大概就是：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
SELECT * FROM t ORDER BY &amp;#34;id DESC&amp;#34;;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;我们其实可以很明显的看出来这个 SQL 有问题，ORDER BY 的后面多了引号，关键是这个 SQL 报错吗？如果 id 是随便写的一个不存在的列报错吗？答案是都不报错，排序也不生效，大家可以测试一些，这有时候就比较坑了，具体为什么会出现这个错误，后面再说，先说第二个。&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;分页问题&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;代码如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
/**  
* 开始页码  
*/  
private String pageSize;  
/**  
* 分页量  
*/  
private String offset;

&amp;lt;if test=&amp;#34;pageSize != null&amp;#34;&amp;gt;  
&amp;lt;if test=&amp;#34;offset != null&amp;#34;&amp;gt;  
limit #{offset}, #{pageSize}  
&amp;lt;/if&amp;gt;  
&amp;lt;if test=&amp;#34;offset == null&amp;#34;&amp;gt;  
limit #{pageSize}  
&amp;lt;/if&amp;gt;  
&amp;lt;/if&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个错误就比较明显了，一般人也不会犯，为什么要单独说一下呢？因为某同事说，分页用 # 会出错，但是我记得我一直用 # 没问题啊，刚好在遇到上面这个问题的时候，顺便测试了一些，还真有错，奇怪啊，其实原因很简单，就是分页的对象的属性有误，我们知道分页的属性，一般都是用 Integer，这个地方却写了 String，真是没事找事啊，一般谁会这么写？个人认为除非脑子有病。下面看第三个问题，也是一个比较诡异的问题。&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;UPDATE&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
UPDATE t SET username = &amp;#34;BridgeLi&amp;#34; AND passwd = &amp;#34;BridgeLi&amp;#34; WHERE id = 1;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个 SQL 有问题吗？会报错吗？这个问题有时候真不太看得出来，其实也很明显，SET 后面的各个列应该是 “,” 相连，而这个用的是 AND，有时候脑子一抽，还真有可能写错。但是会报错吗？这个问题还真不好答复，因为这个 SQL 这么写，相当于：&lt;/p&gt;</description>
    </item>
    <item>
      <title>org.apache.ibatis.builder.IncompleteElementException: Could not find parameter map</title>
      <link>http://localhost:1313/posts/2018-06-02-org-apache-ibatis-builder-incompleteelementexception-could-not-find-parameter-map/</link>
      <pubDate>Sat, 02 Jun 2018 09:17:30 +0000</pubDate>
      <guid>http://localhost:1313/posts/2018-06-02-org-apache-ibatis-builder-incompleteelementexception-could-not-find-parameter-map/</guid>
      <description>&lt;p&gt;上周和同事一块开发一个功能模块，在开发中拉下来同事代码，在测试的时候，突然跑不通了，报错信息如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
org.apache.ibatis.builder.IncompleteElementException: Could not find parameter map java.util.Map

at org.apache.ibatis.builder.MapperBuilderAssistant.getStatementParameterMap(MapperBuilderAssistant.java:320)  
at org.apache.ibatis.builder.MapperBuilderAssistant.addMappedStatement(MapperBuilderAssistant.java:296)  
at org.apache.ibatis.builder.xml.XMLStatementBuilder.parseStatementNode(XMLStatementBuilder.java:109)  
at org.apache.ibatis.session.Configuration.buildAllStatements(Configuration.java:753)  
at org.apache.ibatis.session.Configuration.hasStatement(Configuration.java:723)  
at org.apache.ibatis.session.Configuration.hasStatement(Configuration.java:718)  
at org.apache.ibatis.binding.MapperMethod$SqlCommand.&amp;lt;init&amp;gt;(MapperMethod.java:201)  
at org.apache.ibatis.binding.MapperMethod.&amp;lt;init&amp;gt;(MapperMethod.java:48)  
at org.apache.ibatis.binding.MapperProxy.cachedMapperMethod(MapperProxy.java:59)  
at org.apache.ibatis.binding.MapperProxy.invoke(MapperProxy.java:52)  
at com.sun.proxy.$Proxy40.insertSelective(Unknown Source)  
at com.weidai.urge.service.disposition.BidDispositionOrderServiceTest.testInsertSelective(BidDispositionOrderServiceTest.java:48)  
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)  
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)  
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)  
at java.lang.reflect.Method.invoke(Method.java:606)  
at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:50)  
at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)  
at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:47)  
at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)  
at org.springframework.test.context.junit4.statements.RunBeforeTestMethodCallbacks.evaluate(RunBeforeTestMethodCallbacks.java:75)  
at org.springframework.test.context.junit4.statements.RunAfterTestMethodCallbacks.evaluate(RunAfterTestMethodCallbacks.java:86)  
at org.springframework.test.context.junit4.statements.SpringRepeat.evaluate(SpringRepeat.java:84)  
at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:325)  
at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:254)  
at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.runChild(SpringJUnit4ClassRunner.java:89)  
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:290)  
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:71)  
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:288)  
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:58)  
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:268)  
at org.springframework.test.context.junit4.statements.RunBeforeTestClassCallbacks.evaluate(RunBeforeTestClassCallbacks.java:61)  
at org.springframework.test.context.junit4.statements.RunAfterTestClassCallbacks.evaluate(RunAfterTestClassCallbacks.java:70)  
at org.junit.runners.ParentRunner.run(ParentRunner.java:363)  
at org.springframework.test.context.junit4.SpringJUnit4ClassRunner.run(SpringJUnit4ClassRunner.java:193)  
at org.junit.runner.JUnitCore.run(JUnitCore.java:137)  
at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:68)  
at com.intellij.rt.execution.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:51)  
at com.intellij.rt.execution.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:237)  
at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:70)  
Caused by: java.lang.IllegalArgumentException: Parameter Maps collection does not contain value for java.util.Map  
at org.apache.ibatis.session.Configuration$StrictMap.get(Configuration.java:853)  
at org.apache.ibatis.session.Configuration.getParameterMap(Configuration.java:625)  
at org.apache.ibatis.builder.MapperBuilderAssistant.getStatementParameterMap(MapperBuilderAssistant.java:318)  
&amp;amp;#8230; 39 more
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;看报错信息，也就是自己跑一个 junit test，测试批量插入，突然他就不行了，再看看自己写的批量插入没问题啊，我也没用 map，感觉好奇怪，就网上搜了一下这个问题，原来确实有问题，也确实在这个配置文件中，提示的错误也对，就是提示的位置不对。mybatis 中只要有任何一个地方报错，都无法通过。最后搜了一下发现是刚刚来下来的代码，同事新增了一个方法上将 parameterType 写成了 parameterMap 了&lt;/p&gt;</description>
    </item>
    <item>
      <title>介绍一个 Mybatis 插件：mybatis-generator-plugin</title>
      <link>http://localhost:1313/posts/2018-04-29-%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%AA-mybatis-%E6%8F%92%E4%BB%B6mybatis-generator-plugin/</link>
      <pubDate>Sun, 29 Apr 2018 09:37:55 +0000</pubDate>
      <guid>http://localhost:1313/posts/2018-04-29-%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%AA-mybatis-%E6%8F%92%E4%BB%B6mybatis-generator-plugin/</guid>
      <description>&lt;p&gt;在实际开发中，我们都是先建表，然后根据表生成对应的 Java 类，现在很流行的 ORMapping 框架是: Mybatis，所以我们需要生成 entity、mapper 和 xml，我们都知道有一个插件是：mybatis-generator，使用它就可以很方便的生成这些结构化的重复性基础性的代码，但是他有一个问题，生成的查询没有分页，所以很烦。然后我搜索了一些资料，重新封装了一下，重新命名为：mybatis-generator-plugin，具体源码放在了 GitHub 上：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
https://github.com/bridgeli/mybatis-generator-plugin
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;大家可以 clone 下来，deploy 到自己公司的私服，或者 install 到本地使用。具体就是在 pom 文件中。具体用法&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;在 pom 文件中添加如下内容：&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
&amp;lt;properties&amp;gt;  
&amp;lt;project.build.sourceEncoding&amp;gt;UTF-8&amp;lt;/project.build.sourceEncoding&amp;gt;  
&amp;lt;/properties&amp;gt;

&amp;lt;build&amp;gt;  
&amp;lt;plugins&amp;gt;  
&amp;lt;plugin&amp;gt;  
&amp;lt;groupId&amp;gt;org.mybatis.generator&amp;lt;/groupId&amp;gt;  
&amp;lt;artifactId&amp;gt;mybatis-generator-maven-plugin&amp;lt;/artifactId&amp;gt;  
&amp;lt;version&amp;gt;1.3.5&amp;lt;/version&amp;gt;  
&amp;lt;dependencies&amp;gt;  
&amp;lt;dependency&amp;gt;  
&amp;lt;groupId&amp;gt;cn.bridgeli&amp;lt;/groupId&amp;gt;  
&amp;lt;artifactId&amp;gt;mybatis-generator-plugin&amp;lt;/artifactId&amp;gt;  
&amp;lt;version&amp;gt;0.0.1-SNAPSHOT&amp;lt;/version&amp;gt;  
&amp;lt;/dependency&amp;gt;  
&amp;lt;/dependencies&amp;gt;  
&amp;lt;configuration&amp;gt;  
&amp;lt;verbose&amp;gt;true&amp;lt;/verbose&amp;gt;  
&amp;lt;overwrite&amp;gt;true&amp;lt;/overwrite&amp;gt;  
&amp;lt;configurationFile&amp;gt;src/main/resources/generatorConfig.xml&amp;lt;/configurationFile&amp;gt;  
&amp;lt;/configuration&amp;gt;  
&amp;lt;/plugin&amp;gt;  
&amp;lt;/plugins&amp;gt;  
&amp;lt;/build&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中：configurationFile 配置 generatorConfig.xml 文件的位置，我们生成的对应的文件，都是根据这个文件来的。所以第二步就是：&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;在对应的文件下添加该文件，它的模板如下：&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;  
&amp;lt;!DOCTYPE generatorConfiguration  
PUBLIC &amp;#34;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&amp;#34;  
&amp;#34;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&amp;#34;&amp;gt;

&amp;lt;generatorConfiguration&amp;gt;

&amp;lt;!&amp;amp;#8211; 请替换本地jar路径 此文件不要上传 &amp;amp;#8211;&amp;gt;  
&amp;lt;classPathEntry  
location=&amp;#34;/Users/bridgeli/.m2/repository/mysql/mysql-connector-java/5.1.33/mysql-connector-java-5.1.33.jar&amp;#34; /&amp;gt;

&amp;lt;!&amp;amp;#8211; mvn mybatis-generator:generate &amp;amp;#8211;&amp;gt;  
&amp;lt;context id=&amp;#34;oneHour&amp;#34;  
targetRuntime=&amp;#34;cn.bridgeli.plugin.IntrospectedTableMyBatis3ImplExt&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;suppressAllComments&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;useActualColumnNames&amp;#34; value=&amp;#34;false&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 格式化java代码 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;javaFormatter&amp;#34;  
value=&amp;#34;org.mybatis.generator.api.dom.DefaultJavaFormatter&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 格式化XML代码 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;xmlFormatter&amp;#34;  
value=&amp;#34;org.mybatis.generator.api.dom.DefaultXmlFormatter&amp;#34; /&amp;gt;

&amp;lt;!&amp;amp;#8211; 配置插件 &amp;amp;#8211;&amp;gt;  
&amp;lt;plugin type=&amp;#34;cn.bridgeli.mybatis.MySQLLimitPlugin&amp;#34;&amp;gt;&amp;lt;/plugin&amp;gt;

&amp;lt;commentGenerator&amp;gt;  
&amp;lt;!&amp;amp;#8211; 是否去除自动生成的注释 true：是 ： false:否 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;suppressAllComments&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;/commentGenerator&amp;gt;  
&amp;lt;!&amp;amp;#8211;数据库连接的信息：驱动类、连接地址、用户名、密码 &amp;amp;#8211;&amp;gt;  
&amp;lt;jdbcConnection driverClass=&amp;#34;com.mysql.jdbc.Driver&amp;#34;  
connectionURL=&amp;#34;jdbc:mysql://ip:port/databasename&amp;#34; userId=&amp;#34;username&amp;#34;  
password=&amp;#34;password&amp;#34;&amp;gt;  
&amp;lt;/jdbcConnection&amp;gt;

&amp;lt;javaTypeResolver&amp;gt;  
&amp;lt;property name=&amp;#34;forceBigDecimals&amp;#34; value=&amp;#34;false&amp;#34; /&amp;gt;  
&amp;lt;/javaTypeResolver&amp;gt;

&amp;lt;!&amp;amp;#8211; 配置model生成位置 &amp;amp;#8211;&amp;gt;  
&amp;lt;javaModelGenerator targetPackage=&amp;#34;cn.bridgeli.entity&amp;#34;  
targetProject=&amp;#34;src/main/java&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;enableSubPackages&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;trimStrings&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;/javaModelGenerator&amp;gt;

&amp;lt;!&amp;amp;#8211; 配置sqlmap生成位置 &amp;amp;#8211;&amp;gt;  
&amp;lt;sqlMapGenerator targetPackage=&amp;#34;cn/bridgeli/mapper&amp;#34;  
targetProject=&amp;#34;src/main/resources&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;enableSubPackages&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;/sqlMapGenerator&amp;gt;

&amp;lt;!&amp;amp;#8211; 配置mapper接口生成位置 &amp;amp;#8211;&amp;gt;  
&amp;lt;javaClientGenerator type=&amp;#34;XMLMAPPER&amp;#34;  
targetPackage=&amp;#34;cn.bridgeli.mapper&amp;#34; targetProject=&amp;#34;src/main/java&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;enableSubPackages&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;/javaClientGenerator&amp;gt;

&amp;lt;!&amp;amp;#8211; 配置表信息 &amp;amp;#8211;&amp;gt;  
&amp;lt;table tableName=&amp;#34;table_name&amp;#34; enableCountByExample=&amp;#34;true&amp;#34;  
domainObjectName=&amp;#34;DomainObjectName&amp;#34; enableDeleteByExample=&amp;#34;false&amp;#34;  
enableSelectByExample=&amp;#34;true&amp;#34; enableUpdateByExample=&amp;#34;true&amp;#34;&amp;gt;  
&amp;lt;generatedKey column=&amp;#34;ID&amp;#34; sqlStatement=&amp;#34;MySQL&amp;#34;  
identity=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;/table&amp;gt;  
&amp;lt;/context&amp;gt;

&amp;lt;/generatorConfiguration&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这里面需要说明就是：&lt;/p&gt;</description>
    </item>
    <item>
      <title>Spring加Mybatis实现MySQL数据库主从读写分离</title>
      <link>http://localhost:1313/posts/2015-05-03-spring%E5%8A%A0mybatis%E5%AE%9E%E7%8E%B0mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%BB%E4%BB%8E%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/</link>
      <pubDate>Sun, 03 May 2015 15:19:38 +0000</pubDate>
      <guid>http://localhost:1313/posts/2015-05-03-spring%E5%8A%A0mybatis%E5%AE%9E%E7%8E%B0mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%BB%E4%BB%8E%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/</guid>
      <description>&lt;p&gt;上周在一个同事的指点下，实现了Spring加Mybatis实现了MySQL的主从读写分离，今天记一下笔记，以供自己今后参考，下面是配置文件的写法。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;数据源也就是jdbc.properties，因为是主从读写分离，那么肯定有两个数据源了&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
jdbc.driver=org.mariadb.jdbc.Driver

\# 从库，只读  
slave.jdbc.url=jdbc:mariadb://xxx.xxx.xxx.xxx:3306/xxx?characterEncoding=UTF-8&amp;amp;zeroDateTimeBehavior=convertToNull&amp;amp;noAccessToProcedureBodies=true&amp;amp;autoReconnect=true  
slave.jdbc.username=xxx  
slave.jdbc.password=xxx

\# 主库，需要写  
master.jdbc.url=jdbc:mariadb://xxx.xxx.xxx.xxx:3306/xxx?characterEncoding=UTF-8&amp;amp;zeroDateTimeBehavior=convertToNull&amp;amp;noAccessToProcedureBodies=true&amp;amp;autoReconnect=true  
master.jdbc.username=xxx  
master.jdbc.password=xxx
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个非常简单和普通的区别不是很大，另外数据库的驱动是：mariadb，动下面就是第二个配置文件spring.xml&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;spring.xml&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;  
&amp;lt;beans xmlns=&amp;#34;http://www.springframework.org/schema/beans&amp;#34;  
xmlns:xsi=&amp;#34;http://www.w3.org/2001/XMLSchema-instance&amp;#34; xmlns:context=&amp;#34;http://www.springframework.org/schema/context&amp;#34;  
xsi:schemaLocation=&amp;#34;  
http://www.springframework.org/schema/beans  
http://www.springframework.org/schema/beans/spring-beans-3.0.xsd  
http://www.springframework.org/schema/context  
http://www.springframework.org/schema/context/spring-context-3.0.xsd  
&amp;#34;&amp;gt;

&amp;lt;!&amp;amp;#8211; Import properties file &amp;amp;#8211;&amp;gt;  
&amp;lt;context:property-placeholder location=&amp;#34;classpath:jdbc.properties&amp;#34; /&amp;gt;

&amp;lt;!&amp;amp;#8211; Auto Scan &amp;amp;#8211;&amp;gt;  
&amp;lt;context:component-scan base-package=&amp;#34;cn.bridgeli.demo&amp;#34; /&amp;gt;  
&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个文件很简单，有两个作用，①. 引入数据源配置文件；②. spring扫描的文件的路径&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;spring-mybatis.xml配置文件&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34;?&amp;gt;  
&amp;lt;beans xmlns=&amp;#34;http://www.springframework.org/schema/beans&amp;#34; xmlns:xsi=&amp;#34;http://www.w3.org/2001/XMLSchema-instance&amp;#34; xmlns:tx=&amp;#34;http://www.springframework.org/schema/tx&amp;#34; xmlns:aop=&amp;#34;http://www.springframework.org/schema/aop&amp;#34; xsi:schemaLocation=&amp;#34;  
http://www.springframework.org/schema/beans  
http://www.springframework.org/schema/beans/spring-beans-3.0.xsd  
http://www.springframework.org/schema/tx  
http://www.springframework.org/schema/tx/spring-tx-3.0.xsd  
http://www.springframework.org/schema/aop  
http://www.springframework.org/schema/aop/spring-aop-3.0.xsd  
&amp;#34;&amp;gt;

&amp;lt;bean id=&amp;#34;slaveDataSourceImpl&amp;#34; class=&amp;#34;com.jolbox.bonecp.BoneCPDataSource&amp;#34; destroy-method=&amp;#34;close&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;driverClass&amp;#34; value=&amp;#34;${jdbc.driver}&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;jdbcUrl&amp;#34; value=&amp;#34;${slave.jdbc.url}&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;username&amp;#34; value=&amp;#34;${slave.jdbc.username}&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;password&amp;#34; value=&amp;#34;${slave.jdbc.password}&amp;#34; /&amp;gt;

&amp;lt;!&amp;amp;#8211; 检查数据库连接池中空闲连接的间隔时间，单位是分，默认值：240，如果要取消则设置为0 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;idleConnectionTestPeriodInMinutes&amp;#34; value=&amp;#34;10&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 连接池中未使用的链接最大存活时间，单位是分，默认值：60，如果要永远存活设置为0 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;idleMaxAgeInMinutes&amp;#34; value=&amp;#34;10&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 每个分区最大的连接数 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;maxConnectionsPerPartition&amp;#34; value=&amp;#34;20&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 每个分区最小的连接数 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;minConnectionsPerPartition&amp;#34; value=&amp;#34;10&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 分区数 ，默认值2，最小1，推荐3-4，视应用而定 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;partitionCount&amp;#34; value=&amp;#34;3&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 每次去拿数据库连接的时候一次性要拿几个,默认值：2 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;acquireIncrement&amp;#34; value=&amp;#34;3&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 缓存prepared statements的大小，默认值：0 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;statementsCacheSize&amp;#34; value=&amp;#34;50&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 在做keep-alive的时候的SQL语句 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;connectionTestStatement&amp;#34; value=&amp;#34;select 1 from dual&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 在每次到数据库取连接的时候执行的SQL语句，只执行一次 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;initSQL&amp;#34; value=&amp;#34;select 1 from dual&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;closeConnectionWatch&amp;#34; value=&amp;#34;false&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;logStatementsEnabled&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;transactionRecoveryEnabled&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;/bean&amp;gt;

&amp;lt;bean id=&amp;#34;masterDataSourceImpl&amp;#34; class=&amp;#34;com.jolbox.bonecp.BoneCPDataSource&amp;#34; destroy-method=&amp;#34;close&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;driverClass&amp;#34; value=&amp;#34;${jdbc.driver}&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;jdbcUrl&amp;#34; value=&amp;#34;${master.jdbc.url}&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;username&amp;#34; value=&amp;#34;${master.jdbc.username}&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;password&amp;#34; value=&amp;#34;${master.jdbc.password}&amp;#34; /&amp;gt;

&amp;lt;!&amp;amp;#8211; 检查数据库连接池中空闲连接的间隔时间，单位是分，默认值：240，如果要取消则设置为0 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;idleConnectionTestPeriodInMinutes&amp;#34; value=&amp;#34;10&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 连接池中未使用的链接最大存活时间，单位是分，默认值：60，如果要永远存活设置为0 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;idleMaxAgeInMinutes&amp;#34; value=&amp;#34;10&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 每个分区最大的连接数 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;maxConnectionsPerPartition&amp;#34; value=&amp;#34;20&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 每个分区最小的连接数 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;minConnectionsPerPartition&amp;#34; value=&amp;#34;10&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 分区数 ，默认值2，最小1，推荐3-4，视应用而定 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;partitionCount&amp;#34; value=&amp;#34;3&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 每次去拿数据库连接的时候一次性要拿几个,默认值：2 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;acquireIncrement&amp;#34; value=&amp;#34;3&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 缓存prepared statements的大小，默认值：0 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;statementsCacheSize&amp;#34; value=&amp;#34;50&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 在做keep-alive的时候的SQL语句 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;connectionTestStatement&amp;#34; value=&amp;#34;select 1 from dual&amp;#34; /&amp;gt;  
&amp;lt;!&amp;amp;#8211; 在每次到数据库取连接的时候执行的SQL语句，只执行一次 &amp;amp;#8211;&amp;gt;  
&amp;lt;property name=&amp;#34;initSQL&amp;#34; value=&amp;#34;select 1 from dual&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;closeConnectionWatch&amp;#34; value=&amp;#34;false&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;logStatementsEnabled&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;transactionRecoveryEnabled&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;/bean&amp;gt;

&amp;lt;!&amp;amp;#8211; DataSource/Master &amp;amp;#8211;&amp;gt;  
&amp;lt;bean id=&amp;#34;masterDataSource&amp;#34;  
class=&amp;#34;org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;targetDataSource&amp;#34; ref=&amp;#34;masterDataSourceImpl&amp;#34; /&amp;gt;  
&amp;lt;/bean&amp;gt;  
&amp;lt;bean id=&amp;#34;masterTransactionManager&amp;#34;  
class=&amp;#34;org.springframework.jdbc.datasource.DataSourceTransactionManager&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;dataSource&amp;#34; ref=&amp;#34;masterDataSource&amp;#34; /&amp;gt;  
&amp;lt;/bean&amp;gt;  
&amp;lt;bean id=&amp;#34;masterTransactionTemplate&amp;#34;  
class=&amp;#34;org.springframework.transaction.support.TransactionTemplate&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;transactionManager&amp;#34; ref=&amp;#34;masterTransactionManager&amp;#34; /&amp;gt;  
&amp;lt;/bean&amp;gt;

&amp;lt;!&amp;amp;#8211; DataSource/Slave &amp;amp;#8211;&amp;gt;  
&amp;lt;bean id=&amp;#34;slaveDataSource&amp;#34;  
class=&amp;#34;org.springframework.jdbc.datasource.TransactionAwareDataSourceProxy&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;targetDataSource&amp;#34; ref=&amp;#34;slaveDataSourceImpl&amp;#34; /&amp;gt;  
&amp;lt;/bean&amp;gt;  
&amp;lt;bean id=&amp;#34;slaveTransactionManager&amp;#34;  
class=&amp;#34;org.springframework.jdbc.datasource.DataSourceTransactionManager&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;dataSource&amp;#34; ref=&amp;#34;slaveDataSource&amp;#34; /&amp;gt;  
&amp;lt;/bean&amp;gt;  
&amp;lt;bean id=&amp;#34;slaveTransactionTemplate&amp;#34;  
class=&amp;#34;org.springframework.transaction.support.TransactionTemplate&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;transactionManager&amp;#34; ref=&amp;#34;slaveTransactionManager&amp;#34; /&amp;gt;  
&amp;lt;/bean&amp;gt;

&amp;lt;!&amp;amp;#8211; Mybatis/Master &amp;amp;#8211;&amp;gt;  
&amp;lt;bean id=&amp;#34;masterSqlSessionFactory&amp;#34; class=&amp;#34;org.mybatis.spring.SqlSessionFactoryBean&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;dataSource&amp;#34; ref=&amp;#34;masterDataSource&amp;#34;&amp;gt;&amp;lt;/property&amp;gt;  
&amp;lt;property name=&amp;#34;configLocation&amp;#34; value=&amp;#34;classpath:mybatis.xml&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;typeAliasesPackage&amp;#34; value=&amp;#34;cn.bridgeli.demo.entity&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;mapperLocations&amp;#34;&amp;gt;  
&amp;lt;list&amp;gt;  
&amp;lt;value&amp;gt;classpath:cn/bridgeli/demo/mapper/master/*.xml&amp;lt;/value&amp;gt;  
&amp;lt;/list&amp;gt;  
&amp;lt;/property&amp;gt;  
&amp;lt;/bean&amp;gt;

&amp;lt;bean class=&amp;#34;org.mybatis.spring.mapper.MapperScannerConfigurer&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;basePackage&amp;#34; value=&amp;#34;cn.bridgeli.demo.mapper.master&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;sqlSessionFactoryBeanName&amp;#34; value=&amp;#34;masterSqlSessionFactory&amp;#34; /&amp;gt;  
&amp;lt;/bean&amp;gt;

&amp;lt;!&amp;amp;#8211; Mybatis/Slave &amp;amp;#8211;&amp;gt;  
&amp;lt;bean id=&amp;#34;slaveSqlSessionFactory&amp;#34; class=&amp;#34;org.mybatis.spring.SqlSessionFactoryBean&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;dataSource&amp;#34; ref=&amp;#34;slaveDataSource&amp;#34;&amp;gt;&amp;lt;/property&amp;gt;  
&amp;lt;property name=&amp;#34;configLocation&amp;#34; value=&amp;#34;classpath:mybatis.xml&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;typeAliasesPackage&amp;#34; value=&amp;#34;cn.bridgeli.demo.entity&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;mapperLocations&amp;#34;&amp;gt;  
&amp;lt;list&amp;gt;  
&amp;lt;value&amp;gt;classpath:cn/bridgeli/demo/mapper/slave/*.xml&amp;lt;/value&amp;gt;  
&amp;lt;/list&amp;gt;  
&amp;lt;/property&amp;gt;  
&amp;lt;/bean&amp;gt;

&amp;lt;bean class=&amp;#34;org.mybatis.spring.mapper.MapperScannerConfigurer&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;basePackage&amp;#34; value=&amp;#34;cn.bridgeli.demo.mapper.slave&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;sqlSessionFactoryBeanName&amp;#34; value=&amp;#34;slaveSqlSessionFactory&amp;#34; /&amp;gt;  
&amp;lt;/bean&amp;gt;

&amp;lt;!&amp;amp;#8211; Configuration transaction advice &amp;amp;#8211;&amp;gt;  
&amp;lt;tx:advice id=&amp;#34;txAdvice&amp;#34; transaction-manager=&amp;#34;masterTransactionManager&amp;#34;&amp;gt;  
&amp;lt;tx:attributes&amp;gt;  
&amp;lt;tx:method name=&amp;#34;add*&amp;#34; propagation=&amp;#34;REQUIRED&amp;#34; /&amp;gt;  
&amp;lt;tx:method name=&amp;#34;update*&amp;#34; propagation=&amp;#34;REQUIRED&amp;#34; /&amp;gt;  
&amp;lt;tx:method name=&amp;#34;delete*&amp;#34; propagation=&amp;#34;REQUIRED&amp;#34; /&amp;gt;  
&amp;lt;tx:method name=&amp;#34;get*&amp;#34; read-only=&amp;#34;true&amp;#34; propagation=&amp;#34;SUPPORTS&amp;#34; /&amp;gt;  
&amp;lt;tx:method name=&amp;#34;list*&amp;#34; read-only=&amp;#34;true&amp;#34; propagation=&amp;#34;SUPPORTS&amp;#34; /&amp;gt;  
&amp;lt;/tx:attributes&amp;gt;  
&amp;lt;/tx:advice&amp;gt;  
&amp;lt;!&amp;amp;#8211; Configuration transaction aspect &amp;amp;#8211;&amp;gt;  
&amp;lt;aop:config&amp;gt;  
&amp;lt;aop:pointcut id=&amp;#34;systemServicePointcut&amp;#34;  
expression=&amp;#34;execution(\* cn.bridgeli.demo.service.\*.*(..))&amp;#34; /&amp;gt;  
&amp;lt;aop:advisor advice-ref=&amp;#34;txAdvice&amp;#34; pointcut-ref=&amp;#34;systemServicePointcut&amp;#34; /&amp;gt;  
&amp;lt;/aop:config&amp;gt;

&amp;lt;/beans&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;这个配置文件老夫是完整的copy了下来，看起来也比较易懂，就不做解释了，需要说明的mybatis下那些dao的接口，分别对应cn.bridgeli.demo.mapper.master、cn.bridgeli.demo.mapper.slave，cn.bridgeli.demo.mapper.master下的这些dao接口是要写的，另一个是读的，这些接口对应的配置文件肯定就是他们对应的文件夹下面的xml文件了，在将来的项目中几乎可以照抄&lt;/p&gt;</description>
    </item>
    <item>
      <title>MyBatis下最好的分页实现：mybatis-paginator使用入门</title>
      <link>http://localhost:1313/posts/2015-04-26-mybatis%E4%B8%8B%E6%9C%80%E5%A5%BD%E7%9A%84%E5%88%86%E9%A1%B5%E5%AE%9E%E7%8E%B0mybatis-paginator%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/</link>
      <pubDate>Sun, 26 Apr 2015 15:10:02 +0000</pubDate>
      <guid>http://localhost:1313/posts/2015-04-26-mybatis%E4%B8%8B%E6%9C%80%E5%A5%BD%E7%9A%84%E5%88%86%E9%A1%B5%E5%AE%9E%E7%8E%B0mybatis-paginator%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8/</guid>
      <description>&lt;p&gt;前两天写一个项目，发现在MyBatis下一个最好的分页实现类库mybatis-paginator，今天就写一篇其入门教程供大家参考。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;先引入maven依赖&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
&amp;lt;dependency&amp;gt;  
&amp;lt;groupId&amp;gt;com.github.miemiedev&amp;lt;/groupId&amp;gt;  
&amp;lt;artifactId&amp;gt;mybatis-paginator&amp;lt;/artifactId&amp;gt;  
&amp;lt;version&amp;gt;1.2.15&amp;lt;/version&amp;gt;  
&amp;lt;/dependency&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;从这个依赖中，我们可以看到 1 他是mybatis的一个插件，2 其开源在GitHub上，感兴趣的可以去GitHub上搜源码看看，既然是mybatis的插件，下一步肯定就是和mybatis的集成了.&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;和mybatis集成&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;①. 新建一个mybatis.xml的配置文件，其内容如下：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
&amp;lt;?xml version=&amp;#34;1.0&amp;#34; encoding=&amp;#34;UTF-8&amp;#34; ?&amp;gt;  
&amp;lt;!DOCTYPE configuration PUBLIC &amp;#34;-//mybatis.org//DTD Config 3.0//EN&amp;#34; &amp;#34;http://mybatis.org/dtd/mybatis-3-config.dtd&amp;#34;&amp;gt;  
&amp;lt;configuration&amp;gt;  
&amp;lt;settings&amp;gt;  
&amp;lt;setting name=&amp;#34;cacheEnabled&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;setting name=&amp;#34;lazyLoadingEnabled&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;/settings&amp;gt;

&amp;lt;plugins&amp;gt;  
&amp;lt;plugin  
interceptor=&amp;#34;com.github.miemiedev.mybatis.paginator.OffsetLimitInterceptor&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;dialectClass&amp;#34;  
value=&amp;#34;com.github.miemiedev.mybatis.paginator.dialect.MySQLDialect&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;asyncTotalCount&amp;#34; value=&amp;#34;true&amp;#34; /&amp;gt;  
&amp;lt;/plugin&amp;gt;  
&amp;lt;/plugins&amp;gt;

&amp;lt;/configuration&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;②. 和spring集成，即在spring-mybatis.xml中引入该文件&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
&amp;amp;#8230;&amp;amp;#8230;

&amp;lt;bean id=&amp;#34;sqlSessionFactory&amp;#34; class=&amp;#34;org.mybatis.spring.SqlSessionFactoryBean&amp;#34;&amp;gt;  
&amp;lt;property name=&amp;#34;dataSource&amp;#34; ref=&amp;#34;dataSource&amp;#34;&amp;gt;&amp;lt;/property&amp;gt;  
&amp;lt;property name=&amp;#34;configLocation&amp;#34; value=&amp;#34;classpath:mybatis.xml&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;typeAliasesPackage&amp;#34; value=&amp;#34;cn.bridgeli.demo.entity&amp;#34; /&amp;gt;  
&amp;lt;property name=&amp;#34;mapperLocations&amp;#34; value=&amp;#34;classpath:cn/bridgeli/demo/mapper/*.xml&amp;#34; /&amp;gt;  
&amp;lt;/bean&amp;gt;

&amp;amp;#8230;&amp;amp;#8230;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;因为这个文件太长，就不贴全文了，仅把位置这一块贴出来，当我们把这些配置工作做好之后，下一步就是如何使用了。&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
