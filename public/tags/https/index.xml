<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>HTTPS on 分享技术带来的喜悦</title>
    <link>http://localhost:1313/tags/https/</link>
    <description>Recent content in HTTPS on 分享技术带来的喜悦</description>
    <generator>Hugo -- 0.156.0</generator>
    <language>zh-cn</language>
    <lastBuildDate>Sun, 21 Apr 2024 05:46:06 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/https/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target</title>
      <link>http://localhost:1313/posts/2024-04-21-javax-net-ssl-sslhandshakeexception-sun-security-validator-validatorexception-pkix-path-building-failed-sun-security-provider-certpath-suncertpathbuilderexception-unable-to-find-valid-certificatio/</link>
      <pubDate>Sun, 21 Apr 2024 05:46:06 +0000</pubDate>
      <guid>http://localhost:1313/posts/2024-04-21-javax-net-ssl-sslhandshakeexception-sun-security-validator-validatorexception-pkix-path-building-failed-sun-security-provider-certpath-suncertpathbuilderexception-unable-to-find-valid-certificatio/</guid>
      <description>&lt;p&gt;自从 ChatGPT 横空出世之后，突然没了写博客的兴趣，因为无论有什么问题，随便往 ChatGPT 一帖，结果就哗哗的出来了，今天这个问题就是。前一段时间和某公司联调接口，对方的接口测试环境好好的，一上线调不通，报错信息就是标题，只见贴到 ChatGPT，ChatGPT 回答如下：&lt;/p&gt;
&lt;p&gt;这个错误通常是由于缺少信任证书或证书链不完整导致的。解决方法通常有两种：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;**添加证书到信任库**：获取正确的证书，并将其添加到 Java 的信任库中。可以使用 `keytool` 工具来完成此操作。具体步骤如下：&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;– 首先，使用以下命令导出证书：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;keytool -printcert -rfc -sslserver &amp;lt;hostname&amp;gt; -port &amp;lt;port&amp;gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中 &lt;code&gt;&amp;lt;hostname&amp;gt;&lt;/code&gt; 和 &lt;code&gt;&amp;lt;port&amp;gt;&lt;/code&gt; 是你要访问的 HTTPS 接口的主机名和端口号。&lt;/p&gt;
&lt;p&gt;– 然后将证书导出到一个文件中。&lt;/p&gt;
&lt;p&gt;– 最后，使用以下命令将证书添加到 Java 的信任库中：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;keytool -importcert -file &amp;lt;certificate-file&amp;gt; -keystore &amp;lt;path-to-truststore&amp;gt; -alias &amp;lt;alias&amp;gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;其中 &lt;code&gt;&amp;lt;certificate-file&amp;gt;&lt;/code&gt; 是你导出的证书文件，&lt;code&gt;&amp;lt;path-to-truststore&amp;gt;&lt;/code&gt; 是 Java 信任库的路径，&lt;code&gt;&amp;lt;alias&amp;gt;&lt;/code&gt; 是证书的别名。&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;**忽略证书验证**：如果你确定你要连接的服务器是安全的，并且不需要严格的证书验证，你可以在 Java 代码中忽略证书验证。但这不是推荐的做法，因为可能会导致安全风险。你可以使用 `TrustManager` 接口实现自定义的信任管理器，然后将其应用于 SSL 连接。下面是一个简单的示例代码：&lt;/li&gt;
&lt;/ol&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;import javax.net.ssl.*;  
import java.security.cert.X509Certificate;

public class SSLCertificateIgnore {  
public static void main(String[] args) throws Exception {  
// Create a trust manager that does not validate certificate chains  
TrustManager[] trustAllCerts = new TrustManager[]{  
new X509TrustManager() {  
public X509Certificate[] getAcceptedIssuers() {  
return null;  
}  
public void checkClientTrusted(X509Certificate[] certs, String authType) {  
}  
public void checkServerTrusted(X509Certificate[] certs, String authType) {  
}  
}  
};

// Install the all-trusting trust manager  
SSLContext sc = SSLContext.getInstance(&amp;#34;SSL&amp;#34;);  
sc.init(null, trustAllCerts, null);  
HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());

// Now you can access the HTTPS endpoint without certificate validation  
}  
}  
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;请注意，这种方法会降低安全性，因为它会使你的应用程序容易受到中间人攻击。因此，最好的做法是第一种方法，即添加正确的证书到信任库中。&lt;/p&gt;</description>
    </item>
    <item>
      <title>是的，我也开启了全站HTTPS</title>
      <link>http://localhost:1313/posts/2017-09-03-%E6%98%AF%E7%9A%84%E6%88%91%E4%B9%9F%E5%BC%80%E5%90%AF%E4%BA%86%E5%85%A8%E7%AB%99https/</link>
      <pubDate>Sun, 03 Sep 2017 11:25:18 +0000</pubDate>
      <guid>http://localhost:1313/posts/2017-09-03-%E6%98%AF%E7%9A%84%E6%88%91%E4%B9%9F%E5%BC%80%E5%90%AF%E4%BA%86%E5%85%A8%E7%AB%99https/</guid>
      <description>&lt;p&gt;现在的趋势都在全站HTTPS，据说在Google内部有一个时间表，会把所有未开启HTTPS的网站标注为不安全（目前仅仅会把带密码框的输入页标注为不安全），所以一直想玩玩，去年的时候就看到新浪timyang的博客开启了全站HTTPS，并写了一篇文章如何开启，当时就想玩玩，但感觉还是稍有麻烦，而且当时的博客服务器用的Apache，对Apache配置不熟，想着是自己的小博客就没动，前几天突然看到coolshell网也开启了全站HTTPS，发现现在配置变得很简单了，而且我的博客服务器也由Apache换成了Nginx，所以就玩了玩，确实很方便。&lt;br&gt;
首先声明，无论是timyang还是左耳朵耗子，使用的都是Let’s Encrypt，他是一个公益组织，表示感谢，网址：https://letsencrypt.org/&lt;br&gt;
下面写一下开启的方法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;首先，打开 &lt;a href=&#34;https://certbot.eff.org&#34;&gt;https://certbot.eff.org&lt;/a&gt; 网页。&lt;/li&gt;
&lt;li&gt;在那个机器上图标下面，你需要选择一下你用的 Web 接入软件 和你的 操作系统。比如，我选的，nginx 和 CentOS 6。&lt;/li&gt;
&lt;li&gt;然后就会跳转到一个安装教程网页。你就照着做一遍就好了。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;例如我选的这个调到安装教程页，出现的命令是：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
wget https://dl.eff.org/certbot-auto  
chmod a+x certbot-auto
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;然后，运行如下命令：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
./path/to/certbot-auto &amp;amp;#8211;nginx
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;certbot-auto 会自动检查到你的 nginx.conf 下的配置，把你所有的虚拟站点都列出来，然后让你选择需要开启 https 的站点。你就简单的输入列表编号（用空格分开），因为我的就一个所以直接回车就好了（里面有一些需要你填写的东西，连我这英文巨差的人都可以看懂，相信大家都能看的懂），然后，certbot-auto 就帮你下载证书并更新 nginx.conf 了。&lt;/p&gt;
&lt;p&gt;但在这个过程中需要注意的一点：记得开启你的 443 端口，我博客用的阿里云，当时没开启直接报错了，开启之后重新执行一下这个命令就好了。&lt;/p&gt;
&lt;p&gt;你打开你的 nginx.conf 文件 ，你可以发现你的文件中的 server 配置中可能被做了如下的修改：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
listen 443 ssl; # managed by Certbot  
ssl_certificate /etc/letsencrypt/live/www.bridgeli.cn/fullchain.pem; # managed by Certbot  
ssl_certificate_key /etc/letsencrypt/live/www.bridgeli.cn/privkey.pem; # managed by Certbot  
include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;和&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
if ($scheme != &amp;#34;https&amp;#34;) {  
return 301 https://$host$request_uri;  
} # managed by Certbot
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;另外开启HTTPS之后都建议开启HTTP/2性能更好，但这要求你的Nginx版本要大于 1.9.5 ，开启的方法也无比简单，只需要在 nginx.conf 的 listen 443 ssl; 后面加上 http2 就好了。如下所示：&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
