<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Not In on 分享技术带来的喜悦</title>
    <link>http://localhost:1313/tags/not-in/</link>
    <description>Recent content in Not In on 分享技术带来的喜悦</description>
    <generator>Hugo -- 0.156.0</generator>
    <language>zh-cn</language>
    <lastBuildDate>Sun, 24 Nov 2019 03:42:36 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/not-in/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>MySQL 中 NOT IN 的坑 — 列为 null 的问题</title>
      <link>http://localhost:1313/posts/2019-11-24-mysql-%E4%B8%AD-not-in-%E7%9A%84%E5%9D%91-%E5%88%97%E4%B8%BA-null-%E7%9A%84%E9%97%AE%E9%A2%98/</link>
      <pubDate>Sun, 24 Nov 2019 03:42:36 +0000</pubDate>
      <guid>http://localhost:1313/posts/2019-11-24-mysql-%E4%B8%AD-not-in-%E7%9A%84%E5%9D%91-%E5%88%97%E4%B8%BA-null-%E7%9A%84%E9%97%AE%E9%A2%98/</guid>
      <description>&lt;p&gt;前一段时间在公司做一个小功能的时候，统计一下某种情况下有多少条数据，然后修改的问题，当时感觉很简单，写了一个如下的 SQL:&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
SELECT COUNT(*) FROM t1 where tl.c1 not IN (SELECT t2.c1 FROM t2);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;预期的结果是：有多少条数据在 t1 中，同时不在 t2 中，结果为：0，也就是 t1 中数据都在 t2 中，但是很容易就发现某些数据在 t1 中不在 t2 中，所以就感觉很奇怪，这个 SQL 看着也没问题啊。经过一番查询原来是因为 t2 的 c1 字段包含了 null 值，修改如下两种形式都可以得到预期的结果：&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
SELECT COUNT(*) FROM t1 LEFT JOIN t2 ON t1.c1 = t2.c1 WHERE t2.c1 IS NULL OR t2.c1 = &amp;amp;#8221;;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;或者&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;
select COUNT(*) from t1 where t1.c1 not in (  
select t2.c1 from t2 where t2.c1 is not null AND t2.c1 != &amp;amp;#8221;  
);
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;所以都是 null 引起的（为了避免错误我把空串也加上了），原因是 not in 的实现原理是，对每一个 t1.c1 和每一个 t2.c1 （括号内的查询结果）进行不相等比较（!=）。&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
