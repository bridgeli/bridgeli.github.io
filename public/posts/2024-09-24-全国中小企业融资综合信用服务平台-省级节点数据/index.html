<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>全国中小企业融资综合信用服务平台-省级节点数据接口规范-河南省营商环境和社会信用建设中心 | 分享技术带来的喜悦</title>
<meta name="keywords" content="webservice">
<meta name="description" content="开始之前先说一点题外话，几年前曾经看过一个视频，其中一个观点大概就是程序员是一个反传统的群体，其他群体掌握了某个技术，一般都是当做内部商业机密，而程序员则不一样，喜欢开源，尤其 GPL 协议的开源，不仅自己毫无保留的开源，还要求使用他的软件也得开源，也正是这种开源造就了互联网的蓬勃发展。我目前所在公司因为是做金融相关的公司，国家出于某些原因，要求要上报相关的数据到省平台，而省平台的技术采用的是 webservice，和我们目前习惯的 http 接口不太一样，所以前一段时间在写这个的时候走了不少弯路，而网上也没有参考资料，所以决定把相关的核心代码公布出来，供需要的同学参考。需要说明的是：这是我们河南省的系统相关接口，不知道外省是否一致，省平台给的接口文档名是：全国中小企业融资综合信用服务平台省级节点数据接口规范V5.3.pdf，首页写的是：全国中小企业融资综合信用服务平台省级节点数据接口规范，国家公共信用信息中心，河南省营商环境和社会信用建设中心，2024年7月

jar 包引入


&lt;dependency&gt;  
&lt;groupId&gt;cn.hutool&lt;/groupId&gt;  
&lt;artifactId&gt;hutool-all&lt;/artifactId&gt;  
&lt;version&gt;5.8.10&lt;/version&gt;  
&lt;/dependency&gt;  
&lt;dependency&gt;  
&lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;  
&lt;artifactId&gt;bcprov-jdk15on&lt;/artifactId&gt;  
&lt;version&gt;1.70&lt;/version&gt;  
&lt;/dependency&gt;  
&lt;dependency&gt;  
&lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;  
&lt;artifactId&gt;bcpkix-jdk15on&lt;/artifactId&gt;  
&lt;version&gt;1.70&lt;/version&gt;  
&lt;/dependency&gt;  
&lt;dependency&gt;  
&lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;  
&lt;artifactId&gt;cxf-rt-frontend-jaxws&lt;/artifactId&gt;  
&lt;version&gt;4.0.5&lt;/version&gt;  
&lt;/dependency&gt;  
&lt;dependency&gt;  
&lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;  
&lt;artifactId&gt;cxf-rt-transports-http&lt;/artifactId&gt;  
&lt;version&gt;4.0.5&lt;/version&gt;  
&lt;/dependency&gt;

上报工具类，其中：queryData 方法是用来查询，sendData 方法用来上报数据


package cn.bridgeli.demo;

import cn.hutool.core.util.RandomUtil;  
import com.alibaba.fastjson.JSONObject;  
import lombok.extern.slf4j.Slf4j;  
import org.apache.commons.codec.CharEncoding;  
import org.apache.commons.lang3.StringUtils;  
import org.apache.cxf.endpoint.Client;  
import org.apache.cxf.jaxws.endpoint.dynamic.JaxWsDynamicClientFactory;  
import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey;  
import org.bouncycastle.util.encoders.Base64;  
import org.bouncycastle.util.encoders.Hex;

import javax.xml.namespace.QName;  
import java.io.File;  
import java.io.FileInputStream;  
import java.io.FileOutputStream;  
import java.io.IOException;  
import java.io.InputStream;  
import java.math.BigInteger;  
import java.security.PublicKey;

@Slf4j  
public class XyhnUtil {

private static String pubKey;  
private static String queryPubKey;

private static PublicKey reportPublicKey;

// private static XyhnConfig xyhnConfig = SpringUtils.getBean(XyhnConfig.class);  
private static XyhnConfig xyhnConfig = null;

/**  
* 授权查询省平台接口  
*  
* @param method 要调取的方法名  
* @param object 查询方法的参数（不包含：publicKey、appKey）  
* @return 省平台解密后的数据  
*/  
public static String queryData(String method, JSONObject object) {  
//1、组装报文  
if (StringUtils.isEmpty(queryPubKey)) {  
queryPubKey = convertFileToBase64(xyhnConfig.getQueryPubKeyPath());  
}

object.put(&#34;publicKey&#34;, queryPubKey);  
object.put(&#34;appKey&#34;, xyhnConfig.getQueryAppKey());  
//2、发送报文  
String jsonRes = callInterface(&#34;query&#34;, method, object.toJSONString());

//3、解密返回数据  
JSONObject json = JSONObject.parseObject(jsonRes);  
Boolean success = json.getBoolean(&#34;success&#34;);  
if (&#34;uploadLicense&#34;.equals(method)) {  
if (null == success || !success) {  
return jsonRes;  
}  
} else if (&#34;cancelLicense&#34;.equals(method)) {  
if (null != success &amp;&amp; success) {  
return jsonRes;  
}  
}

BigInteger d = new BigInteger(xyhnConfig.getQueryPriKey(), 16);  
BCECPrivateKey bcecPrivateKey = GMUtil.getPrivatekeyFromD(d);  
String key0 = json.getString(&#34;key&#34;);  
String data = json.getString(&#34;data&#34;);  
String signatureData = json.getString(&#34;signatureData&#34;);  
byte[] decode = Hex.decode(key0);  
// sm2解密  
byte[] bytes1 = GMUtil.sm2Decrypt(decode, bcecPrivateKey);  
// sm4解密  
String content = GMUtil.sm4Decrypt(new String(bytes1), data);  
log.info(&#34;content: &#34; &#43; content);  
// 4、验签  
File file = base64ToFileEx(json.getString(&#34;pubKey&#34;));  
PublicKey publicKey = GMUtil.getPublickeyFromX509File(file);  
byte[] signatureData1 = Hex.decode(signatureData);  
boolean verifyRes = GMUtil.verifySm3WithSm2(content.getBytes(), xyhnConfig.getUserId().getBytes(), signatureData1, publicKey);  
log.info(&#34;method 验签结果：&#34; &#43; verifyRes);  
if (!verifyRes) {  
return null;  
}  
return content;  
}

private static PublicKey getPublicKey() {  
//1、组装报文  
if (StringUtils.isEmpty(pubKey)) {  
pubKey = convertFileToBase64(xyhnConfig.getPubKeyPath());  
}  
JSONObject jsonObject = new JSONObject();  
jsonObject.put(&#34;key&#34;, xyhnConfig.getAppKey());  
JSONObject object = new JSONObject();  
object.put(&#34;requestData&#34;, jsonObject);  
object.put(&#34;publicKey&#34;, pubKey);  
//2、发送报文  
String jsonRes = callInterface(&#34;report&#34;, &#34;getPublicKey&#34;, object.toJSONString());

//3、解密返回数据  
JSONObject json = JSONObject.parseObject(jsonRes);  
BigInteger d = new BigInteger(xyhnConfig.getPriKey(), 16);  
BCECPrivateKey bcecPrivateKey = GMUtil.getPrivatekeyFromD(d);  
String key0 = json.getString(&#34;key&#34;);  
String data = json.getString(&#34;data&#34;);  
String signatureData = json.getString(&#34;signatureData&#34;);  
byte[] decode = Hex.decode(key0);  
// sm2解密  
byte[] bytes1 = GMUtil.sm2Decrypt(decode, bcecPrivateKey);  
// sm4解密  
String returnData = GMUtil.sm4Decrypt(new String(bytes1), data);  
log.info(&#34;returnData:&#34; &#43; returnData);  
// 4、验签  
File file = base64ToFileEx(returnData);  
PublicKey publicKey = GMUtil.getPublickeyFromX509File(file);  
byte[] signatureData1 = Hex.decode(signatureData);  
boolean verifyRes = GMUtil.verifySm3WithSm2(returnData.getBytes(), xyhnConfig.getUserId().getBytes(), signatureData1, publicKey);  
log.info(&#34;getPublicKey 接口验签结果：&#34; &#43; verifyRes);  
if (!verifyRes) {  
return null;  
}  
return publicKey;  
}

public static String sendData(String jsonStr, String method) {

log.info(&#34;调用省平台方法名：&#34; &#43; method &#43; &#34;，参数：&#34; &#43; jsonStr);

try {  
if (StringUtils.isEmpty(pubKey)) { // 解析公钥  
pubKey = convertFileToBase64(xyhnConfig.getPubKeyPath());  
}  
if (reportPublicKey == null) { //请求接口，获取公钥  
reportPublicKey = getPublicKey();  
}

// 1、摘要签名 sm2withsm3  
byte[] msg = jsonStr.getBytes(CharEncoding.ISO_8859_1);  
byte[] userIdBytes = xyhnConfig.getUserId().getBytes();  
BigInteger d = new BigInteger(xyhnConfig.getPriKey(), 16);  
BCECPrivateKey bcecPrivateKey = GMUtil.getPrivatekeyFromD(d);  
byte[] sig = GMUtil.signSm3WithSm2(msg, userIdBytes, bcecPrivateKey);  
String signature = Hex.toHexString(sig);

// 2、sm4加密数据报文  
String key1 = RandomUtil.randomString(16);  
String jsonobj = GMUtil.sm4Encrypt(key1, jsonStr);

//3、sm2加密16位随机码key  
byte[] datamsg = GMUtil.sm2Encrypt(key1.getBytes(), reportPublicKey);  
String s = Hex.toHexString(datamsg);

//4、组装并发送报文  
JSONObject jsonObject2 = new JSONObject();  
jsonObject2.put(&#34;requestData&#34;, jsonobj); // sm4加密的数据集  
jsonObject2.put(&#34;key&#34;, s); // sm2加密的16位随机码  
jsonObject2.put(&#34;signatureData&#34;, signature); // 签名  
jsonObject2.put(&#34;publicKey&#34;, pubKey); // 我的公钥  
jsonObject2.put(&#34;appKey&#34;, xyhnConfig.getAppKey()); // 数据授权的key

String setFPRes = callInterface(&#34;report&#34;, method, jsonObject2.toJSONString());  
return setFPRes;  
} catch (Exception ex) {  
log.error(&#34;请求省平台接口异常&#34;, ex);  
return null;  
}

}

/**  
* 请求接口  
*  
* @param type，report 回传数据，query 查询  
* @param method  
* @param json  
* @return  
*/  
private static String callInterface(String type, String method, String json) {  
log.info(&#34;调用省平台类型:&#34; &#43; type &#43; &#34;，接口：&#34; &#43; method &#43; &#34;，参数：&#34; &#43; json);  
Client client = null;  
QName name = null;  
JaxWsDynamicClientFactory dcf = JaxWsDynamicClientFactory.newInstance();  
String result = null;  
try {  
if (&#34;report&#34;.equals(type)) {  
client = dcf.createClient(xyhnConfig.getWsAddr());  
name = new QName(xyhnConfig.getNamespaceURI(), method);  
} else if (&#34;query&#34;.equals(type)) {  
client = dcf.createClient(xyhnConfig.getQueryWsAddr());  
name = new QName(xyhnConfig.getQueryNamespaceURI(), method);  
}

Object[] objects = client.invoke(name, json);  
result = objects[0].toString();

} catch (Exception e) {  
log.error(&#34;调用省平台接口报错&#34;, e);  
} finally {  
if (client != null) {  
try {  
client.close();  
} catch (Exception e) {  
log.error(&#34;关闭Client资源时发生异常&#34;, e);  
}  
}  
}

log.info(&#34;调用省平台类型:&#34; &#43; type &#43; &#34;，接口：&#34; &#43; method &#43; &#34;，返回值：&#34; &#43; result);

return result;  
}

private static String convertFileToBase64(String imgPath) {  
byte[] data = null;  
// 读取图片字节数组  
try (InputStream in = new FileInputStream(imgPath);) {  
data = new byte[in.available()];  
in.read(data);  
} catch (IOException e) {  
log.error(&#34;IOException&#34;, e);  
}  
// 对字节数组进行Base64编码，得到Base64编码的字符串  
String base64Str = java.util.Base64.getEncoder().encodeToString(data);  
return base64Str;  
}

private static File base64ToFileEx(String base64) {  
if (StringUtils.isBlank(base64)) {  
return null;  
}  
byte[] buff = Base64.decode(base64);  
File file = null;  
FileOutputStream fout = null;  
try {  
file = File.createTempFile(&#34;tmp&#34;, null);  
fout = new FileOutputStream(file);  
fout.write(buff);  
file.deleteOnExit();  
} catch (IOException e) {  
e.printStackTrace();  
} finally {  
if (fout != null) {  
try {  
fout.close();  
} catch (IOException e) {  
e.printStackTrace();  
}  
}  
}  
return file;  
}

}

用到的工具类


package cn.bridgeli.demo;

import lombok.extern.slf4j.Slf4j;  
import org.bouncycastle.asn1.ASN1EncodableVector;  
import org.bouncycastle.asn1.ASN1Integer;  
import org.bouncycastle.asn1.ASN1Sequence;  
import org.bouncycastle.asn1.DERSequence;  
import org.bouncycastle.asn1.gm.GMNamedCurves;  
import org.bouncycastle.asn1.x9.X9ECParameters;  
import org.bouncycastle.crypto.InvalidCipherTextException;  
import org.bouncycastle.crypto.engines.SM2Engine;  
import org.bouncycastle.crypto.params.ECDomainParameters;  
import org.bouncycastle.crypto.params.ECPrivateKeyParameters;  
import org.bouncycastle.crypto.params.ECPublicKeyParameters;  
import org.bouncycastle.crypto.params.ParametersWithRandom;  
import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey;  
import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPublicKey;  
import org.bouncycastle.jcajce.spec.SM2ParameterSpec;  
import org.bouncycastle.jce.provider.BouncyCastleProvider;  
import org.bouncycastle.jce.spec.ECParameterSpec;  
import org.bouncycastle.jce.spec.ECPrivateKeySpec;  
import org.bouncycastle.util.encoders.Hex;

import javax.crypto.Cipher;  
import javax.crypto.spec.SecretKeySpec;  
import java.io.File;  
import java.io.FileInputStream;  
import java.io.IOException;  
import java.math.BigInteger;  
import java.nio.charset.StandardCharsets;  
import java.security.Key;  
import java.security.PrivateKey;  
import java.security.PublicKey;  
import java.security.SecureRandom;  
import java.security.Security;  
import java.security.Signature;  
import java.security.cert.CertificateFactory;  
import java.security.cert.X509Certificate;  
import java.util.Arrays;

@Slf4j  
public class GMUtil {  
private static X9ECParameters x9ECParameters = GMNamedCurves.getByName(&#34;sm2p256v1&#34;);  
private static ECDomainParameters ecDomainParameters;  
private static ECParameterSpec ecParameterSpec;

public static byte[] signSm3WithSm2(byte[] msg, byte[] userId, PrivateKey privateKey) {  
return rsAsn1ToPlainByteArray(signSm3WithSm2Asn1Rs(msg, userId, privateKey));  
}

public static byte[] signSm3WithSm2Asn1Rs(byte[] msg, byte[] userId, PrivateKey privateKey) {  
try {  
SM2ParameterSpec parameterSpec = new SM2ParameterSpec(userId);  
Signature signer = Signature.getInstance(&#34;SM3withSM2&#34;, &#34;BC&#34;);  
signer.setParameter(parameterSpec);  
signer.initSign(privateKey, new SecureRandom());  
signer.update(msg, 0, msg.length);  
byte[] sig = signer.sign();  
return sig;  
} catch (Exception e) {  
throw new RuntimeException(e);  
}  
}

public static boolean verifySm3WithSm2(byte[] msg, byte[] userId, byte[] rs, PublicKey publicKey) {  
return verifySm3WithSm2Asn1Rs(msg, userId, rsPlainByteArrayToAsn1(rs), publicKey);  
}

public static boolean verifySm3WithSm2Asn1Rs(byte[] msg, byte[] userId, byte[] rs, PublicKey publicKey) {  
try {  
SM2ParameterSpec parameterSpec = new SM2ParameterSpec(userId);  
Signature verifier = Signature.getInstance(&#34;SM3withSM2&#34;, &#34;BC&#34;);  
verifier.setParameter(parameterSpec);  
verifier.initVerify(publicKey);  
verifier.update(msg, 0, msg.length);  
return verifier.verify(rs);  
} catch (Exception e) {  
throw new RuntimeException(e);  
}  
}

public static byte[] changeC1C2C3ToC1C3C2(byte[] c1c2c3) {  
int c1Len = (x9ECParameters.getCurve().getFieldSize() &#43; 7) / 8 * 2 &#43; 1;

byte[] result = new byte[c1c2c3.length];  
System.arraycopy(c1c2c3, 0, result, 0, c1Len);  
System.arraycopy(c1c2c3, c1c2c3.length &amp;#8211; 32, result, c1Len, 32);  
System.arraycopy(c1c2c3, c1Len, result, c1Len &#43; 32, c1c2c3.length &amp;#8211; c1Len &amp;#8211; 32);  
return result;  
}

public static byte[] changeC1C3C2ToC1C2C3(byte[] c1c3c2) {  
int c1Len = (x9ECParameters.getCurve().getFieldSize() &#43; 7) / 8 * 2 &#43; 1;

byte[] result = new byte[c1c3c2.length];  
System.arraycopy(c1c3c2, 0, result, 0, c1Len);  
System.arraycopy(c1c3c2, c1Len &#43; 32, result, c1Len, c1c3c2.length &amp;#8211; c1Len &amp;#8211; 32);  
System.arraycopy(c1c3c2, c1Len, result, c1c3c2.length &amp;#8211; 32, 32);  
return result;  
}

public static byte[] sm2Decrypt(byte[] data, PrivateKey key) {  
return sm2DecryptOld(changeC1C3C2ToC1C2C3(data), key);  
}

public static byte[] sm2Encrypt(byte[] data, PublicKey key) {  
return changeC1C2C3ToC1C3C2(sm2EncryptOld(data, key));  
}

public static byte[] sm2EncryptOld(byte[] data, PublicKey key) {  
BCECPublicKey localECPublicKey = (BCECPublicKey) key;  
ECPublicKeyParameters ecPublicKeyParameters = new ECPublicKeyParameters(localECPublicKey.getQ(), ecDomainParameters);  
SM2Engine sm2Engine = new SM2Engine();  
sm2Engine.init(true, new ParametersWithRandom(ecPublicKeyParameters, new SecureRandom()));

try {  
return sm2Engine.processBlock(data, 0, data.length);  
} catch (InvalidCipherTextException e) {  
throw new RuntimeException(e);  
}  
}

public static byte[] sm2DecryptOld(byte[] data, PrivateKey key) {  
BCECPrivateKey localECPrivateKey = (BCECPrivateKey) key;  
ECPrivateKeyParameters ecPrivateKeyParameters = new ECPrivateKeyParameters(localECPrivateKey.getD(), ecDomainParameters);  
SM2Engine sm2Engine = new SM2Engine();  
sm2Engine.init(false, ecPrivateKeyParameters);

try {  
return sm2Engine.processBlock(data, 0, data.length);  
} catch (InvalidCipherTextException e) {  
throw new RuntimeException(e);  
}  
}

public static byte[] sm4Encrypt(byte[] keyBytes, byte[] plain) {  
byte[] keyBytes0;  
if (keyBytes.length != 16) {  
keyBytes0 = new byte[16];

for (int i = 0; i &lt; keyBytes0.length; &#43;&#43;i) {  
if (keyBytes.length &gt; i) {  
keyBytes0[i] = keyBytes[i];  
}  
}

keyBytes = keyBytes0;  
}

if (plain.length % 16 != 0) {  
keyBytes0 = new byte[16 * (plain.length / 16 &#43; 1)];  
System.arraycopy(plain, 0, keyBytes0, 0, plain.length);  
plain = keyBytes0;  
}

try {  
Key key = new SecretKeySpec(keyBytes, &#34;SM4&#34;);  
Cipher out = Cipher.getInstance(&#34;SM4/ECB/NoPadding&#34;, &#34;BC&#34;);  
out.init(1, key);  
return out.doFinal(plain);  
} catch (Exception e) {  
throw new RuntimeException(e);  
}  
}

public static byte[] sm4Decrypt(byte[] keyBytes, byte[] cipher) {  
byte[] keyBytes0;  
if (keyBytes.length != 16) {  
keyBytes0 = new byte[16];

for (int i = 0; i &lt; keyBytes0.length; &#43;&#43;i) {  
if (keyBytes.length &gt; i) {  
keyBytes0[i] = keyBytes[i];  
}  
}

keyBytes = keyBytes0;  
}

if (cipher.length % 16 != 0) {  
keyBytes0 = new byte[16 * (cipher.length / 16 &#43; 1)];  
System.arraycopy(cipher, 0, keyBytes0, 0, cipher.length);  
cipher = keyBytes0;  
}

try {  
Key key = new SecretKeySpec(keyBytes, &#34;SM4&#34;);  
Cipher in = Cipher.getInstance(&#34;SM4/ECB/NoPadding&#34;, &#34;BC&#34;);  
in.init(2, key);  
byte[] bytes = in.doFinal(cipher);

for (int i = bytes.length &amp;#8211; 1; i &gt;= 0; &amp;#8211;i) {  
if (bytes[i] != 0) {  
byte[] bytes1 = new byte[i &#43; 1];  
System.arraycopy(bytes, 0, bytes1, 0, i &#43; 1);  
bytes = bytes1;  
i = -1;  
}  
}

return bytes;  
} catch (Exception e) {  
throw new RuntimeException(e);  
}  
}

public static String sm4Encrypt(String key, String plan) {  
byte[] keyBytes = new byte[16];  
byte[] keyBytes0 = key.getBytes(StandardCharsets.UTF_8);

for (int i = 0; i &lt; keyBytes.length; &#43;&#43;i) {  
if (keyBytes0.length &gt; i) {  
keyBytes[i] = keyBytes0[i];  
}  
}

byte[] cipher = plan.getBytes(StandardCharsets.UTF_8);

byte[] bytes = sm4Encrypt(keyBytes, cipher);  
return Hex.toHexString(bytes).toUpperCase();  
}

public static String sm4Decrypt(String key, String cipher) {  
byte[] keyBytes = new byte[16];  
byte[] keyBytes0 = key.getBytes(StandardCharsets.UTF_8);

for (int i = 0; i &lt; keyBytes.length; &#43;&#43;i) {  
if (keyBytes0.length &gt; i) {  
keyBytes[i] = keyBytes0[i];  
}  
}

byte[] cipherbytes = Hex.decode(cipher);  
byte[] bytes = sm4Decrypt(keyBytes, cipherbytes);

return new String(bytes, StandardCharsets.UTF_8);

}

private static byte[] bigIntToFixexLengthBytes(BigInteger rOrS) {  
byte[] rs = rOrS.toByteArray();  
if (rs.length == 32) {  
return rs;  
} else if (rs.length == 33 &amp;&amp; rs[0] == 0) {  
return Arrays.copyOfRange(rs, 1, 33);  
} else if (rs.length &lt; 32) {  
byte[] result = new byte[32];  
Arrays.fill(result, (byte) 0);  
System.arraycopy(rs, 0, result, 32 &amp;#8211; rs.length, rs.length);  
return result;  
} else {  
throw new RuntimeException(&#34;err rs: &#34; &#43; Hex.toHexString(rs));  
}  
}

private static byte[] rsAsn1ToPlainByteArray(byte[] rsDer) {  
ASN1Sequence seq = ASN1Sequence.getInstance(rsDer);  
byte[] r = bigIntToFixexLengthBytes(ASN1Integer.getInstance(seq.getObjectAt(0)).getValue());  
byte[] s = bigIntToFixexLengthBytes(ASN1Integer.getInstance(seq.getObjectAt(1)).getValue());  
byte[] result = new byte[64];  
System.arraycopy(r, 0, result, 0, r.length);  
System.arraycopy(s, 0, result, 32, s.length);  
return result;  
}

private static byte[] rsPlainByteArrayToAsn1(byte[] sign) {  
if (sign.length != 64) {  
throw new RuntimeException(&#34;err rs. &#34;);  
} else {  
BigInteger r = new BigInteger(1, Arrays.copyOfRange(sign, 0, 32));  
BigInteger s = new BigInteger(1, Arrays.copyOfRange(sign, 32, 64));  
ASN1EncodableVector v = new ASN1EncodableVector();  
v.add(new ASN1Integer(r));  
v.add(new ASN1Integer(s));

try {  
return (new DERSequence(v)).getEncoded(&#34;DER&#34;);  
} catch (IOException var5) {  
throw new RuntimeException(var5);  
}  
}  
}

public static BCECPrivateKey getPrivatekeyFromD(BigInteger d) {  
ECPrivateKeySpec ecPrivateKeySpec = new ECPrivateKeySpec(d, ecParameterSpec);  
return new BCECPrivateKey(&#34;EC&#34;, ecPrivateKeySpec, BouncyCastleProvider.CONFIGURATION);  
}

public static PublicKey getPublickeyFromX509File(File file) {  
try {  
CertificateFactory cf = CertificateFactory.getInstance(&#34;X.509&#34;, &#34;BC&#34;);  
FileInputStream in = new FileInputStream(file);  
X509Certificate x509 = (X509Certificate) cf.generateCertificate(in);  
return x509.getPublicKey();  
} catch (Exception var4) {  
throw new RuntimeException(var4);  
}  
}

static {  
ecDomainParameters = new ECDomainParameters(x9ECParameters.getCurve(), x9ECParameters.getG(), x9ECParameters.getN());  
ecParameterSpec = new ECParameterSpec(x9ECParameters.getCurve(), x9ECParameters.getG(), x9ECParameters.getN());  
if (Security.getProvider(&#34;BC&#34;) == null) {  
Security.addProvider(new BouncyCastleProvider());  
}  
}  
}

相关配置


package cn.bridgeli.demo;

import lombok.Data;  
import org.springframework.boot.context.properties.ConfigurationProperties;  
import org.springframework.stereotype.Component;

@Data  
@Component  
@ConfigurationProperties(prefix = &#34;xyhn&#34;)  
//@RefreshScope  
public class XyhnConfig {

private String userId;  
private String platformId;

private String appKey;  
private String priKey;  
private String wsAddr;  
private String namespaceURI;  
private String pubKeyPath;

private String queryAppKey;  
private String queryPriKey;  
private String queryWsAddr;  
private String queryNamespaceURI;  
private String queryPubKeyPath;  
}
以上是上报和查询数据的核心方法，下面是查询具体数据的封装">
<meta name="author" content="Bridge Li">
<link rel="canonical" href="http://localhost:1313/posts/2024-09-24-%E5%85%A8%E5%9B%BD%E4%B8%AD%E5%B0%8F%E4%BC%81%E4%B8%9A%E8%9E%8D%E8%B5%84%E7%BB%BC%E5%90%88%E4%BF%A1%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%B9%B3%E5%8F%B0-%E7%9C%81%E7%BA%A7%E8%8A%82%E7%82%B9%E6%95%B0%E6%8D%AE/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a29c24210eb31d9ce56f669c66a35c9c51b17376b7764e336a49af7dec914cf0.css" integrity="sha256-opwkIQ6zHZzlb2acZqNcnFGxc3a3dk4zakmvfeyRTPA=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/2024-09-24-%E5%85%A8%E5%9B%BD%E4%B8%AD%E5%B0%8F%E4%BC%81%E4%B8%9A%E8%9E%8D%E8%B5%84%E7%BB%BC%E5%90%88%E4%BF%A1%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%B9%B3%E5%8F%B0-%E7%9C%81%E7%BA%A7%E8%8A%82%E7%82%B9%E6%95%B0%E6%8D%AE/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="分享技术带来的喜悦 (Alt + H)">分享技术带来的喜悦</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="文章">
                    <span>文章</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="关于">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">文章</a></div>
    <h1 class="post-title entry-hint-parent">
      全国中小企业融资综合信用服务平台-省级节点数据接口规范-河南省营商环境和社会信用建设中心
    </h1>
    <div class="post-meta"><span title='2024-09-24 06:37:18 +0000 +0000'>September 24, 2024</span>&nbsp;·&nbsp;<span>13 min</span>&nbsp;·&nbsp;<span>2571 words</span>&nbsp;·&nbsp;<span>Bridge Li</span>

</div>
  </header> 
  <div class="post-content"><p>开始之前先说一点题外话，几年前曾经看过一个视频，其中一个观点大概就是程序员是一个反传统的群体，其他群体掌握了某个技术，一般都是当做内部商业机密，而程序员则不一样，喜欢开源，尤其 GPL 协议的开源，不仅自己毫无保留的开源，还要求使用他的软件也得开源，也正是这种开源造就了互联网的蓬勃发展。我目前所在公司因为是做金融相关的公司，国家出于某些原因，要求要上报相关的数据到省平台，而省平台的技术采用的是 webservice，和我们目前习惯的 http 接口不太一样，所以前一段时间在写这个的时候走了不少弯路，而网上也没有参考资料，所以决定把相关的核心代码公布出来，供需要的同学参考。需要说明的是：这是我们河南省的系统相关接口，不知道外省是否一致，省平台给的接口文档名是：全国中小企业融资综合信用服务平台省级节点数据接口规范V5.3.pdf，首页写的是：全国中小企业融资综合信用服务平台省级节点数据接口规范，国家公共信用信息中心，河南省营商环境和社会信用建设中心，2024年7月</p>
<ol>
<li>jar 包引入</li>
</ol>
<pre tabindex="0"><code>
&lt;dependency&gt;  
&lt;groupId&gt;cn.hutool&lt;/groupId&gt;  
&lt;artifactId&gt;hutool-all&lt;/artifactId&gt;  
&lt;version&gt;5.8.10&lt;/version&gt;  
&lt;/dependency&gt;  
&lt;dependency&gt;  
&lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;  
&lt;artifactId&gt;bcprov-jdk15on&lt;/artifactId&gt;  
&lt;version&gt;1.70&lt;/version&gt;  
&lt;/dependency&gt;  
&lt;dependency&gt;  
&lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;  
&lt;artifactId&gt;bcpkix-jdk15on&lt;/artifactId&gt;  
&lt;version&gt;1.70&lt;/version&gt;  
&lt;/dependency&gt;  
&lt;dependency&gt;  
&lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;  
&lt;artifactId&gt;cxf-rt-frontend-jaxws&lt;/artifactId&gt;  
&lt;version&gt;4.0.5&lt;/version&gt;  
&lt;/dependency&gt;  
&lt;dependency&gt;  
&lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;  
&lt;artifactId&gt;cxf-rt-transports-http&lt;/artifactId&gt;  
&lt;version&gt;4.0.5&lt;/version&gt;  
&lt;/dependency&gt;
</code></pre><ol start="2">
<li>上报工具类，其中：queryData 方法是用来查询，sendData 方法用来上报数据</li>
</ol>
<pre tabindex="0"><code>
package cn.bridgeli.demo;

import cn.hutool.core.util.RandomUtil;  
import com.alibaba.fastjson.JSONObject;  
import lombok.extern.slf4j.Slf4j;  
import org.apache.commons.codec.CharEncoding;  
import org.apache.commons.lang3.StringUtils;  
import org.apache.cxf.endpoint.Client;  
import org.apache.cxf.jaxws.endpoint.dynamic.JaxWsDynamicClientFactory;  
import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey;  
import org.bouncycastle.util.encoders.Base64;  
import org.bouncycastle.util.encoders.Hex;

import javax.xml.namespace.QName;  
import java.io.File;  
import java.io.FileInputStream;  
import java.io.FileOutputStream;  
import java.io.IOException;  
import java.io.InputStream;  
import java.math.BigInteger;  
import java.security.PublicKey;

@Slf4j  
public class XyhnUtil {

private static String pubKey;  
private static String queryPubKey;

private static PublicKey reportPublicKey;

// private static XyhnConfig xyhnConfig = SpringUtils.getBean(XyhnConfig.class);  
private static XyhnConfig xyhnConfig = null;

/**  
* 授权查询省平台接口  
*  
* @param method 要调取的方法名  
* @param object 查询方法的参数（不包含：publicKey、appKey）  
* @return 省平台解密后的数据  
*/  
public static String queryData(String method, JSONObject object) {  
//1、组装报文  
if (StringUtils.isEmpty(queryPubKey)) {  
queryPubKey = convertFileToBase64(xyhnConfig.getQueryPubKeyPath());  
}

object.put(&#34;publicKey&#34;, queryPubKey);  
object.put(&#34;appKey&#34;, xyhnConfig.getQueryAppKey());  
//2、发送报文  
String jsonRes = callInterface(&#34;query&#34;, method, object.toJSONString());

//3、解密返回数据  
JSONObject json = JSONObject.parseObject(jsonRes);  
Boolean success = json.getBoolean(&#34;success&#34;);  
if (&#34;uploadLicense&#34;.equals(method)) {  
if (null == success || !success) {  
return jsonRes;  
}  
} else if (&#34;cancelLicense&#34;.equals(method)) {  
if (null != success &amp;&amp; success) {  
return jsonRes;  
}  
}

BigInteger d = new BigInteger(xyhnConfig.getQueryPriKey(), 16);  
BCECPrivateKey bcecPrivateKey = GMUtil.getPrivatekeyFromD(d);  
String key0 = json.getString(&#34;key&#34;);  
String data = json.getString(&#34;data&#34;);  
String signatureData = json.getString(&#34;signatureData&#34;);  
byte[] decode = Hex.decode(key0);  
// sm2解密  
byte[] bytes1 = GMUtil.sm2Decrypt(decode, bcecPrivateKey);  
// sm4解密  
String content = GMUtil.sm4Decrypt(new String(bytes1), data);  
log.info(&#34;content: &#34; + content);  
// 4、验签  
File file = base64ToFileEx(json.getString(&#34;pubKey&#34;));  
PublicKey publicKey = GMUtil.getPublickeyFromX509File(file);  
byte[] signatureData1 = Hex.decode(signatureData);  
boolean verifyRes = GMUtil.verifySm3WithSm2(content.getBytes(), xyhnConfig.getUserId().getBytes(), signatureData1, publicKey);  
log.info(&#34;method 验签结果：&#34; + verifyRes);  
if (!verifyRes) {  
return null;  
}  
return content;  
}

private static PublicKey getPublicKey() {  
//1、组装报文  
if (StringUtils.isEmpty(pubKey)) {  
pubKey = convertFileToBase64(xyhnConfig.getPubKeyPath());  
}  
JSONObject jsonObject = new JSONObject();  
jsonObject.put(&#34;key&#34;, xyhnConfig.getAppKey());  
JSONObject object = new JSONObject();  
object.put(&#34;requestData&#34;, jsonObject);  
object.put(&#34;publicKey&#34;, pubKey);  
//2、发送报文  
String jsonRes = callInterface(&#34;report&#34;, &#34;getPublicKey&#34;, object.toJSONString());

//3、解密返回数据  
JSONObject json = JSONObject.parseObject(jsonRes);  
BigInteger d = new BigInteger(xyhnConfig.getPriKey(), 16);  
BCECPrivateKey bcecPrivateKey = GMUtil.getPrivatekeyFromD(d);  
String key0 = json.getString(&#34;key&#34;);  
String data = json.getString(&#34;data&#34;);  
String signatureData = json.getString(&#34;signatureData&#34;);  
byte[] decode = Hex.decode(key0);  
// sm2解密  
byte[] bytes1 = GMUtil.sm2Decrypt(decode, bcecPrivateKey);  
// sm4解密  
String returnData = GMUtil.sm4Decrypt(new String(bytes1), data);  
log.info(&#34;returnData:&#34; + returnData);  
// 4、验签  
File file = base64ToFileEx(returnData);  
PublicKey publicKey = GMUtil.getPublickeyFromX509File(file);  
byte[] signatureData1 = Hex.decode(signatureData);  
boolean verifyRes = GMUtil.verifySm3WithSm2(returnData.getBytes(), xyhnConfig.getUserId().getBytes(), signatureData1, publicKey);  
log.info(&#34;getPublicKey 接口验签结果：&#34; + verifyRes);  
if (!verifyRes) {  
return null;  
}  
return publicKey;  
}

public static String sendData(String jsonStr, String method) {

log.info(&#34;调用省平台方法名：&#34; + method + &#34;，参数：&#34; + jsonStr);

try {  
if (StringUtils.isEmpty(pubKey)) { // 解析公钥  
pubKey = convertFileToBase64(xyhnConfig.getPubKeyPath());  
}  
if (reportPublicKey == null) { //请求接口，获取公钥  
reportPublicKey = getPublicKey();  
}

// 1、摘要签名 sm2withsm3  
byte[] msg = jsonStr.getBytes(CharEncoding.ISO_8859_1);  
byte[] userIdBytes = xyhnConfig.getUserId().getBytes();  
BigInteger d = new BigInteger(xyhnConfig.getPriKey(), 16);  
BCECPrivateKey bcecPrivateKey = GMUtil.getPrivatekeyFromD(d);  
byte[] sig = GMUtil.signSm3WithSm2(msg, userIdBytes, bcecPrivateKey);  
String signature = Hex.toHexString(sig);

// 2、sm4加密数据报文  
String key1 = RandomUtil.randomString(16);  
String jsonobj = GMUtil.sm4Encrypt(key1, jsonStr);

//3、sm2加密16位随机码key  
byte[] datamsg = GMUtil.sm2Encrypt(key1.getBytes(), reportPublicKey);  
String s = Hex.toHexString(datamsg);

//4、组装并发送报文  
JSONObject jsonObject2 = new JSONObject();  
jsonObject2.put(&#34;requestData&#34;, jsonobj); // sm4加密的数据集  
jsonObject2.put(&#34;key&#34;, s); // sm2加密的16位随机码  
jsonObject2.put(&#34;signatureData&#34;, signature); // 签名  
jsonObject2.put(&#34;publicKey&#34;, pubKey); // 我的公钥  
jsonObject2.put(&#34;appKey&#34;, xyhnConfig.getAppKey()); // 数据授权的key

String setFPRes = callInterface(&#34;report&#34;, method, jsonObject2.toJSONString());  
return setFPRes;  
} catch (Exception ex) {  
log.error(&#34;请求省平台接口异常&#34;, ex);  
return null;  
}

}

/**  
* 请求接口  
*  
* @param type，report 回传数据，query 查询  
* @param method  
* @param json  
* @return  
*/  
private static String callInterface(String type, String method, String json) {  
log.info(&#34;调用省平台类型:&#34; + type + &#34;，接口：&#34; + method + &#34;，参数：&#34; + json);  
Client client = null;  
QName name = null;  
JaxWsDynamicClientFactory dcf = JaxWsDynamicClientFactory.newInstance();  
String result = null;  
try {  
if (&#34;report&#34;.equals(type)) {  
client = dcf.createClient(xyhnConfig.getWsAddr());  
name = new QName(xyhnConfig.getNamespaceURI(), method);  
} else if (&#34;query&#34;.equals(type)) {  
client = dcf.createClient(xyhnConfig.getQueryWsAddr());  
name = new QName(xyhnConfig.getQueryNamespaceURI(), method);  
}

Object[] objects = client.invoke(name, json);  
result = objects[0].toString();

} catch (Exception e) {  
log.error(&#34;调用省平台接口报错&#34;, e);  
} finally {  
if (client != null) {  
try {  
client.close();  
} catch (Exception e) {  
log.error(&#34;关闭Client资源时发生异常&#34;, e);  
}  
}  
}

log.info(&#34;调用省平台类型:&#34; + type + &#34;，接口：&#34; + method + &#34;，返回值：&#34; + result);

return result;  
}

private static String convertFileToBase64(String imgPath) {  
byte[] data = null;  
// 读取图片字节数组  
try (InputStream in = new FileInputStream(imgPath);) {  
data = new byte[in.available()];  
in.read(data);  
} catch (IOException e) {  
log.error(&#34;IOException&#34;, e);  
}  
// 对字节数组进行Base64编码，得到Base64编码的字符串  
String base64Str = java.util.Base64.getEncoder().encodeToString(data);  
return base64Str;  
}

private static File base64ToFileEx(String base64) {  
if (StringUtils.isBlank(base64)) {  
return null;  
}  
byte[] buff = Base64.decode(base64);  
File file = null;  
FileOutputStream fout = null;  
try {  
file = File.createTempFile(&#34;tmp&#34;, null);  
fout = new FileOutputStream(file);  
fout.write(buff);  
file.deleteOnExit();  
} catch (IOException e) {  
e.printStackTrace();  
} finally {  
if (fout != null) {  
try {  
fout.close();  
} catch (IOException e) {  
e.printStackTrace();  
}  
}  
}  
return file;  
}

}
</code></pre><ol start="3">
<li>用到的工具类</li>
</ol>
<pre tabindex="0"><code>
package cn.bridgeli.demo;

import lombok.extern.slf4j.Slf4j;  
import org.bouncycastle.asn1.ASN1EncodableVector;  
import org.bouncycastle.asn1.ASN1Integer;  
import org.bouncycastle.asn1.ASN1Sequence;  
import org.bouncycastle.asn1.DERSequence;  
import org.bouncycastle.asn1.gm.GMNamedCurves;  
import org.bouncycastle.asn1.x9.X9ECParameters;  
import org.bouncycastle.crypto.InvalidCipherTextException;  
import org.bouncycastle.crypto.engines.SM2Engine;  
import org.bouncycastle.crypto.params.ECDomainParameters;  
import org.bouncycastle.crypto.params.ECPrivateKeyParameters;  
import org.bouncycastle.crypto.params.ECPublicKeyParameters;  
import org.bouncycastle.crypto.params.ParametersWithRandom;  
import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey;  
import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPublicKey;  
import org.bouncycastle.jcajce.spec.SM2ParameterSpec;  
import org.bouncycastle.jce.provider.BouncyCastleProvider;  
import org.bouncycastle.jce.spec.ECParameterSpec;  
import org.bouncycastle.jce.spec.ECPrivateKeySpec;  
import org.bouncycastle.util.encoders.Hex;

import javax.crypto.Cipher;  
import javax.crypto.spec.SecretKeySpec;  
import java.io.File;  
import java.io.FileInputStream;  
import java.io.IOException;  
import java.math.BigInteger;  
import java.nio.charset.StandardCharsets;  
import java.security.Key;  
import java.security.PrivateKey;  
import java.security.PublicKey;  
import java.security.SecureRandom;  
import java.security.Security;  
import java.security.Signature;  
import java.security.cert.CertificateFactory;  
import java.security.cert.X509Certificate;  
import java.util.Arrays;

@Slf4j  
public class GMUtil {  
private static X9ECParameters x9ECParameters = GMNamedCurves.getByName(&#34;sm2p256v1&#34;);  
private static ECDomainParameters ecDomainParameters;  
private static ECParameterSpec ecParameterSpec;

public static byte[] signSm3WithSm2(byte[] msg, byte[] userId, PrivateKey privateKey) {  
return rsAsn1ToPlainByteArray(signSm3WithSm2Asn1Rs(msg, userId, privateKey));  
}

public static byte[] signSm3WithSm2Asn1Rs(byte[] msg, byte[] userId, PrivateKey privateKey) {  
try {  
SM2ParameterSpec parameterSpec = new SM2ParameterSpec(userId);  
Signature signer = Signature.getInstance(&#34;SM3withSM2&#34;, &#34;BC&#34;);  
signer.setParameter(parameterSpec);  
signer.initSign(privateKey, new SecureRandom());  
signer.update(msg, 0, msg.length);  
byte[] sig = signer.sign();  
return sig;  
} catch (Exception e) {  
throw new RuntimeException(e);  
}  
}

public static boolean verifySm3WithSm2(byte[] msg, byte[] userId, byte[] rs, PublicKey publicKey) {  
return verifySm3WithSm2Asn1Rs(msg, userId, rsPlainByteArrayToAsn1(rs), publicKey);  
}

public static boolean verifySm3WithSm2Asn1Rs(byte[] msg, byte[] userId, byte[] rs, PublicKey publicKey) {  
try {  
SM2ParameterSpec parameterSpec = new SM2ParameterSpec(userId);  
Signature verifier = Signature.getInstance(&#34;SM3withSM2&#34;, &#34;BC&#34;);  
verifier.setParameter(parameterSpec);  
verifier.initVerify(publicKey);  
verifier.update(msg, 0, msg.length);  
return verifier.verify(rs);  
} catch (Exception e) {  
throw new RuntimeException(e);  
}  
}

public static byte[] changeC1C2C3ToC1C3C2(byte[] c1c2c3) {  
int c1Len = (x9ECParameters.getCurve().getFieldSize() + 7) / 8 * 2 + 1;

byte[] result = new byte[c1c2c3.length];  
System.arraycopy(c1c2c3, 0, result, 0, c1Len);  
System.arraycopy(c1c2c3, c1c2c3.length &amp;#8211; 32, result, c1Len, 32);  
System.arraycopy(c1c2c3, c1Len, result, c1Len + 32, c1c2c3.length &amp;#8211; c1Len &amp;#8211; 32);  
return result;  
}

public static byte[] changeC1C3C2ToC1C2C3(byte[] c1c3c2) {  
int c1Len = (x9ECParameters.getCurve().getFieldSize() + 7) / 8 * 2 + 1;

byte[] result = new byte[c1c3c2.length];  
System.arraycopy(c1c3c2, 0, result, 0, c1Len);  
System.arraycopy(c1c3c2, c1Len + 32, result, c1Len, c1c3c2.length &amp;#8211; c1Len &amp;#8211; 32);  
System.arraycopy(c1c3c2, c1Len, result, c1c3c2.length &amp;#8211; 32, 32);  
return result;  
}

public static byte[] sm2Decrypt(byte[] data, PrivateKey key) {  
return sm2DecryptOld(changeC1C3C2ToC1C2C3(data), key);  
}

public static byte[] sm2Encrypt(byte[] data, PublicKey key) {  
return changeC1C2C3ToC1C3C2(sm2EncryptOld(data, key));  
}

public static byte[] sm2EncryptOld(byte[] data, PublicKey key) {  
BCECPublicKey localECPublicKey = (BCECPublicKey) key;  
ECPublicKeyParameters ecPublicKeyParameters = new ECPublicKeyParameters(localECPublicKey.getQ(), ecDomainParameters);  
SM2Engine sm2Engine = new SM2Engine();  
sm2Engine.init(true, new ParametersWithRandom(ecPublicKeyParameters, new SecureRandom()));

try {  
return sm2Engine.processBlock(data, 0, data.length);  
} catch (InvalidCipherTextException e) {  
throw new RuntimeException(e);  
}  
}

public static byte[] sm2DecryptOld(byte[] data, PrivateKey key) {  
BCECPrivateKey localECPrivateKey = (BCECPrivateKey) key;  
ECPrivateKeyParameters ecPrivateKeyParameters = new ECPrivateKeyParameters(localECPrivateKey.getD(), ecDomainParameters);  
SM2Engine sm2Engine = new SM2Engine();  
sm2Engine.init(false, ecPrivateKeyParameters);

try {  
return sm2Engine.processBlock(data, 0, data.length);  
} catch (InvalidCipherTextException e) {  
throw new RuntimeException(e);  
}  
}

public static byte[] sm4Encrypt(byte[] keyBytes, byte[] plain) {  
byte[] keyBytes0;  
if (keyBytes.length != 16) {  
keyBytes0 = new byte[16];

for (int i = 0; i &lt; keyBytes0.length; ++i) {  
if (keyBytes.length &gt; i) {  
keyBytes0[i] = keyBytes[i];  
}  
}

keyBytes = keyBytes0;  
}

if (plain.length % 16 != 0) {  
keyBytes0 = new byte[16 * (plain.length / 16 + 1)];  
System.arraycopy(plain, 0, keyBytes0, 0, plain.length);  
plain = keyBytes0;  
}

try {  
Key key = new SecretKeySpec(keyBytes, &#34;SM4&#34;);  
Cipher out = Cipher.getInstance(&#34;SM4/ECB/NoPadding&#34;, &#34;BC&#34;);  
out.init(1, key);  
return out.doFinal(plain);  
} catch (Exception e) {  
throw new RuntimeException(e);  
}  
}

public static byte[] sm4Decrypt(byte[] keyBytes, byte[] cipher) {  
byte[] keyBytes0;  
if (keyBytes.length != 16) {  
keyBytes0 = new byte[16];

for (int i = 0; i &lt; keyBytes0.length; ++i) {  
if (keyBytes.length &gt; i) {  
keyBytes0[i] = keyBytes[i];  
}  
}

keyBytes = keyBytes0;  
}

if (cipher.length % 16 != 0) {  
keyBytes0 = new byte[16 * (cipher.length / 16 + 1)];  
System.arraycopy(cipher, 0, keyBytes0, 0, cipher.length);  
cipher = keyBytes0;  
}

try {  
Key key = new SecretKeySpec(keyBytes, &#34;SM4&#34;);  
Cipher in = Cipher.getInstance(&#34;SM4/ECB/NoPadding&#34;, &#34;BC&#34;);  
in.init(2, key);  
byte[] bytes = in.doFinal(cipher);

for (int i = bytes.length &amp;#8211; 1; i &gt;= 0; &amp;#8211;i) {  
if (bytes[i] != 0) {  
byte[] bytes1 = new byte[i + 1];  
System.arraycopy(bytes, 0, bytes1, 0, i + 1);  
bytes = bytes1;  
i = -1;  
}  
}

return bytes;  
} catch (Exception e) {  
throw new RuntimeException(e);  
}  
}

public static String sm4Encrypt(String key, String plan) {  
byte[] keyBytes = new byte[16];  
byte[] keyBytes0 = key.getBytes(StandardCharsets.UTF_8);

for (int i = 0; i &lt; keyBytes.length; ++i) {  
if (keyBytes0.length &gt; i) {  
keyBytes[i] = keyBytes0[i];  
}  
}

byte[] cipher = plan.getBytes(StandardCharsets.UTF_8);

byte[] bytes = sm4Encrypt(keyBytes, cipher);  
return Hex.toHexString(bytes).toUpperCase();  
}

public static String sm4Decrypt(String key, String cipher) {  
byte[] keyBytes = new byte[16];  
byte[] keyBytes0 = key.getBytes(StandardCharsets.UTF_8);

for (int i = 0; i &lt; keyBytes.length; ++i) {  
if (keyBytes0.length &gt; i) {  
keyBytes[i] = keyBytes0[i];  
}  
}

byte[] cipherbytes = Hex.decode(cipher);  
byte[] bytes = sm4Decrypt(keyBytes, cipherbytes);

return new String(bytes, StandardCharsets.UTF_8);

}

private static byte[] bigIntToFixexLengthBytes(BigInteger rOrS) {  
byte[] rs = rOrS.toByteArray();  
if (rs.length == 32) {  
return rs;  
} else if (rs.length == 33 &amp;&amp; rs[0] == 0) {  
return Arrays.copyOfRange(rs, 1, 33);  
} else if (rs.length &lt; 32) {  
byte[] result = new byte[32];  
Arrays.fill(result, (byte) 0);  
System.arraycopy(rs, 0, result, 32 &amp;#8211; rs.length, rs.length);  
return result;  
} else {  
throw new RuntimeException(&#34;err rs: &#34; + Hex.toHexString(rs));  
}  
}

private static byte[] rsAsn1ToPlainByteArray(byte[] rsDer) {  
ASN1Sequence seq = ASN1Sequence.getInstance(rsDer);  
byte[] r = bigIntToFixexLengthBytes(ASN1Integer.getInstance(seq.getObjectAt(0)).getValue());  
byte[] s = bigIntToFixexLengthBytes(ASN1Integer.getInstance(seq.getObjectAt(1)).getValue());  
byte[] result = new byte[64];  
System.arraycopy(r, 0, result, 0, r.length);  
System.arraycopy(s, 0, result, 32, s.length);  
return result;  
}

private static byte[] rsPlainByteArrayToAsn1(byte[] sign) {  
if (sign.length != 64) {  
throw new RuntimeException(&#34;err rs. &#34;);  
} else {  
BigInteger r = new BigInteger(1, Arrays.copyOfRange(sign, 0, 32));  
BigInteger s = new BigInteger(1, Arrays.copyOfRange(sign, 32, 64));  
ASN1EncodableVector v = new ASN1EncodableVector();  
v.add(new ASN1Integer(r));  
v.add(new ASN1Integer(s));

try {  
return (new DERSequence(v)).getEncoded(&#34;DER&#34;);  
} catch (IOException var5) {  
throw new RuntimeException(var5);  
}  
}  
}

public static BCECPrivateKey getPrivatekeyFromD(BigInteger d) {  
ECPrivateKeySpec ecPrivateKeySpec = new ECPrivateKeySpec(d, ecParameterSpec);  
return new BCECPrivateKey(&#34;EC&#34;, ecPrivateKeySpec, BouncyCastleProvider.CONFIGURATION);  
}

public static PublicKey getPublickeyFromX509File(File file) {  
try {  
CertificateFactory cf = CertificateFactory.getInstance(&#34;X.509&#34;, &#34;BC&#34;);  
FileInputStream in = new FileInputStream(file);  
X509Certificate x509 = (X509Certificate) cf.generateCertificate(in);  
return x509.getPublicKey();  
} catch (Exception var4) {  
throw new RuntimeException(var4);  
}  
}

static {  
ecDomainParameters = new ECDomainParameters(x9ECParameters.getCurve(), x9ECParameters.getG(), x9ECParameters.getN());  
ecParameterSpec = new ECParameterSpec(x9ECParameters.getCurve(), x9ECParameters.getG(), x9ECParameters.getN());  
if (Security.getProvider(&#34;BC&#34;) == null) {  
Security.addProvider(new BouncyCastleProvider());  
}  
}  
}
</code></pre><ol start="4">
<li>相关配置</li>
</ol>
<pre tabindex="0"><code>
package cn.bridgeli.demo;

import lombok.Data;  
import org.springframework.boot.context.properties.ConfigurationProperties;  
import org.springframework.stereotype.Component;

@Data  
@Component  
@ConfigurationProperties(prefix = &#34;xyhn&#34;)  
//@RefreshScope  
public class XyhnConfig {

private String userId;  
private String platformId;

private String appKey;  
private String priKey;  
private String wsAddr;  
private String namespaceURI;  
private String pubKeyPath;

private String queryAppKey;  
private String queryPriKey;  
private String queryWsAddr;  
private String queryNamespaceURI;  
private String queryPubKeyPath;  
}
</code></pre><p>以上是上报和查询数据的核心方法，下面是查询具体数据的封装</p>
<ol start="5">
<li>查询的接口：</li>
</ol>
<pre tabindex="0"><code>
package cn.bridgeli.demo;

public interface XyhnService {  
Response queryDatas(String param, String page, String size);  
}

package cn.bridgeli.demo;

import com.alibaba.fastjson.JSONObject;  
import lombok.extern.slf4j.Slf4j;  
import org.apache.commons.lang3.StringUtils;  
import org.w3c.dom.Document;  
import org.w3c.dom.Element;  
import org.w3c.dom.NamedNodeMap;  
import org.w3c.dom.NodeList;  
import org.xml.sax.InputSource;  
import org.xml.sax.SAXException;

import javax.xml.parsers.DocumentBuilder;  
import javax.xml.parsers.DocumentBuilderFactory;  
import javax.xml.parsers.ParserConfigurationException;  
import java.io.IOException;  
import java.io.StringReader;  
import java.util.ArrayList;  
import java.util.HashMap;  
import java.util.List;  
import java.util.Map;

@Slf4j  
public abstract class AbstractXyhnService implements XyhnService {

// private static ICompInfoService compInfoService = SpringUtils.getBean(ICompInfoService.class);

@Override  
public Response queryDatas(String enterpriseName, String page, String size) {

CompInfo compInfoParam = new CompInfo();  
// compInfoParam.setEnterpriseName(enterpriseName);  
// List&lt;CompInfo&gt; compInfos = compInfoService.selectCompInfoList(compInfoParam);  
// CompInfo compInfo = null;  
// if (CollectionUtils.isEmpty(compInfos)) {  
// compInfo = new CompInfo();  
// compInfo.setEnterpriseName(enterpriseName);  
// } else {  
// compInfo = compInfos.get(0);  
// }

List&lt;QueryParam&gt; list = buildQueryParam(compInfoParam);

QueryParam isDeleteParam = new QueryParam();  
isDeleteParam.setField_value(&#34;0&#34;);  
isDeleteParam.setField_name(&#34;$$_ISDELETE&#34;);  
isDeleteParam.setField_type(&#34;String&#34;);  
isDeleteParam.setField_symbol(&#34;=&#34;);  
list.add(isDeleteParam);

QueryParam stateParam = new QueryParam();  
stateParam.setField_value(&#34;0&#34;);  
stateParam.setField_name(&#34;$$_STATE&#34;);  
stateParam.setField_type(&#34;String&#34;);  
stateParam.setField_symbol(&#34;=&#34;);  
list.add(stateParam);

if (StringUtils.isBlank(size) || StringUtils.isBlank(page)) {  
size = &#34;20&#34;;  
page = &#34;1&#34;;  
}

JSONObject jsonObject = new JSONObject();  
buildTableIdParam(jsonObject);

jsonObject.put(&#34;query&#34;, list);  
jsonObject.put(&#34;page&#34;, page);  
jsonObject.put(&#34;size&#34;, size);

buildSortParam(jsonObject);

String data = XyhnUtil.queryData(&#34;queryPageDataByTableId&#34;, jsonObject);

return parseXml(data);  
}

protected abstract List&lt;QueryParam&gt; buildQueryParam(CompInfo compInfo);

protected abstract void buildTableIdParam(JSONObject jsonObject);

protected abstract void buildSortParam(JSONObject jsonObject);

public static Response parseXml(String xmlContent) {  
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();  
Document doc = null;  
try {  
DocumentBuilder builder = factory.newDocumentBuilder();  
doc = builder.parse(new InputSource(new StringReader(xmlContent)));  
} catch (ParserConfigurationException e) {  
log.error(&#34;ParserConfigurationException&#34;, e);  
} catch (IOException e) {  
log.error(&#34;IOException&#34;, e);  
} catch (SAXException e) {  
log.error(&#34;SAXException&#34;, e);  
}

if (null == doc) {  
return null;  
}

Response response = new Response();

Element root = doc.getDocumentElement();  
Element datas = (Element) root.getElementsByTagName(&#34;datas&#34;).item(0);

// Extract items  
NodeList rowList = datas.getElementsByTagName(&#34;row&#34;);  
if (rowList.getLength() &lt;= 0) {  
return response;  
}

List&lt;Map&lt;String, String&gt;&gt; items = new ArrayList&lt;&gt;();  
for (int i = 0; i &lt; rowList.getLength(); i++) {  
Element row = (Element) rowList.item(i);  
NodeList itemList = row.getElementsByTagName(&#34;item&#34;);  
if (itemList.getLength() == 0) {  
continue;  
}  
Map&lt;String, String&gt; itemMap = new HashMap&lt;&gt;();  
for (int j = 0; j &lt; itemList.getLength(); j++) {  
Element item = (Element) itemList.item(j);  
String key = item.getAttribute(&#34;field&#34;);  
String value = item.getTextContent();  
itemMap.put(key, value);  
}  
items.add(itemMap);

}  
response.setData(items);

// Extract attributes from the &amp;#8216;datas&amp;#8217; tag  
NamedNodeMap attrs = datas.getAttributes();  
response.setStartIndex(Integer.parseInt(attrs.getNamedItem(&#34;startIndex&#34;).getNodeValue()));  
response.setTotalPage(Integer.parseInt(attrs.getNamedItem(&#34;totalPage&#34;).getNodeValue()));  
response.setTotalSize(Integer.parseInt(attrs.getNamedItem(&#34;totalSize&#34;).getNodeValue()));  
response.setTime(Integer.parseInt(attrs.getNamedItem(&#34;time&#34;).getNodeValue()));  
response.setSize(Integer.parseInt(attrs.getNamedItem(&#34;size&#34;).getNodeValue()));

log.info(&#34;解析成对象之后: &#34; + JSONObject.toJSONString(response));

return response;  
}

}
</code></pre><p>查询的具体实现主要分三种：</p>
<p>① 普通查询，即公开公示的接口：</p>
<pre tabindex="0"><code>
package cn.bridgeli.demo;

import com.alibaba.fastjson.JSONObject;  
import org.springframework.stereotype.Service;

import java.util.List;  
import java.util.stream.Collectors;  
import java.util.stream.Stream;

@Service  
public class GsAoOpaDetailServiceImpl extends AbstractXyhnService {  
@Override  
protected List&lt;QueryParam&gt; buildQueryParam(CompInfo compInfo) {  
QueryParam queryParam = new QueryParam();  
queryParam.setField_value(compInfo.getEnterpriseName());  
queryParam.setField_type(&#34;String&#34;);  
queryParam.setField_symbol(&#34;=&#34;);  
queryParam.setField_name(&#34;ENTNAME&#34;);  
return Stream.of(queryParam).collect(Collectors.toList());  
}

@Override  
protected void buildTableIdParam(JSONObject jsonObject) {  
jsonObject.put(&#34;tableId&#34;, &#34;&#34;);  
}

@Override  
protected void buildSortParam(JSONObject jsonObject) {  
// jsonObject.put(&#34;sort&#34;, Stream.of(&#34;$$_MDATE&#34;).collect(Collectors.toList()));  
}  
}
</code></pre><p>② 普通授权接口</p>
<pre tabindex="0"><code>
package cn.bridgeli.demo;

import com.alibaba.fastjson.JSONObject;  
import org.springframework.stereotype.Service;

import javax.annotation.Resource;  
import java.util.List;  
import java.util.stream.Collectors;  
import java.util.stream.Stream;

@Service  
public class ZxqySbbxfjnServiceImpl extends AbstractXyhnService {  
@Resource  
private XYHNConfig xyhnConfig;

@Override  
protected List&lt;QueryParam&gt; buildQueryParam(CompInfo compInfo) {

if (!&#34;0&#34;.equals(compInfo.getCancelAuthState())) {  
throw new ServiceException(&#34;接口未授权，请先授权&#34;);  
}  
String licenseId = compInfo.getLicenseId();  
if (StringUtils.isBlank(licenseId)) {  
throw new ServiceException(&#34;接口未授权，无法调用&#34;);  
}

QueryParam queryParam = new QueryParam();  
queryParam.setField_value(compInfo.getEnterpriseName());  
queryParam.setField_type(&#34;String&#34;);  
queryParam.setField_symbol(&#34;=&#34;);  
queryParam.setField_name(&#34;enterpriseName&#34;);

QueryParam licenseIdParam = new QueryParam();  
licenseIdParam.setField_value(licenseId);  
licenseIdParam.setField_name(&#34;licenseId&#34;);  
licenseIdParam.setField_type(&#34;String&#34;);  
licenseIdParam.setField_symbol(&#34;=&#34;);

QueryParam uniscIdParam = new QueryParam();  
uniscIdParam.setField_value(compInfo.getUniscId());  
uniscIdParam.setField_name(&#34;uniscId&#34;);  
uniscIdParam.setField_type(&#34;String&#34;);  
uniscIdParam.setField_symbol(&#34;=&#34;);

QueryParam platformIdParam = new QueryParam();  
platformIdParam.setField_value(xyhnConfig.getPlatformId());  
platformIdParam.setField_name(&#34;platformId&#34;);  
platformIdParam.setField_type(&#34;String&#34;);  
platformIdParam.setField_symbol(&#34;=&#34;);

QueryParam searchOrgCodeParam = new QueryParam();  
// searchOrgCodeParam.setField_value(compInfo.getAuthorizedOrgsCode());  
searchOrgCodeParam.setField_name(&#34;searchOrgCode&#34;);  
searchOrgCodeParam.setField_type(&#34;String&#34;);  
searchOrgCodeParam.setField_symbol(&#34;=&#34;);

return Stream.of(queryParam, licenseIdParam, uniscIdParam, platformIdParam, searchOrgCodeParam).collect(Collectors.toList());  
}

@Override  
protected void buildTableIdParam(JSONObject jsonObject) {  
jsonObject.put(&#34;tableId&#34;, &#34;&#34;);  
}

@Override  
protected void buildSortParam(JSONObject jsonObject) {

}  
}
</code></pre><p>③ 省授权接口</p>
<pre tabindex="0"><code>
package cn.bridgeli.demo;

import com.alibaba.fastjson.JSONObject;  
import org.springframework.stereotype.Service;

import javax.annotation.Resource;  
import java.util.List;  
import java.util.stream.Collectors;  
import java.util.stream.Stream;

@Service  
public class SrstCbdwsbjfxxServiceImpl extends AbstractXyhnService {

@Resource  
private XYHNConfig xyhnConfig;

// searchSubject 和 searchSubjectCode，对应 getAuth 接口的 searchSubject 和 searchSubjectCode  
@Override  
protected List&lt;QueryParam&gt; buildQueryParam(CompInfo compInfo) {

String authId = compInfo.getAuthId();  
if (StringUtils.isBlank(authId)) {  
throw new ServiceException(&#34;请先获取省授权&#34;);  
}  
Date validDate = compInfo.getValidDate();

QueryParam searchSubjectParam = new QueryParam();  
searchSubjectParam.setField_value(compInfo.getEnterpriseName());  
searchSubjectParam.setField_type(&#34;String&#34;);  
searchSubjectParam.setField_symbol(&#34;=&#34;);  
searchSubjectParam.setField_name(&#34;aab004&#34;);

QueryParam searchSubjectCodeParam = new QueryParam();  
searchSubjectCodeParam.setField_value(compInfo.getUniscId());  
searchSubjectCodeParam.setField_type(&#34;String&#34;);  
searchSubjectCodeParam.setField_symbol(&#34;=&#34;);  
searchSubjectCodeParam.setField_name(&#34;aab039&#34;);

QueryParam authKeyParam = new QueryParam();  
authKeyParam.setField_value(xyhnConfig.getQueryAppKey());  
authKeyParam.setField_name(&#34;authKey&#34;);  
authKeyParam.setField_type(&#34;String&#34;);  
authKeyParam.setField_symbol(&#34;=&#34;);

QueryParam authIDParam = new QueryParam();  
authIDParam.setField_value(authId);  
authIDParam.setField_name(&#34;authID&#34;);  
authIDParam.setField_type(&#34;String&#34;);  
authIDParam.setField_symbol(&#34;=&#34;);

return Stream.of(searchSubjectParam, searchSubjectCodeParam, authKeyParam, authIDParam).collect(Collectors.toList());  
}

@Override  
protected void buildTableIdParam(JSONObject jsonObject) {  
jsonObject.put(&#34;tableId&#34;, &#34;&#34;);  
}

@Override  
protected void buildSortParam(JSONObject jsonObject) {

}  
}
</code></pre><ol start="6">
<li>查询参数的封装：</li>
</ol>
<pre tabindex="0"><code>
package cn.bridgeli.demo;

import lombok.Data;

@Data  
public class QueryParam {  
private String field_name;  
private String field_type;  
private String field_value;  
private String field_symbol;  
private String field_grantmapping;  
}
</code></pre><ol start="7">
<li>返回值的封装</li>
</ol>
<pre tabindex="0"><code>
package cn.bridgeli.demo;

import lombok.Data;

import java.util.List;  
import java.util.Map;

@Data  
public class Response {

private Integer startIndex;  
private Integer totalPage;  
private Integer totalSize;  
private Integer time;  
private Integer size;  
private List&lt;Map&lt;String, String&gt;&gt; data;  
}
</code></pre><ol start="8">
<li>接口类型</li>
</ol>
<pre tabindex="0"><code>
package cn.bridgeli.demo;

import lombok.Getter;

@Getter  
public enum FaGaiWeiInterfaceEnum {

gsQyjbxxServiceImpl(&#34;社会公开&#34;, &#34;工商企业基本信息（带行业代码）&#34;),  
zxqyQysfqsServiceImpl(&#34;授权查询&#34;, &#34;中小企业融资-企业是否欠税&#34;),  
zrtBdcqdjxxFdcqServiceImpl(&#34;授权查询&#34;, &#34;不动产_不动产权登记信息_房地产权信息-省授权&#34;),  
mztHydjxxServiceImpl(&#34;社会公开&#34;, &#34;婚姻登记信息-省授权&#34;),  
;

FaGaiWeiInterfaceEnum(String openType, String description) {  
this.openType = openType;  
this.description = description;  
}

private final String openType;  
private final String description;

}
</code></pre><p>最后也必须要说明的是，这段代码是我随手从项目中摘出来的，并不完全，也会存在很多问题，但思路是没错的，代码也存在很大的优化空间.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/webservice/">Webservice</a></li>
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 全国中小企业融资综合信用服务平台-省级节点数据接口规范-河南省营商环境和社会信用建设中心 on x"
            href="https://x.com/intent/tweet/?text=%e5%85%a8%e5%9b%bd%e4%b8%ad%e5%b0%8f%e4%bc%81%e4%b8%9a%e8%9e%8d%e8%b5%84%e7%bb%bc%e5%90%88%e4%bf%a1%e7%94%a8%e6%9c%8d%e5%8a%a1%e5%b9%b3%e5%8f%b0-%e7%9c%81%e7%ba%a7%e8%8a%82%e7%82%b9%e6%95%b0%e6%8d%ae%e6%8e%a5%e5%8f%a3%e8%a7%84%e8%8c%83-%e6%b2%b3%e5%8d%97%e7%9c%81%e8%90%a5%e5%95%86%e7%8e%af%e5%a2%83%e5%92%8c%e7%a4%be%e4%bc%9a%e4%bf%a1%e7%94%a8%e5%bb%ba%e8%ae%be%e4%b8%ad%e5%bf%83&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2024-09-24-%25E5%2585%25A8%25E5%259B%25BD%25E4%25B8%25AD%25E5%25B0%258F%25E4%25BC%2581%25E4%25B8%259A%25E8%259E%258D%25E8%25B5%2584%25E7%25BB%25BC%25E5%2590%2588%25E4%25BF%25A1%25E7%2594%25A8%25E6%259C%258D%25E5%258A%25A1%25E5%25B9%25B3%25E5%258F%25B0-%25E7%259C%2581%25E7%25BA%25A7%25E8%258A%2582%25E7%2582%25B9%25E6%2595%25B0%25E6%258D%25AE%2f&amp;hashtags=webservice">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 全国中小企业融资综合信用服务平台-省级节点数据接口规范-河南省营商环境和社会信用建设中心 on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2024-09-24-%25E5%2585%25A8%25E5%259B%25BD%25E4%25B8%25AD%25E5%25B0%258F%25E4%25BC%2581%25E4%25B8%259A%25E8%259E%258D%25E8%25B5%2584%25E7%25BB%25BC%25E5%2590%2588%25E4%25BF%25A1%25E7%2594%25A8%25E6%259C%258D%25E5%258A%25A1%25E5%25B9%25B3%25E5%258F%25B0-%25E7%259C%2581%25E7%25BA%25A7%25E8%258A%2582%25E7%2582%25B9%25E6%2595%25B0%25E6%258D%25AE%2f&amp;title=%e5%85%a8%e5%9b%bd%e4%b8%ad%e5%b0%8f%e4%bc%81%e4%b8%9a%e8%9e%8d%e8%b5%84%e7%bb%bc%e5%90%88%e4%bf%a1%e7%94%a8%e6%9c%8d%e5%8a%a1%e5%b9%b3%e5%8f%b0-%e7%9c%81%e7%ba%a7%e8%8a%82%e7%82%b9%e6%95%b0%e6%8d%ae%e6%8e%a5%e5%8f%a3%e8%a7%84%e8%8c%83-%e6%b2%b3%e5%8d%97%e7%9c%81%e8%90%a5%e5%95%86%e7%8e%af%e5%a2%83%e5%92%8c%e7%a4%be%e4%bc%9a%e4%bf%a1%e7%94%a8%e5%bb%ba%e8%ae%be%e4%b8%ad%e5%bf%83&amp;summary=%e5%85%a8%e5%9b%bd%e4%b8%ad%e5%b0%8f%e4%bc%81%e4%b8%9a%e8%9e%8d%e8%b5%84%e7%bb%bc%e5%90%88%e4%bf%a1%e7%94%a8%e6%9c%8d%e5%8a%a1%e5%b9%b3%e5%8f%b0-%e7%9c%81%e7%ba%a7%e8%8a%82%e7%82%b9%e6%95%b0%e6%8d%ae%e6%8e%a5%e5%8f%a3%e8%a7%84%e8%8c%83-%e6%b2%b3%e5%8d%97%e7%9c%81%e8%90%a5%e5%95%86%e7%8e%af%e5%a2%83%e5%92%8c%e7%a4%be%e4%bc%9a%e4%bf%a1%e7%94%a8%e5%bb%ba%e8%ae%be%e4%b8%ad%e5%bf%83&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2f2024-09-24-%25E5%2585%25A8%25E5%259B%25BD%25E4%25B8%25AD%25E5%25B0%258F%25E4%25BC%2581%25E4%25B8%259A%25E8%259E%258D%25E8%25B5%2584%25E7%25BB%25BC%25E5%2590%2588%25E4%25BF%25A1%25E7%2594%25A8%25E6%259C%258D%25E5%258A%25A1%25E5%25B9%25B3%25E5%258F%25B0-%25E7%259C%2581%25E7%25BA%25A7%25E8%258A%2582%25E7%2582%25B9%25E6%2595%25B0%25E6%258D%25AE%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 全国中小企业融资综合信用服务平台-省级节点数据接口规范-河南省营商环境和社会信用建设中心 on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2024-09-24-%25E5%2585%25A8%25E5%259B%25BD%25E4%25B8%25AD%25E5%25B0%258F%25E4%25BC%2581%25E4%25B8%259A%25E8%259E%258D%25E8%25B5%2584%25E7%25BB%25BC%25E5%2590%2588%25E4%25BF%25A1%25E7%2594%25A8%25E6%259C%258D%25E5%258A%25A1%25E5%25B9%25B3%25E5%258F%25B0-%25E7%259C%2581%25E7%25BA%25A7%25E8%258A%2582%25E7%2582%25B9%25E6%2595%25B0%25E6%258D%25AE%2f&title=%e5%85%a8%e5%9b%bd%e4%b8%ad%e5%b0%8f%e4%bc%81%e4%b8%9a%e8%9e%8d%e8%b5%84%e7%bb%bc%e5%90%88%e4%bf%a1%e7%94%a8%e6%9c%8d%e5%8a%a1%e5%b9%b3%e5%8f%b0-%e7%9c%81%e7%ba%a7%e8%8a%82%e7%82%b9%e6%95%b0%e6%8d%ae%e6%8e%a5%e5%8f%a3%e8%a7%84%e8%8c%83-%e6%b2%b3%e5%8d%97%e7%9c%81%e8%90%a5%e5%95%86%e7%8e%af%e5%a2%83%e5%92%8c%e7%a4%be%e4%bc%9a%e4%bf%a1%e7%94%a8%e5%bb%ba%e8%ae%be%e4%b8%ad%e5%bf%83">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 全国中小企业融资综合信用服务平台-省级节点数据接口规范-河南省营商环境和社会信用建设中心 on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2f2024-09-24-%25E5%2585%25A8%25E5%259B%25BD%25E4%25B8%25AD%25E5%25B0%258F%25E4%25BC%2581%25E4%25B8%259A%25E8%259E%258D%25E8%25B5%2584%25E7%25BB%25BC%25E5%2590%2588%25E4%25BF%25A1%25E7%2594%25A8%25E6%259C%258D%25E5%258A%25A1%25E5%25B9%25B3%25E5%258F%25B0-%25E7%259C%2581%25E7%25BA%25A7%25E8%258A%2582%25E7%2582%25B9%25E6%2595%25B0%25E6%258D%25AE%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 全国中小企业融资综合信用服务平台-省级节点数据接口规范-河南省营商环境和社会信用建设中心 on whatsapp"
            href="https://api.whatsapp.com/send?text=%e5%85%a8%e5%9b%bd%e4%b8%ad%e5%b0%8f%e4%bc%81%e4%b8%9a%e8%9e%8d%e8%b5%84%e7%bb%bc%e5%90%88%e4%bf%a1%e7%94%a8%e6%9c%8d%e5%8a%a1%e5%b9%b3%e5%8f%b0-%e7%9c%81%e7%ba%a7%e8%8a%82%e7%82%b9%e6%95%b0%e6%8d%ae%e6%8e%a5%e5%8f%a3%e8%a7%84%e8%8c%83-%e6%b2%b3%e5%8d%97%e7%9c%81%e8%90%a5%e5%95%86%e7%8e%af%e5%a2%83%e5%92%8c%e7%a4%be%e4%bc%9a%e4%bf%a1%e7%94%a8%e5%bb%ba%e8%ae%be%e4%b8%ad%e5%bf%83%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2f2024-09-24-%25E5%2585%25A8%25E5%259B%25BD%25E4%25B8%25AD%25E5%25B0%258F%25E4%25BC%2581%25E4%25B8%259A%25E8%259E%258D%25E8%25B5%2584%25E7%25BB%25BC%25E5%2590%2588%25E4%25BF%25A1%25E7%2594%25A8%25E6%259C%258D%25E5%258A%25A1%25E5%25B9%25B3%25E5%258F%25B0-%25E7%259C%2581%25E7%25BA%25A7%25E8%258A%2582%25E7%2582%25B9%25E6%2595%25B0%25E6%258D%25AE%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 全国中小企业融资综合信用服务平台-省级节点数据接口规范-河南省营商环境和社会信用建设中心 on telegram"
            href="https://telegram.me/share/url?text=%e5%85%a8%e5%9b%bd%e4%b8%ad%e5%b0%8f%e4%bc%81%e4%b8%9a%e8%9e%8d%e8%b5%84%e7%bb%bc%e5%90%88%e4%bf%a1%e7%94%a8%e6%9c%8d%e5%8a%a1%e5%b9%b3%e5%8f%b0-%e7%9c%81%e7%ba%a7%e8%8a%82%e7%82%b9%e6%95%b0%e6%8d%ae%e6%8e%a5%e5%8f%a3%e8%a7%84%e8%8c%83-%e6%b2%b3%e5%8d%97%e7%9c%81%e8%90%a5%e5%95%86%e7%8e%af%e5%a2%83%e5%92%8c%e7%a4%be%e4%bc%9a%e4%bf%a1%e7%94%a8%e5%bb%ba%e8%ae%be%e4%b8%ad%e5%bf%83&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2f2024-09-24-%25E5%2585%25A8%25E5%259B%25BD%25E4%25B8%25AD%25E5%25B0%258F%25E4%25BC%2581%25E4%25B8%259A%25E8%259E%258D%25E8%25B5%2584%25E7%25BB%25BC%25E5%2590%2588%25E4%25BF%25A1%25E7%2594%25A8%25E6%259C%258D%25E5%258A%25A1%25E5%25B9%25B3%25E5%258F%25B0-%25E7%259C%2581%25E7%25BA%25A7%25E8%258A%2582%25E7%2582%25B9%25E6%2595%25B0%25E6%258D%25AE%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 全国中小企业融资综合信用服务平台-省级节点数据接口规范-河南省营商环境和社会信用建设中心 on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=%e5%85%a8%e5%9b%bd%e4%b8%ad%e5%b0%8f%e4%bc%81%e4%b8%9a%e8%9e%8d%e8%b5%84%e7%bb%bc%e5%90%88%e4%bf%a1%e7%94%a8%e6%9c%8d%e5%8a%a1%e5%b9%b3%e5%8f%b0-%e7%9c%81%e7%ba%a7%e8%8a%82%e7%82%b9%e6%95%b0%e6%8d%ae%e6%8e%a5%e5%8f%a3%e8%a7%84%e8%8c%83-%e6%b2%b3%e5%8d%97%e7%9c%81%e8%90%a5%e5%95%86%e7%8e%af%e5%a2%83%e5%92%8c%e7%a4%be%e4%bc%9a%e4%bf%a1%e7%94%a8%e5%bb%ba%e8%ae%be%e4%b8%ad%e5%bf%83&u=http%3a%2f%2flocalhost%3a1313%2fposts%2f2024-09-24-%25E5%2585%25A8%25E5%259B%25BD%25E4%25B8%25AD%25E5%25B0%258F%25E4%25BC%2581%25E4%25B8%259A%25E8%259E%258D%25E8%25B5%2584%25E7%25BB%25BC%25E5%2590%2588%25E4%25BF%25A1%25E7%2594%25A8%25E6%259C%258D%25E5%258A%25A1%25E5%25B9%25B3%25E5%258F%25B0-%25E7%259C%2581%25E7%25BA%25A7%25E8%258A%2582%25E7%2582%25B9%25E6%2595%25B0%25E6%258D%25AE%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">分享技术带来的喜悦</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
