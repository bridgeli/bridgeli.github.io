<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Java | åˆ†äº«æŠ€æœ¯å¸¦æ¥çš„å–œæ‚¦</title>
<meta name="keywords" content="">
<meta name="description" content="æŠ€æœ¯åˆ†äº«åšå®¢">
<meta name="author" content="Bridge Li">
<link rel="canonical" href="http://localhost:1313/categories/java/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a29c24210eb31d9ce56f669c66a35c9c51b17376b7764e336a49af7dec914cf0.css" integrity="sha256-opwkIQ6zHZzlb2acZqNcnFGxc3a3dk4zakmvfeyRTPA=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://localhost:1313/categories/java/index.xml" title="rss">
<link rel="alternate" hreflang="en" href="http://localhost:1313/categories/java/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script>
</head>
<body class="list" id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="åˆ†äº«æŠ€æœ¯å¸¦æ¥çš„å–œæ‚¦ (Alt + H)">åˆ†äº«æŠ€æœ¯å¸¦æ¥çš„å–œæ‚¦</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="æ–‡ç« ">
                    <span>æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/about/" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header"><div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;Â»&nbsp;<a href="http://localhost:1313/categories/">Categories</a></div>
  <h1>
    Java
  </h1>
</header>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">æœ¬åœ°å¼€å‘ä¸åŒé¡¹ç›®ä½¿ç”¨ä¸åŒç‰ˆæœ¬ JDK çš„è§£å†³æ–¹æ¡ˆ
    </h2>
  </header>
  <div class="entry-content">
    <p>ä¸€èˆ¬æˆ‘ä»¬åœ¨å…¬å¸å·¥ä½œä¸­ï¼Œå¾ˆå°‘æœ‰äººå°±è´Ÿè´£ä¸€ä¸ªé¡¹ç›®ï¼Œè€Œè´Ÿè´£ä¸åŒçš„é¡¹ç›®ï¼Œç”±äºå„ç§åŸå› ä½¿ç”¨çš„ JDK ç‰ˆæœ¬å¯èƒ½å¹¶ä¸ç›¸åŒï¼Œå¦‚æœå­˜åœ¨ä¸å…¼å®¹çš„æƒ…å†µï¼Œé‚£ä¹ˆæœ¬åœ° mvn clean compile çš„æ—¶å€™å°±ä¼šæŠ¥é”™ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬å»ä¿®æ”¹æˆ‘ä»¬è®¾ç½®çš„ç¯å¢ƒå˜é‡ï¼Œå¦‚æœå¤šä¸ªé¡¹ç›®åŒæ—¶å¼€å‘ï¼Œé‚£ä¹ˆå°±éœ€è¦æ—¶ä¸æ—¶åˆ‡æ¥åˆ‡å»ï¼Œç‰¹åˆ«çƒ¦äººï¼Œå…¶å®è¿™ä¸ªé—®é¢˜ maven æ—©å°±æ›¿å¤§å®¶è€ƒè™‘è¿‡äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ï¼š
ä¿®æ”¹ maven çš„ toolchains.xml æ–‡ä»¶ &lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; &lt;!&amp;#8211; Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the &#34;License&#34;); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an &#34;AS IS&#34; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. &amp;#8211;&gt; &lt;!&amp;#8211; | This is the toolchains file for Maven. It can be specified at two levels: | | 1. User Level. This toolchains.xml file provides configuration for a single user, | and is normally provided in ${user.home}/.m2/toolchains.xml. | | NOTE: This location can be overridden with the CLI option: | | -t /path/to/user/toolchains.xml | | 2. Global Level. This toolchains.xml file provides configuration for all Maven | users on a machine (assuming they&amp;#8217;re all using the same Maven | installation). It&amp;#8217;s normally provided in | ${maven.conf}/toolchains.xml. | | NOTE: This location can be overridden with the CLI option: | | -gt /path/to/global/toolchains.xml | | The sections in this sample file are intended to give you a running start at | getting the most out of your Maven installation. |&amp;#8211;&gt; &lt;toolchains xmlns=&#34;http://maven.apache.org/TOOLCHAINS/1.1.0&#34; xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34; xsi:schemaLocation=&#34;http://maven.apache.org/TOOLCHAINS/1.1.0 http://maven.apache.org/xsd/toolchains-1.1.0.xsd&#34;&gt; &lt;!&amp;#8211; | With toolchains you can refer to installations on your system. This | way you don&amp;#8217;t have to hardcode paths in your pom.xml. | | Every toolchain consist of 3 elements: | * type: the type of tool. An often used value is &amp;#8216;jdk&amp;#8217;. Toolchains-aware | plugins should document which type you must use. | | * provides: A list of key/value-pairs. | Based on the toolchain-configuration in the pom.xml Maven will search for | matching &lt;provides/&gt; configuration. You can decide for yourself which key-value | pairs to use. Often used keys are &amp;#8216;version&amp;#8217;, &amp;#8216;vendor&amp;#8217; and &amp;#8216;arch&amp;#8217;. By default | the version has a special meaning. If you configured in the pom.xml &amp;#8216;1.5&amp;#8217; | Maven will search for 1.5 and above. | | * configuration: Additional configuration for this tool. | Look for documentation of the toolchains-aware plugin which configuration elements | can be used. | | See also https://maven.apache.org/guides/mini/guide-using-toolchains.html | | General example &lt;toolchain&gt; &lt;type/&gt; &lt;provides&gt; &lt;version&gt;1.0&lt;/version&gt; &lt;/provides&gt; &lt;configuration/&gt; &lt;/toolchain&gt; | JDK examples &lt;toolchain&gt; &lt;type&gt;jdk&lt;/type&gt; &lt;provides&gt; &lt;version&gt;1.5&lt;/version&gt; &lt;vendor&gt;sun&lt;/vendor&gt; &lt;/provides&gt; &lt;configuration&gt; &lt;jdkHome&gt;/path/to/jdk/1.5&lt;/jdkHome&gt; &lt;/configuration&gt; &lt;/toolchain&gt; &lt;toolchain&gt; &lt;type&gt;jdk&lt;/type&gt; &lt;provides&gt; &lt;version&gt;1.6&lt;/version&gt; &lt;vendor&gt;sun&lt;/vendor&gt; &lt;/provides&gt; &lt;configuration&gt; &lt;jdkHome&gt;/path/to/jdk/1.6&lt;/jdkHome&gt; &lt;/configuration&gt; &lt;/toolchain&gt; &amp;#8211;&gt; &lt;toolchain&gt; &lt;type&gt;jdk&lt;/type&gt; &lt;provides&gt; &lt;version&gt;17&lt;/version&gt; &lt;/provides&gt; &lt;configuration&gt; &lt;jdkHome&gt;D:\J2EE\Java\jdk-17&lt;/jdkHome&gt; &lt;/configuration&gt; &lt;/toolchain&gt; &lt;toolchain&gt; &lt;type&gt;jdk&lt;/type&gt; &lt;provides&gt; &lt;version&gt;8&lt;/version&gt; &lt;/provides&gt; &lt;configuration&gt; &lt;jdkHome&gt;D:\J2EE\Java\jdk1.8.0_311&lt;/jdkHome&gt; &lt;/configuration&gt; &lt;/toolchain&gt; &lt;/toolchains&gt; ä¿®æ”¹é¡¹ç›®çš„ pom.xml æ–‡ä»¶ &lt;profiles&gt; &lt;profile&gt; &lt;id&gt;dev&lt;/id&gt; &lt;activation&gt; &lt;activeByDefault&gt;false&lt;/activeByDefault&gt; &lt;/activation&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-toolchains-plugin&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;toolchain&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;configuration&gt; &lt;toolchains&gt; &lt;jdk&gt; &lt;version&gt;8&lt;/version&gt; &lt;/jdk&gt; &lt;/toolchains&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt; &lt;/profile&gt; &lt;/profiles&gt; ä¿®æ”¹å®Œæˆ‘ä»¬åœ¨ç¼–è¯‘çš„æ—¶å€™åªéœ€è¦è¿è¡Œï¼š mvn clean compile -Pdev å³å¯ï¼Œè¿™æ ·ç¼–è¯‘å°±ä¼šè‡ªåŠ¨ç”¨ jdk8 ä¹Ÿä¸æ˜¯ç³»ç»Ÿç¯å¢ƒå˜é‡é…ç½®çš„ï¼Œå½“ç„¶è¿˜æœ‰æ›´ç®€å•çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ pom.xml ä¸­çš„é…ç½®ï¼Œåªéœ€è¦æŠŠï¼š
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-12-25 02:24:23 +0000 +0000'>December 25, 2025</span>&nbsp;Â·&nbsp;<span>3 min</span>&nbsp;Â·&nbsp;<span>522 words</span>&nbsp;Â·&nbsp;<span>Bridge Li</span></footer>
  <a class="entry-link" aria-label="post link to æœ¬åœ°å¼€å‘ä¸åŒé¡¹ç›®ä½¿ç”¨ä¸åŒç‰ˆæœ¬ JDK çš„è§£å†³æ–¹æ¡ˆ" href="http://localhost:1313/posts/2025-12-25-%E6%9C%AC%E5%9C%B0%E5%BC%80%E5%8F%91%E4%B8%8D%E5%90%8C%E9%A1%B9%E7%9B%AE%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E7%89%88%E6%9C%AC-jdk-%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ä½¿ç”¨ docker ä¸€é”®éƒ¨ç½² ELK(åŒ…å«ä¸­æ–‡åˆ†è¯) æœåŠ¡è„šæœ¬
    </h2>
  </header>
  <div class="entry-content">
    <p>å‰å‡ å¤©å…¬å¸æœ‰ä¸ªéœ€æ±‚è¦åšå…¨æ–‡ç´¢å¼•ï¼Œäºæ˜¯å†™äº†ä¸€ä¸ªè„šæœ¬ä½¿ç”¨ docker ä¸€é”®éƒ¨ç½² ELK æœåŠ¡ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
#!/bin/bash set -e echo &#34;==================================================&#34; echo &#34;ğŸš€ å¼€å§‹éƒ¨ç½² ELK &#43; MySQL åŒæ­¥ï¼ˆä¸­æ–‡åˆ†è¯ &#43; å›ºå®šç´¢å¼•ï¼‰&#34; echo &#34;==================================================&#34; \# ==================== é…ç½®åŒºï¼ˆè¯·ä¿®æ”¹ï¼‰==================== MYSQL_HOST=&#34;192.168.124.6&#34; # âœï¸ ä¿®æ”¹ä¸ºä½ çš„ MySQL IP MYSQL_USER=&#34;root&#34; # è¯»å–æƒé™ç”¨æˆ· MYSQL_PASSWORD=&#34;123456&#34; # ç”¨æˆ·å¯†ç  MYSQL_DB=&#34;ams&#34; # æ•°æ®åº“å ELASTIC_PASSWORD=&#34;i*B4j6eD&#43;g0e&#34; # ES å¯†ç ï¼ˆè‡³å°‘ 8 ä½ï¼Œå«å¤§å°å†™&#43;æ•°å­—ï¼‰ ES_VERSION=&#34;8.11.3&#34; # å¿…é¡»ä¸ IK æ’ä»¶ç‰ˆæœ¬ä¸€è‡´ LOGSTASH_VERSION=&#34;8.11.3&#34; \# ======================================================== \# é¡¹ç›®è·¯å¾„ ROOT_DIR=&#34;/project/elastic-sync&#34; mkdir -p &#34;$ROOT_DIR&#34; cd &#34;$ROOT_DIR&#34; echo &#34;ğŸ“ åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„&#34; mkdir -p config/mysql config data/es data/kibana logs/logstash plugins/ik \# &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- ä¸‹è½½ IK åˆ†è¯æ’ä»¶ &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212; IK_URL=&#34;https://release.infinilabs.com/analysis-ik/stable/elasticsearch-analysis-ik-ik-${ES_VERSION}.zip&#34; IK_DIR=&#34;$ROOT_DIR/plugins/ik&#34; if [ ! -f &#34;$IK_DIR/plugin-descriptor.properties&#34; ]; then echo &#34;ğŸ“¥ æ­£åœ¨ä¸‹è½½ IK åˆ†è¯æ’ä»¶ v${ES_VERSION}&amp;#8230;&#34; wget -q &#34;$IK_URL&#34; -O /tmp/ik.zip unzip -q /tmp/ik.zip -d &#34;$IK_DIR&#34; rm /tmp/ik.zip chown -R 1000:1000 &#34;$IK_DIR&#34; echo &#34;âœ… IK æ’ä»¶å®‰è£…å®Œæˆ&#34; else echo &#34;â„¹ï¸ IK æ’ä»¶å·²å­˜åœ¨ï¼Œè·³è¿‡å®‰è£…&#34; fi \# &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- ç”Ÿæˆ elasticsearch.yml &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- cat &gt; config/elasticsearch.yml &lt;&lt; EOF cluster.name: production-cluster node.name: node-1 node.roles: [ data, master, ingest ] path: data: /usr/share/elasticsearch/data logs: /usr/share/elasticsearch/logs network.host: 0.0.0.0 http.port: 9200 http.cors.enabled: true http.cors.allow-origin: &#34;*&#34; discovery.type: single-node xpack.security.enabled: true xpack.security.http.ssl.enabled: false xpack.monitoring.collection.enabled: true EOF \# &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- ç”Ÿæˆ logstash.yml &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- cat &gt; config/logstash.yml &lt;&lt; EOF http.host: &#34;0.0.0.0&#34; xpack.monitoring.enabled: false config.reload.automatic: false EOF \# &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- ç”Ÿæˆ logstash.conf &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- cat &gt; config/logstash.conf &lt;&lt; EOF input { jdbc { jdbc_connection_string =&gt; &#34;jdbc:mysql://$MYSQL_HOST:3306/$MYSQL_DB?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai&#34; jdbc_user =&gt; &#34;$MYSQL_USER&#34; jdbc_password =&gt; &#34;$MYSQL_PASSWORD&#34; jdbc_driver_library =&gt; &#34;/usr/share/logstash/mysql/mysql-connector-java-8.0.30.jar&#34; jdbc_driver_class =&gt; &#34;com.mysql.cj.jdbc.Driver&#34; jdbc_default_timezone =&gt; &#34;Asia/Shanghai&#34; statement =&gt; &#34; SELECT * FROM article WHERE updated_at &gt;= :sql_last_value ORDER BY updated_at ASC &#34; use_column_value =&gt; true tracking_column =&gt; &#34;updated_at&#34; tracking_column_type =&gt; &#34;timestamp&#34; last_run_metadata_path =&gt; &#34;/usr/share/logstash/.logstash_jdbc_last_run&#34; schedule =&gt; &#34;\*/2 \* \* \* *&#34; } } filter { \# æ¸…æ´— content å­—æ®µä¸­çš„ HTML æ ‡ç­¾ if [content] { mutate { gsub =&gt; [ &#34;content&#34;, &#34;&lt;[^&gt;]*&gt;&#34;, &#34;&#34; # åˆ é™¤æ‰€æœ‰ HTML æ ‡ç­¾ï¼š&lt;p&gt;ã€&lt;div&gt;ã€&lt;span&gt; ç­‰ ] } \# å¯é€‰ï¼šè¿›ä¸€æ­¥æ¸…ç†å¤šä½™çš„ç©ºç™½å­—ç¬¦ mutate { gsub =&gt; [ &#34;content&#34;, &#34;\s&#43;&#34;, &#34; &#34; # å¤šä¸ªç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ã€æ¢è¡Œã€åˆ¶è¡¨ç¬¦ï¼‰åˆå¹¶ä¸ºä¸€ä¸ªç©ºæ ¼ ] } mutate { strip =&gt; [&#34;content&#34;] # å»é™¤é¦–å°¾ç©ºæ ¼ } } \# å¦‚æœ del_flag æ˜¯ 1ï¼Œæ ‡è®°è¯¥è®°å½•ç”¨äºåˆ é™¤ if [del_flag] == 1 { mutate { add_tag =&gt; [&#34;delete_document&#34;] } } } output { if &#34;delete_document&#34; in [tags] { elasticsearch { hosts =&gt; [&#34;http://elasticsearch:9200&#34;] user =&gt; &#34;elastic&#34; password =&gt; &#34;$ELASTIC_PASSWOR&#34; action =&gt; &#34;delete&#34; document_id =&gt; &#34;%{id}&#34; index =&gt; &#34;articles&#34; } } else { elasticsearch { hosts =&gt; [&#34;http://elasticsearch:9200&#34;] user =&gt; &#34;elastic&#34; password =&gt; &#34;$ELASTIC_PASSWOR&#34; index =&gt; &#34;articles&#34; # âœ… å›ºå®šç´¢å¼• document_id =&gt; &#34;%{id}&#34; # æ”¯æŒ varchar id doc_as_upsert =&gt; true # æ›´æ–°è¦†ç›– } } stdout { codec =&gt; rubydebug } } EOF \# &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- ç”Ÿæˆ docker-compose.yml &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- cat &gt; docker-compose.yml &lt;&lt; EOF services: elasticsearch: image: docker.elastic.co/elasticsearch/elasticsearch:$ES_VERSION container_name: elasticsearch environment: &amp;#8211; discovery.type=single-node &amp;#8211; ES_JAVA_OPTS=-Xms2g -Xmx2g &amp;#8211; xpack.security.enabled=true &amp;#8211; xpack.security.http.ssl.enabled=false &amp;#8211; ELASTIC_PASSWORD=$ELASTIC_PASSWORD ports: &amp;#8211; &#34;9200:9200&#34; volumes: &amp;#8211; ./data/es:/usr/share/elasticsearch/data &amp;#8211; ./config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml &amp;#8211; ./plugins/ik:/usr/share/elasticsearch/plugins/ik networks: &amp;#8211; elastic restart: unless-stopped healthcheck: test: [&#34;CMD-SHELL&#34;, &#34;curl -f http://localhost:9200 || exit 1&#34;] interval: 30s timeout: 10s retries: 3 kibana: image: docker.elastic.co/kibana/kibana:$LOGSTASH_VERSION container_name: kibana depends_on: elasticsearch: condition: service_healthy environment: &amp;#8211; ELASTICSEARCH_HOSTS=[&#34;http://elasticsearch:9200&#34;] &amp;#8211; ELASTICSEARCH_USERNAME=elastic &amp;#8211; ELASTICSEARCH_PASSWORD=$ELASTIC_PASSWORD &amp;#8211; SERVER_NAME=kibana.example.com &amp;#8211; I18N_LOCALE=zh-CN ports: &amp;#8211; &#34;5601:5601&#34; volumes: &amp;#8211; ./data/kibana:/usr/share/kibana/data networks: &amp;#8211; elastic restart: unless-stopped logstash: image: docker.elastic.co/logstash/logstash:$LOGSTASH_VERSION container_name: logstash depends_on: &amp;#8211; elasticsearch volumes: &amp;#8211; ./config/logstash.conf:/usr/share/logstash/pipeline/logstash.conf &amp;#8211; ./config/logstash.yml:/usr/share/logstash/config/logstash.yml &amp;#8211; ./logs/logstash:/var/log/logstash &amp;#8211; ./config/mysql:/usr/share/logstash/mysql networks: &amp;#8211; elastic restart: unless-stopped networks: elastic: driver: bridge EOF \# &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- ä¸‹è½½ MySQL JDBC é©±åŠ¨ &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- JDBC_JAR=&#34;config/mysql/mysql-connector-java-8.0.30.jar&#34; if [ ! -f &#34;$JDBC_JAR&#34; ]; then echo &#34;ğŸ“¥ ä¸‹è½½ MySQL JDBC é©±åŠ¨&amp;#8230;&#34; mkdir -p config/mysql wget -q https://repo1.maven.org/maven2/mysql/mysql-connector-java/8.0.30/mysql-connector-java-8.0.30.jar -O &#34;$JDBC_JAR&#34; echo &#34;âœ… JDBC é©±åŠ¨ä¸‹è½½å®Œæˆ&#34; fi \# &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- è®¾ç½®æƒé™ &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- echo &#34;ğŸ” è®¾ç½®ç›®å½•æƒé™&#34; chown -R 1000:1000 data/es plugins/ik chmod -R 755 config logs chmod -R 777 data/kibana \# &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- ç”Ÿæˆåˆ›å»ºç´¢å¼•è„šæœ¬ &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- cat &gt; create-index.sh &lt;&lt; &amp;#8216;EOF&amp;#8217; #!/bin/bash echo &#34;ğŸ”„ æ­£åœ¨åˆ›å»ºç´¢å¼• &amp;#8216;articles&amp;#8217; å¹¶é…ç½® IK åˆ†è¯å™¨&amp;#8230;&#34; curl -X PUT &#34;http://localhost:9200/articles&#34; \ -u elastic:$ELASTIC_PASSWORD \ -H &#34;Content-Type: application/json&#34; \ -d &amp;#8216; { &#34;settings&#34;: { &#34;index&#34;: { &#34;number_of_shards&#34;: 1, &#34;number_of_replicas&#34;: 1 }, &#34;analysis&#34;: { &#34;analyzer&#34;: { &#34;ik_analyzer&#34;: { &#34;type&#34;: &#34;custom&#34;, &#34;tokenizer&#34;: &#34;ik_max_word&#34;, &#34;filter&#34;: [&#34;lowercase&#34;] } } } }, &#34;mappings&#34;: { &#34;properties&#34;: { &#34;id&#34;: { &#34;type&#34;: &#34;keyword&#34; }, &#34;title&#34;: { &#34;type&#34;: &#34;text&#34;, &#34;analyzer&#34;: &#34;ik_max_word&#34;, &#34;search_analyzer&#34;: &#34;ik_smart&#34; }, &#34;content&#34;: { &#34;type&#34;: &#34;text&#34;, &#34;analyzer&#34;: &#34;ik_max_word&#34;, &#34;search_analyzer&#34;: &#34;ik_smart&#34; }, &#34;author&#34;: { &#34;type&#34;: &#34;keyword&#34; }, &#34;created_at&#34;: { &#34;type&#34;: &#34;date&#34; }, &#34;updated_at&#34;: { &#34;type&#34;: &#34;date&#34; } } } }&amp;#8217; &amp;&amp; echo &#34;âœ… ç´¢å¼• &amp;#8216;articles&amp;#8217; åˆ›å»ºæˆåŠŸï¼&#34; EOF chmod &#43;x create-index.sh \# &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- å®Œæˆ &amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;&amp;#8212;- echo &#34;==================================================&#34; echo &#34;ğŸ‰ éƒ¨ç½²å‡†å¤‡å®Œæˆï¼&#34; echo &#34;==================================================&#34; echo &#34;&#34; echo &#34;ğŸ“Œ ä¸‹ä¸€æ­¥æ“ä½œï¼š&#34; echo &#34;1. æ£€æŸ¥é…ç½®ï¼šnano setup-elastic-sync.sh ï¼ˆä¿®æ”¹ MySQL åœ°å€ã€ç”¨æˆ·ã€å¯†ç ï¼‰&#34; echo &#34;2. å¢åŠ æƒé™ï¼šchmod &#43;x setup-elastic-sync.sh&#34; echo &#34;3. æ‰§è¡Œè„šæœ¬ï¼šsudo ./setup-elastic-sync.sh&#34; echo &#34;4. å¯åŠ¨æœåŠ¡ï¼šsudo docker compose up -d&#34; echo &#34;5. åˆ›å»ºç´¢å¼•ï¼šbash ./create-index.sh&#34; echo &#34;6. è®¿é—® Kibanaï¼šhttp://ä½ çš„æœåŠ¡å™¨IP:5601&#34; echo &#34; &amp;#8211; ç”¨æˆ·ï¼šelastic&#34; echo &#34; &amp;#8211; å¯†ç ï¼š$ELASTIC_PASSWORD&#34; echo &#34;&#34; echo &#34;ğŸ’¡ é¦–æ¬¡è¿è¡Œä¼šå…¨é‡åŒæ­¥ articles è¡¨ï¼Œä¹‹åæ¯ 2 åˆ†é’Ÿå¢é‡åŒæ­¥&#34; echo &#34;ğŸ” åœ¨ Kibana ä¸­æœç´¢ä¸­æ–‡ï¼ˆå¦‚â€œé˜¿é‡Œå·´å·´â€ï¼‰ï¼Œåº”èƒ½å‘½ä¸­ç»“æœ&#34; echo &#34;&#34; echo &#34;âš ï¸ æ³¨æ„ï¼šå¿…é¡»å…ˆè¿è¡Œ create-index.sh å†è®© Logstash å†™å…¥ï¼Œå¦åˆ™åˆ†è¯æ— æ•ˆï¼&#34; å¦‚æœ kibana ç”¨ elastic ç”¨æˆ·è¿ä¸ä¸Šï¼Œé€šè¿‡ Elasticsearch çš„ Security API ä¸ºå†…ç½®ç”¨æˆ· kibana_system ä¿®æ”¹å¯†ç ï¼š
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-08-28 09:26:14 +0000 +0000'>August 28, 2025</span>&nbsp;Â·&nbsp;<span>5 min</span>&nbsp;Â·&nbsp;<span>891 words</span>&nbsp;Â·&nbsp;<span>Bridge Li</span></footer>
  <a class="entry-link" aria-label="post link to ä½¿ç”¨ docker ä¸€é”®éƒ¨ç½² ELK(åŒ…å«ä¸­æ–‡åˆ†è¯) æœåŠ¡è„šæœ¬" href="http://localhost:1313/posts/2025-08-28-%E4%BD%BF%E7%94%A8-docker-%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2-elk-%E6%9C%8D%E5%8A%A1%E8%84%9A%E6%9C%AC/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">å…³äº Redis incr çš„ä¸€ä¸ªé—®é¢˜
    </h2>
  </header>
  <div class="entry-content">
    <p>å‰ä¸€æ®µæ—¶é—´æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦è®¡æ•°ï¼Œç†æ‰€å½“åœ°çš„ä½¿ç”¨äº† redis çš„ incr æ–¹æ³•ã€‚ä»£ç å¤§æ¦‚å¦‚ä¸‹ï¼š
@Scheduled(cron = &#34;0 0/10 \* \* * ?&#34;) public void test() { long yellowInterval = 5L; boolean isReachable = false; // TODO long delta = isReachable ? -1L : 1L; ValueOperations&lt;String, Long&gt; valueOperations = redisTemplate.opsForValue(); String key = RFID_NETWORK_STATUS_PREFIX &#43; rfDevice.getId(); Long increment = valueOperations.increment(key, delta); if (increment == null || increment &lt;= 0L) { } } else if (increment &gt;= yellowInterval) { if (Constants.RFID_NETWORK_STATUS_GREEN.equals(rfDevice.getNetworkStatus())) { } if (increment &gt;= yellowInterval * 3) { valueOperations.set(key, yellowInterval * 3); } } å¤§æ¦‚å°±æ˜¯æŸä¸ªæ“ä½œä¹‹åè®°ä¸€ä¸‹æ•°ï¼ŒåŠ ä¸€æˆ–è€…å‡ä¸€ï¼Œå¦‚æœåŠ åˆ°äº†æŸä¸ªå€¼ï¼Œå°±æŠŠå®ƒè®¾ç½®ä¸ºæŸä¸ªå€¼ã€‚æˆ‘ä»¬è¿™é‡Œå…ˆä¸è€ƒè™‘å¹¶å‘é—®é¢˜ã€‚ç»“æœåœ¨è¿è¡Œçš„æ—¶å€™é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼ŒæŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-07-30 10:23:46 +0000 +0000'>July 30, 2025</span>&nbsp;Â·&nbsp;<span>2 min</span>&nbsp;Â·&nbsp;<span>274 words</span>&nbsp;Â·&nbsp;<span>Bridge Li</span></footer>
  <a class="entry-link" aria-label="post link to å…³äº Redis incr çš„ä¸€ä¸ªé—®é¢˜" href="http://localhost:1313/posts/2025-07-30-%E5%85%B3%E4%BA%8E-redis-incr-%E7%9A%84%E4%B8%80%E4%B8%AA%E9%97%AE%E9%A2%98/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Gradle é¡¹ç›®æ‰“åŒ…æ„å»ºä¸­çš„ä¸¤ä¸ªå°é—®é¢˜
    </h2>
  </header>
  <div class="entry-content">
    <p> æ‰“åŒ…çš„æ—¶å€™æŠ¥é”™ï¼Œæç¤º jar é‡å¤ï¼Œå…·ä½“è¯¦æƒ…ï¼š * What went wrong: Execution failed for task &amp;#8216;:web-admin:bootJar&amp;#8217;. &gt; Entry BOOT-INF/lib/jaxb-core-4.0.3.jar is a duplicate but no duplicate handling strategy has been set. Please refer to https://docs.gradle.org/7.6.3/dsl/org.gradle.api.tasks.Copy.html#org.gradle.api.tasks.Copy:duplicatesStrategy for details. * Try: &gt; Run with &amp;#8211;stacktrace option to get the stack trace. &gt; Run with &amp;#8211;info or &amp;#8211;debug option to get more log output. &gt; Run with &amp;#8211;scan to get full insights. åœ¨æ‰“åŒ…Spring Bootåº”ç”¨æ—¶ï¼ŒBOOT-INF/lib/jaxb-core-4.0.3.jar æ–‡ä»¶å‡ºç°äº†é‡å¤é¡¹ï¼Œè€Œæ„å»ºè„šæœ¬ä¸­æ²¡æœ‰è®¾ç½®å¤„ç†é‡å¤æ–‡ä»¶çš„ç­–ç•¥ã€‚Gradleä¸å…è®¸é»˜è®¤æƒ…å†µä¸‹å­˜åœ¨é‡å¤æ–‡ä»¶ï¼Œå› æ­¤æ„å»ºå¤±è´¥ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªä¿®æ”¹æ„å»ºé…ç½®ï¼š
bootJar { duplicatesStrategy = DuplicatesStrategy.EXCLUDE } è¿™æ®µä»£ç å‘Šè¯‰ Gradle åœ¨å‘ç°é‡å¤æ–‡ä»¶æ—¶æ’é™¤å®ƒä»¬ã€‚æ ¹æ®ä½ çš„éœ€æ±‚ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–ç­–ç•¥å¦‚ DuplicatesStrategy.INCLUDE æˆ–è€… DuplicatesStrategy.WARNã€‚ç„¶åæ¸…ç†å’Œé‡æ–°æ„å»ºé¡¹ç›®å³å¯ã€‚
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-05-17 07:42:46 +0000 +0000'>May 17, 2025</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>144 words</span>&nbsp;Â·&nbsp;<span>Bridge Li</span></footer>
  <a class="entry-link" aria-label="post link to Gradle é¡¹ç›®æ‰“åŒ…æ„å»ºä¸­çš„ä¸¤ä¸ªå°é—®é¢˜" href="http://localhost:1313/posts/2025-05-17-gradle-%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85%E6%9E%84%E5%BB%BA%E4%B8%AD%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%B0%8F%E9%97%AE%E9%A2%98/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">nginx ä»£ç† sse æ¥å£ï¼ŒæŠ¥ï¼š(failed) net::ERR HTTP2 PROTOCOL ERROR
    </h2>
  </header>
  <div class="entry-content">
    <p>å‰ä¸€æ®µæ—¶é—´æ›¾å†™äº†ä¸€ç¯‡å…³äºSpring MVC é€šè¿‡ SSE å®ç°æ¶ˆæ¯æ¨é€çš„å°æ–‡ç« ï¼Œåæ¥ç³»ç»Ÿä¸Šçº¿çš„æ—¶å€™ï¼Œé‡åˆ°äº†ä¸€ä¸ªå°é—®é¢˜ï¼Œæ‰“å¼€æµè§ˆå™¨çš„ networkï¼Œçœ‹åˆ°æ¥å£æŠ¥ï¼š(failed) net::ERR HTTP2 PROTOCOL ERRORï¼Œé€šå¸¸æ˜¯å› ä¸º HTTP/2 åè®®ä¸ SSE çš„æŸäº›ç‰¹æ€§ä¸å…¼å®¹æ‰€å¯¼è‡´çš„ã€‚SSE æ˜¯åŸºäº HTTP åè®®çš„æœåŠ¡å™¨æ¨é€æŠ€æœ¯ï¼Œå®ƒè¦æ±‚è¿æ¥ä¿æŒæ‰“å¼€çŠ¶æ€ä»¥ä¾¿æœåŠ¡å™¨å¯ä»¥æŒç»­å‘é€æ›´æ–°ç»™å®¢æˆ·ç«¯ã€‚æˆ‘ä»¬ä½¿ç”¨çš„ nginx version æ˜¯ï¼šnginx/1.26.1
åªéœ€è¦æŒ‰å¦‚ä¸‹é…ç½®å³å¯è§£å†³ï¼š
server { listen 80; server_name bridgeli.com; access_log /var/log/nginx/bridgeli_access.log; error_log /var/log/nginx/bridgeli_error.log warn; location ^~ /admin-api/ { proxy_pass http://192.168.124.34:8080/; \# ç¡®ä¿ä½¿ç”¨HTTP/1.1æ¥æ”¯æŒSSE proxy_http_version 1.1; \# å…³é—­ä»£ç†è¿æ¥çš„â€œConnectionâ€å¤´ï¼Œä»¥é¿å…æ½œåœ¨çš„é—®é¢˜ proxy_set_header Connection &amp;#8221;; \# å¢åŠ è¶…æ—¶è®¾ç½®ï¼Œç¡®ä¿é•¿æ—¶é—´è¿æ¥ä¸ä¼šè¢«å…³é—­ proxy_read_timeout 86400s; proxy_send_timeout 86400s; \# å¦‚æœéœ€è¦ç¦ç”¨HTTP/2ï¼ˆå¯é€‰ï¼‰ \# æ³¨æ„ï¼šè¿™ä¸ªè®¾ç½®æ˜¯åœ¨serverå—ä¸­ï¼Œè€Œä¸æ˜¯locationå—ä¸­ \# listen 80 http2 off; å¯¹äºHTTP/2åè®®é”™è¯¯ç‰¹åˆ«æœ‰ç”¨ } location / { root /project/www/bridgeli/admin/; try_files $uri $uri/ /index.html; } } </p>
  </div>
  <footer class="entry-footer"><span title='2025-04-03 07:49:30 +0000 +0000'>April 3, 2025</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>75 words</span>&nbsp;Â·&nbsp;<span>Bridge Li</span></footer>
  <a class="entry-link" aria-label="post link to nginx ä»£ç† sse æ¥å£ï¼ŒæŠ¥ï¼š(failed) net::ERR HTTP2 PROTOCOL ERROR" href="http://localhost:1313/posts/2025-04-03-nginx-%E4%BB%A3%E7%90%86-sse-%E6%8E%A5%E5%8F%A3%E6%8A%A5failed-neterr-http2-protocol-error/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">å…³äº druid ç›‘æ§çš„ä¸¤ä¸ªå°é—®é¢˜
    </h2>
  </header>
  <div class="entry-content">
    <p>å‰ä¸€æ®µæ—¶é—´åšä¸€ä¸ªå°éœ€æ±‚ï¼Œéœ€è¦å±•ç¤º druid çš„ç›‘æ§é¡µé¢ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ druid ç›‘æ§åœ°å€æ˜¯ï¼šhttp://ip:port/druid/index.htmlï¼Œä½†æ˜¯å½“æ—¶ä¸€ç›´æŠ¥ 404ï¼Œåæ¥æŸ¥äº†èµ„æ–™ï¼Œå¼•å…¥çš„ jar åŒ…ï¼š
&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.2.24&lt;/version&gt; &lt;/dependency&gt; åº”è¯¥æ˜¯å› ä¸ºä¸æ˜¯é€šè¿‡ starter åŒ…å¼•å…¥çš„ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨é…ç½®ï¼š
package cn.bridgeli.demo; import com.alibaba.druid.support.jakarta.StatViewServlet; import com.alibaba.druid.support.jakarta.WebStatFilter; import com.alibaba.druid.util.Utils; import jakarta.servlet.Filter; import jakarta.servlet.FilterChain; import jakarta.servlet.ServletException; import jakarta.servlet.ServletRequest; import jakarta.servlet.ServletResponse; import org.springframework.boot.web.servlet.FilterRegistrationBean; import org.springframework.boot.web.servlet.ServletRegistrationBean; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import java.io.IOException; @Configuration public class DruidConfig { @Bean public ServletRegistrationBean&lt;StatViewServlet&gt; statViewServlet() { ServletRegistrationBean&lt;StatViewServlet&gt; servletRegistrationBean = new ServletRegistrationBean&lt;&gt;(new StatViewServlet(), &#34;/druid/*&#34;); // è®¾ç½®ç™»å½•ç”¨æˆ·åå’Œå¯†ç  servletRegistrationBean.addInitParameter(&#34;loginUsername&#34;, &#34;BridgeLi&#34;); servletRegistrationBean.addInitParameter(&#34;loginPassword&#34;, &#34;BridgeLi&#34;); return servletRegistrationBean; } @Bean public FilterRegistrationBean&lt;WebStatFilter&gt; webStatFilter() { FilterRegistrationBean&lt;WebStatFilter&gt; filterRegistrationBean = new FilterRegistrationBean&lt;&gt;(new WebStatFilter()); filterRegistrationBean.addUrlPatterns(&#34;/*&#34;); filterRegistrationBean.addInitParameter(&#34;exclusions&#34;, &#34;\*.js,\*.gif,\*.jpg,\*.png,\*.css,\*.ico,/druid/*&#34;); return filterRegistrationBean; } } å¦å¤–ä¸€ä¸ªå°é—®é¢˜å°±æ˜¯ï¼Œè¿™ä¹ˆå¼•å…¥ä¹‹åï¼Œæ‰“å¼€ç›‘æ§é¡µæœ€ä¸‹é¢ä¼šæœ‰ alibaba çš„å¹¿å‘Šï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯æƒ³å»æ‰çš„ï¼Œå¹¿å‘Šä»£ç æ‰€åœ¨çš„ä½ç½®åœ¨ support/http/resources/js/common.js è¿™ä¸ª js é‡Œé¢ï¼Œç½‘ä¸Šæœ‰äººè¯´ç›´æ¥è§£å‹åˆ æ‰ï¼Œé‡æ–°æ‰“åŒ…å°±è¡Œäº†ï¼Œä½†æ˜¯è¿™ä¸ªæœ‰é—®é¢˜å°±æ˜¯å¿…é¡»ç”¨é‡æ–°æ‰“åŒ…çš„è¿™ä¸ª jarï¼Œæœäº†ä¸€ä¸‹èµ„æ–™ï¼Œå…¶å®å»æ‰ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨ä¸Šé¢çš„é‚£ä¸ªç±»é‡Œé¢å¢åŠ ä¸€ä¸ª é…ç½®è¿‡æ»¤æ‰å³å¯ï¼š
...</p>
  </div>
  <footer class="entry-footer"><span title='2025-03-12 09:44:14 +0000 +0000'>March 12, 2025</span>&nbsp;Â·&nbsp;<span>2 min</span>&nbsp;Â·&nbsp;<span>310 words</span>&nbsp;Â·&nbsp;<span>Bridge Li</span></footer>
  <a class="entry-link" aria-label="post link to å…³äº druid ç›‘æ§çš„ä¸¤ä¸ªå°é—®é¢˜" href="http://localhost:1313/posts/2025-03-12-%E5%85%B3%E4%BA%8E-druid-%E7%9B%91%E6%8E%A7%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%B0%8F%E9%97%AE%E9%A2%98/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Spring MVC é€šè¿‡ SSE å®ç°æ¶ˆæ¯æ¨é€
    </h2>
  </header>
  <div class="entry-content">
    <p>åˆå¥½ä¹…æ²¡æœ‰å†™æ–‡ç« äº†ï¼Œè‡ªä»æœ‰äº†å¤§æ¨¡å‹ä¹‹åå†™æ–‡ç« çš„æ€åº¦è¶Šæ¥è¶Šæä¸èµ·å…´è¶£äº†ï¼Œæœ‰é—®é¢˜ï¼Œç›´æ¥é—®å¤§æ¨¡å‹å³å¯ã€‚å‰å‡ å¤©å…¬å¸æœ‰ä¸ªéœ€æ±‚ï¼Œæƒ³ç”¨ SSE å®ç°ï¼Œä¹‹å‰ä»æ²¡å†™è¿‡ï¼Œæ‰€ä»¥è®©å¤§æ¨¡å‹ç›´æ¥å†™ï¼Œç„¶åå®ç°è¶…çº§ç®€å•ï¼š
ç¼–å†™ SSE æœåŠ¡ï¼Œæ¥è¿›è¡Œåˆ›å»ºé“¾æ¥å’Œå‘é€æ¶ˆæ¯ package cn.bridgeli.demo; import lombok.Getter; import lombok.extern.slf4j.Slf4j; import org.apache.commons.collections4.CollectionUtils; import org.springframework.stereotype.Service; import org.springframework.web.servlet.mvc.method.annotation.SseEmitter; import java.io.IOException; import java.util.List; import java.util.Map; import java.util.concurrent.ConcurrentHashMap; @Slf4j @Getter @Service public class SseService { private final Map&lt;String, SseEmitter&gt; emitters = new ConcurrentHashMap&lt;&gt;(); public SseEmitter stream(String usrId) { SseEmitter emitter = emitters.computeIfAbsent(usrId, k -&gt; new SseEmitter(Long.MAX_VALUE)); emitter.onCompletion(() -&gt; { log.info(&#34;SSE emitter completed&#34;); emitters.remove(usrId); }); emitter.onError((throwable) -&gt; { log.error(&#34;Error occurred in SSE emitter&#34;, throwable); emitter.complete(); emitters.remove(usrId); }); emitter.onTimeout(() -&gt; { log.warn(&#34;SSE emitter timed out&#34;); emitter.complete(); emitters.remove(usrId); }); // å¯é€‰ï¼šè¿æ¥æˆåŠŸæ—¶å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªåˆå§‹äº‹ä»¶ try { emitter.send(SseEmitter.event().name(&#34;connect&#34;).data(&#34;è¿æ¥æˆåŠŸ&#34;)); } catch (IOException e) { log.error(&#34;Error occurred while sending initial event&#34;, e); emitter.completeWithError(e); } return emitter; } public void send(List&lt;String&gt; userIds, String name, Object object) { if (!emitters.isEmpty()) { // éå†æ‰€æœ‰ç”¨æˆ·çš„ SseEmitterï¼Œæ¨é€æ•°æ® if (CollectionUtils.isEmpty(userIds)) { emitters.forEach((userId, emitter) -&gt; { try { emitter.send(SseEmitter.event().name(name).data(object)); } catch (IOException e) { // å¦‚æœå‘é€å¤±è´¥ï¼Œåˆ™ç§»é™¤è¯¥ç”¨æˆ·çš„ emitter log.error(&#34;Error occurred while sending event to user {}&#34;, userId, e); emitter.completeWithError(e); emitters.remove(userId); } }); } else { userIds.forEach(userId -&gt; { SseEmitter emitter = emitters.get(userId); if (emitter != null) { try { emitter.send(SseEmitter.event().name(name).data(object)); } catch (IOException e) { // å¦‚æœå‘é€å¤±è´¥ï¼Œåˆ™ç§»é™¤è¯¥ç”¨æˆ·çš„ emitter log.error(&#34;Error occurred while sending event to user {}&#34;, userId, e); emitter.completeWithError(e); emitters.remove(userId); } } }); } } } } ç¼–å†™å¯¹åº”çš„ Controller ç»™å‰ç«¯æä¾›æ¥å£ï¼š package cn.bridgeli.demo; import cn.bridgeli.BaseAuthController; import io.swagger.v3.oas.annotations.tags.Tag; import jakarta.annotation.Resource; import lombok.extern.slf4j.Slf4j; import org.springframework.http.MediaType; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RestController; import org.springframework.web.servlet.mvc.method.annotation.SseEmitter; @Slf4j @RestController @Tag(name = &#34;SSE æ¨é€æœåŠ¡&#34;) @RequestMapping(&#34;/auth/common/sse&#34;) public class SseController extends BaseAuthController { @Resource private SseService sseService; @GetMapping(value = &#34;/stream&#34;, produces = MediaType.TEXT_EVENT_STREAM_VALUE) public SseEmitter stream() { return sseService.stream(getLoginUsr().getUsrId()); } } æ¶ˆæ¯æ¨é€å…·ä½“å®ç°ï¼š package cn.bridgeli.demo; import cn.bridgeli.common.SseService; import cn.bridgeli.monitor.MonitorService; import cn.bridgeli.vo.CpuInfoVo; import jakarta.annotation.Resource; import lombok.extern.slf4j.Slf4j; import org.springframework.scheduling.annotation.Scheduled; import org.springframework.stereotype.Component; import org.springframework.web.servlet.mvc.method.annotation.SseEmitter; import java.util.Map; @Component @Slf4j public class ScheduledTask { @Resource private MonitorService monitorService; @Resource private SseService sseService; /** * æ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ */ @Scheduled(cron = &#34;0 0/1 \* \* * ?&#34;) public void updateOrderStatus() { log.info(&#34;=============å®šæ—¶ä»»åŠ¡=============&#34;); Map&lt;String, SseEmitter&gt; emitters = sseService.getEmitters(); if (null == emitters || emitters.isEmpty()) { log.info(&#34;sse emitters is empty&#34;); return; } CpuInfoVo cpuData = monitorService.getCpuData(); sseService.send(null, &#34;cpu&#34;, cpuData); } } å…¶å®å°±æ˜¯å‰ç«¯è¿æ¥ä¹‹ååˆ›å»ºä¸€ä¸ªè¿æ¥ï¼Œä¿å­˜è¿æ¥ï¼Œç„¶ååˆ«çš„åœ°æ–¹äº§ç”Ÿæ¶ˆæ¯ï¼Œæ¨é€æ¶ˆæ¯ï¼Œæˆ‘çš„å®ä¾‹æ˜¯é€šè¿‡ oshi è·å– CPU ä½¿ç”¨ç‡ï¼Œå®ç°å¯¹ CPU çš„å®æ—¶ç›‘æ§ã€‚
</p>
  </div>
  <footer class="entry-footer"><span title='2025-02-27 01:26:08 +0000 +0000'>February 27, 2025</span>&nbsp;Â·&nbsp;<span>2 min</span>&nbsp;Â·&nbsp;<span>338 words</span>&nbsp;Â·&nbsp;<span>Bridge Li</span></footer>
  <a class="entry-link" aria-label="post link to Spring MVC é€šè¿‡ SSE å®ç°æ¶ˆæ¯æ¨é€" href="http://localhost:1313/posts/2025-02-27-spring-mvc-%E9%80%9A%E8%BF%87-sse-%E5%AE%9E%E7%8E%B0%E6%B6%88%E6%81%AF%E6%8E%A8%E9%80%81/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">å…¨å›½ä¸­å°ä¼ä¸šèèµ„ç»¼åˆä¿¡ç”¨æœåŠ¡å¹³å°-çœçº§èŠ‚ç‚¹æ•°æ®æ¥å£è§„èŒƒ-æ²³å—çœè¥å•†ç¯å¢ƒå’Œç¤¾ä¼šä¿¡ç”¨å»ºè®¾ä¸­å¿ƒ
    </h2>
  </header>
  <div class="entry-content">
    <p>å¼€å§‹ä¹‹å‰å…ˆè¯´ä¸€ç‚¹é¢˜å¤–è¯ï¼Œå‡ å¹´å‰æ›¾ç»çœ‹è¿‡ä¸€ä¸ªè§†é¢‘ï¼Œå…¶ä¸­ä¸€ä¸ªè§‚ç‚¹å¤§æ¦‚å°±æ˜¯ç¨‹åºå‘˜æ˜¯ä¸€ä¸ªåä¼ ç»Ÿçš„ç¾¤ä½“ï¼Œå…¶ä»–ç¾¤ä½“æŒæ¡äº†æŸä¸ªæŠ€æœ¯ï¼Œä¸€èˆ¬éƒ½æ˜¯å½“åšå†…éƒ¨å•†ä¸šæœºå¯†ï¼Œè€Œç¨‹åºå‘˜åˆ™ä¸ä¸€æ ·ï¼Œå–œæ¬¢å¼€æºï¼Œå°¤å…¶ GPL åè®®çš„å¼€æºï¼Œä¸ä»…è‡ªå·±æ¯«æ— ä¿ç•™çš„å¼€æºï¼Œè¿˜è¦æ±‚ä½¿ç”¨ä»–çš„è½¯ä»¶ä¹Ÿå¾—å¼€æºï¼Œä¹Ÿæ­£æ˜¯è¿™ç§å¼€æºé€ å°±äº†äº’è”ç½‘çš„è“¬å‹ƒå‘å±•ã€‚æˆ‘ç›®å‰æ‰€åœ¨å…¬å¸å› ä¸ºæ˜¯åšé‡‘èç›¸å…³çš„å…¬å¸ï¼Œå›½å®¶å‡ºäºæŸäº›åŸå› ï¼Œè¦æ±‚è¦ä¸ŠæŠ¥ç›¸å…³çš„æ•°æ®åˆ°çœå¹³å°ï¼Œè€Œçœå¹³å°çš„æŠ€æœ¯é‡‡ç”¨çš„æ˜¯ webserviceï¼Œå’Œæˆ‘ä»¬ç›®å‰ä¹ æƒ¯çš„ http æ¥å£ä¸å¤ªä¸€æ ·ï¼Œæ‰€ä»¥å‰ä¸€æ®µæ—¶é—´åœ¨å†™è¿™ä¸ªçš„æ—¶å€™èµ°äº†ä¸å°‘å¼¯è·¯ï¼Œè€Œç½‘ä¸Šä¹Ÿæ²¡æœ‰å‚è€ƒèµ„æ–™ï¼Œæ‰€ä»¥å†³å®šæŠŠç›¸å…³çš„æ ¸å¿ƒä»£ç å…¬å¸ƒå‡ºæ¥ï¼Œä¾›éœ€è¦çš„åŒå­¦å‚è€ƒã€‚éœ€è¦è¯´æ˜çš„æ˜¯ï¼šè¿™æ˜¯æˆ‘ä»¬æ²³å—çœçš„ç³»ç»Ÿç›¸å…³æ¥å£ï¼Œä¸çŸ¥é“å¤–çœæ˜¯å¦ä¸€è‡´ï¼Œçœå¹³å°ç»™çš„æ¥å£æ–‡æ¡£åæ˜¯ï¼šå…¨å›½ä¸­å°ä¼ä¸šèèµ„ç»¼åˆä¿¡ç”¨æœåŠ¡å¹³å°çœçº§èŠ‚ç‚¹æ•°æ®æ¥å£è§„èŒƒV5.3.pdfï¼Œé¦–é¡µå†™çš„æ˜¯ï¼šå…¨å›½ä¸­å°ä¼ä¸šèèµ„ç»¼åˆä¿¡ç”¨æœåŠ¡å¹³å°çœçº§èŠ‚ç‚¹æ•°æ®æ¥å£è§„èŒƒï¼Œå›½å®¶å…¬å…±ä¿¡ç”¨ä¿¡æ¯ä¸­å¿ƒï¼Œæ²³å—çœè¥å•†ç¯å¢ƒå’Œç¤¾ä¼šä¿¡ç”¨å»ºè®¾ä¸­å¿ƒï¼Œ2024å¹´7æœˆ
jar åŒ…å¼•å…¥ &lt;dependency&gt; &lt;groupId&gt;cn.hutool&lt;/groupId&gt; &lt;artifactId&gt;hutool-all&lt;/artifactId&gt; &lt;version&gt;5.8.10&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt; &lt;artifactId&gt;bcprov-jdk15on&lt;/artifactId&gt; &lt;version&gt;1.70&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.bouncycastle&lt;/groupId&gt; &lt;artifactId&gt;bcpkix-jdk15on&lt;/artifactId&gt; &lt;version&gt;1.70&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.cxf&lt;/groupId&gt; &lt;artifactId&gt;cxf-rt-frontend-jaxws&lt;/artifactId&gt; &lt;version&gt;4.0.5&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.cxf&lt;/groupId&gt; &lt;artifactId&gt;cxf-rt-transports-http&lt;/artifactId&gt; &lt;version&gt;4.0.5&lt;/version&gt; &lt;/dependency&gt; ä¸ŠæŠ¥å·¥å…·ç±»ï¼Œå…¶ä¸­ï¼šqueryData æ–¹æ³•æ˜¯ç”¨æ¥æŸ¥è¯¢ï¼ŒsendData æ–¹æ³•ç”¨æ¥ä¸ŠæŠ¥æ•°æ® package cn.bridgeli.demo; import cn.hutool.core.util.RandomUtil; import com.alibaba.fastjson.JSONObject; import lombok.extern.slf4j.Slf4j; import org.apache.commons.codec.CharEncoding; import org.apache.commons.lang3.StringUtils; import org.apache.cxf.endpoint.Client; import org.apache.cxf.jaxws.endpoint.dynamic.JaxWsDynamicClientFactory; import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey; import org.bouncycastle.util.encoders.Base64; import org.bouncycastle.util.encoders.Hex; import javax.xml.namespace.QName; import java.io.File; import java.io.FileInputStream; import java.io.FileOutputStream; import java.io.IOException; import java.io.InputStream; import java.math.BigInteger; import java.security.PublicKey; @Slf4j public class XyhnUtil { private static String pubKey; private static String queryPubKey; private static PublicKey reportPublicKey; // private static XyhnConfig xyhnConfig = SpringUtils.getBean(XyhnConfig.class); private static XyhnConfig xyhnConfig = null; /** * æˆæƒæŸ¥è¯¢çœå¹³å°æ¥å£ * * @param method è¦è°ƒå–çš„æ–¹æ³•å * @param object æŸ¥è¯¢æ–¹æ³•çš„å‚æ•°ï¼ˆä¸åŒ…å«ï¼špublicKeyã€appKeyï¼‰ * @return çœå¹³å°è§£å¯†åçš„æ•°æ® */ public static String queryData(String method, JSONObject object) { //1ã€ç»„è£…æŠ¥æ–‡ if (StringUtils.isEmpty(queryPubKey)) { queryPubKey = convertFileToBase64(xyhnConfig.getQueryPubKeyPath()); } object.put(&#34;publicKey&#34;, queryPubKey); object.put(&#34;appKey&#34;, xyhnConfig.getQueryAppKey()); //2ã€å‘é€æŠ¥æ–‡ String jsonRes = callInterface(&#34;query&#34;, method, object.toJSONString()); //3ã€è§£å¯†è¿”å›æ•°æ® JSONObject json = JSONObject.parseObject(jsonRes); Boolean success = json.getBoolean(&#34;success&#34;); if (&#34;uploadLicense&#34;.equals(method)) { if (null == success || !success) { return jsonRes; } } else if (&#34;cancelLicense&#34;.equals(method)) { if (null != success &amp;&amp; success) { return jsonRes; } } BigInteger d = new BigInteger(xyhnConfig.getQueryPriKey(), 16); BCECPrivateKey bcecPrivateKey = GMUtil.getPrivatekeyFromD(d); String key0 = json.getString(&#34;key&#34;); String data = json.getString(&#34;data&#34;); String signatureData = json.getString(&#34;signatureData&#34;); byte[] decode = Hex.decode(key0); // sm2è§£å¯† byte[] bytes1 = GMUtil.sm2Decrypt(decode, bcecPrivateKey); // sm4è§£å¯† String content = GMUtil.sm4Decrypt(new String(bytes1), data); log.info(&#34;content: &#34; &#43; content); // 4ã€éªŒç­¾ File file = base64ToFileEx(json.getString(&#34;pubKey&#34;)); PublicKey publicKey = GMUtil.getPublickeyFromX509File(file); byte[] signatureData1 = Hex.decode(signatureData); boolean verifyRes = GMUtil.verifySm3WithSm2(content.getBytes(), xyhnConfig.getUserId().getBytes(), signatureData1, publicKey); log.info(&#34;method éªŒç­¾ç»“æœï¼š&#34; &#43; verifyRes); if (!verifyRes) { return null; } return content; } private static PublicKey getPublicKey() { //1ã€ç»„è£…æŠ¥æ–‡ if (StringUtils.isEmpty(pubKey)) { pubKey = convertFileToBase64(xyhnConfig.getPubKeyPath()); } JSONObject jsonObject = new JSONObject(); jsonObject.put(&#34;key&#34;, xyhnConfig.getAppKey()); JSONObject object = new JSONObject(); object.put(&#34;requestData&#34;, jsonObject); object.put(&#34;publicKey&#34;, pubKey); //2ã€å‘é€æŠ¥æ–‡ String jsonRes = callInterface(&#34;report&#34;, &#34;getPublicKey&#34;, object.toJSONString()); //3ã€è§£å¯†è¿”å›æ•°æ® JSONObject json = JSONObject.parseObject(jsonRes); BigInteger d = new BigInteger(xyhnConfig.getPriKey(), 16); BCECPrivateKey bcecPrivateKey = GMUtil.getPrivatekeyFromD(d); String key0 = json.getString(&#34;key&#34;); String data = json.getString(&#34;data&#34;); String signatureData = json.getString(&#34;signatureData&#34;); byte[] decode = Hex.decode(key0); // sm2è§£å¯† byte[] bytes1 = GMUtil.sm2Decrypt(decode, bcecPrivateKey); // sm4è§£å¯† String returnData = GMUtil.sm4Decrypt(new String(bytes1), data); log.info(&#34;returnData:&#34; &#43; returnData); // 4ã€éªŒç­¾ File file = base64ToFileEx(returnData); PublicKey publicKey = GMUtil.getPublickeyFromX509File(file); byte[] signatureData1 = Hex.decode(signatureData); boolean verifyRes = GMUtil.verifySm3WithSm2(returnData.getBytes(), xyhnConfig.getUserId().getBytes(), signatureData1, publicKey); log.info(&#34;getPublicKey æ¥å£éªŒç­¾ç»“æœï¼š&#34; &#43; verifyRes); if (!verifyRes) { return null; } return publicKey; } public static String sendData(String jsonStr, String method) { log.info(&#34;è°ƒç”¨çœå¹³å°æ–¹æ³•åï¼š&#34; &#43; method &#43; &#34;ï¼Œå‚æ•°ï¼š&#34; &#43; jsonStr); try { if (StringUtils.isEmpty(pubKey)) { // è§£æå…¬é’¥ pubKey = convertFileToBase64(xyhnConfig.getPubKeyPath()); } if (reportPublicKey == null) { //è¯·æ±‚æ¥å£ï¼Œè·å–å…¬é’¥ reportPublicKey = getPublicKey(); } // 1ã€æ‘˜è¦ç­¾å sm2withsm3 byte[] msg = jsonStr.getBytes(CharEncoding.ISO_8859_1); byte[] userIdBytes = xyhnConfig.getUserId().getBytes(); BigInteger d = new BigInteger(xyhnConfig.getPriKey(), 16); BCECPrivateKey bcecPrivateKey = GMUtil.getPrivatekeyFromD(d); byte[] sig = GMUtil.signSm3WithSm2(msg, userIdBytes, bcecPrivateKey); String signature = Hex.toHexString(sig); // 2ã€sm4åŠ å¯†æ•°æ®æŠ¥æ–‡ String key1 = RandomUtil.randomString(16); String jsonobj = GMUtil.sm4Encrypt(key1, jsonStr); //3ã€sm2åŠ å¯†16ä½éšæœºç key byte[] datamsg = GMUtil.sm2Encrypt(key1.getBytes(), reportPublicKey); String s = Hex.toHexString(datamsg); //4ã€ç»„è£…å¹¶å‘é€æŠ¥æ–‡ JSONObject jsonObject2 = new JSONObject(); jsonObject2.put(&#34;requestData&#34;, jsonobj); // sm4åŠ å¯†çš„æ•°æ®é›† jsonObject2.put(&#34;key&#34;, s); // sm2åŠ å¯†çš„16ä½éšæœºç  jsonObject2.put(&#34;signatureData&#34;, signature); // ç­¾å jsonObject2.put(&#34;publicKey&#34;, pubKey); // æˆ‘çš„å…¬é’¥ jsonObject2.put(&#34;appKey&#34;, xyhnConfig.getAppKey()); // æ•°æ®æˆæƒçš„key String setFPRes = callInterface(&#34;report&#34;, method, jsonObject2.toJSONString()); return setFPRes; } catch (Exception ex) { log.error(&#34;è¯·æ±‚çœå¹³å°æ¥å£å¼‚å¸¸&#34;, ex); return null; } } /** * è¯·æ±‚æ¥å£ * * @param typeï¼Œreport å›ä¼ æ•°æ®ï¼Œquery æŸ¥è¯¢ * @param method * @param json * @return */ private static String callInterface(String type, String method, String json) { log.info(&#34;è°ƒç”¨çœå¹³å°ç±»å‹:&#34; &#43; type &#43; &#34;ï¼Œæ¥å£ï¼š&#34; &#43; method &#43; &#34;ï¼Œå‚æ•°ï¼š&#34; &#43; json); Client client = null; QName name = null; JaxWsDynamicClientFactory dcf = JaxWsDynamicClientFactory.newInstance(); String result = null; try { if (&#34;report&#34;.equals(type)) { client = dcf.createClient(xyhnConfig.getWsAddr()); name = new QName(xyhnConfig.getNamespaceURI(), method); } else if (&#34;query&#34;.equals(type)) { client = dcf.createClient(xyhnConfig.getQueryWsAddr()); name = new QName(xyhnConfig.getQueryNamespaceURI(), method); } Object[] objects = client.invoke(name, json); result = objects[0].toString(); } catch (Exception e) { log.error(&#34;è°ƒç”¨çœå¹³å°æ¥å£æŠ¥é”™&#34;, e); } finally { if (client != null) { try { client.close(); } catch (Exception e) { log.error(&#34;å…³é—­Clientèµ„æºæ—¶å‘ç”Ÿå¼‚å¸¸&#34;, e); } } } log.info(&#34;è°ƒç”¨çœå¹³å°ç±»å‹:&#34; &#43; type &#43; &#34;ï¼Œæ¥å£ï¼š&#34; &#43; method &#43; &#34;ï¼Œè¿”å›å€¼ï¼š&#34; &#43; result); return result; } private static String convertFileToBase64(String imgPath) { byte[] data = null; // è¯»å–å›¾ç‰‡å­—èŠ‚æ•°ç»„ try (InputStream in = new FileInputStream(imgPath);) { data = new byte[in.available()]; in.read(data); } catch (IOException e) { log.error(&#34;IOException&#34;, e); } // å¯¹å­—èŠ‚æ•°ç»„è¿›è¡ŒBase64ç¼–ç ï¼Œå¾—åˆ°Base64ç¼–ç çš„å­—ç¬¦ä¸² String base64Str = java.util.Base64.getEncoder().encodeToString(data); return base64Str; } private static File base64ToFileEx(String base64) { if (StringUtils.isBlank(base64)) { return null; } byte[] buff = Base64.decode(base64); File file = null; FileOutputStream fout = null; try { file = File.createTempFile(&#34;tmp&#34;, null); fout = new FileOutputStream(file); fout.write(buff); file.deleteOnExit(); } catch (IOException e) { e.printStackTrace(); } finally { if (fout != null) { try { fout.close(); } catch (IOException e) { e.printStackTrace(); } } } return file; } } ç”¨åˆ°çš„å·¥å…·ç±» package cn.bridgeli.demo; import lombok.extern.slf4j.Slf4j; import org.bouncycastle.asn1.ASN1EncodableVector; import org.bouncycastle.asn1.ASN1Integer; import org.bouncycastle.asn1.ASN1Sequence; import org.bouncycastle.asn1.DERSequence; import org.bouncycastle.asn1.gm.GMNamedCurves; import org.bouncycastle.asn1.x9.X9ECParameters; import org.bouncycastle.crypto.InvalidCipherTextException; import org.bouncycastle.crypto.engines.SM2Engine; import org.bouncycastle.crypto.params.ECDomainParameters; import org.bouncycastle.crypto.params.ECPrivateKeyParameters; import org.bouncycastle.crypto.params.ECPublicKeyParameters; import org.bouncycastle.crypto.params.ParametersWithRandom; import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey; import org.bouncycastle.jcajce.provider.asymmetric.ec.BCECPublicKey; import org.bouncycastle.jcajce.spec.SM2ParameterSpec; import org.bouncycastle.jce.provider.BouncyCastleProvider; import org.bouncycastle.jce.spec.ECParameterSpec; import org.bouncycastle.jce.spec.ECPrivateKeySpec; import org.bouncycastle.util.encoders.Hex; import javax.crypto.Cipher; import javax.crypto.spec.SecretKeySpec; import java.io.File; import java.io.FileInputStream; import java.io.IOException; import java.math.BigInteger; import java.nio.charset.StandardCharsets; import java.security.Key; import java.security.PrivateKey; import java.security.PublicKey; import java.security.SecureRandom; import java.security.Security; import java.security.Signature; import java.security.cert.CertificateFactory; import java.security.cert.X509Certificate; import java.util.Arrays; @Slf4j public class GMUtil { private static X9ECParameters x9ECParameters = GMNamedCurves.getByName(&#34;sm2p256v1&#34;); private static ECDomainParameters ecDomainParameters; private static ECParameterSpec ecParameterSpec; public static byte[] signSm3WithSm2(byte[] msg, byte[] userId, PrivateKey privateKey) { return rsAsn1ToPlainByteArray(signSm3WithSm2Asn1Rs(msg, userId, privateKey)); } public static byte[] signSm3WithSm2Asn1Rs(byte[] msg, byte[] userId, PrivateKey privateKey) { try { SM2ParameterSpec parameterSpec = new SM2ParameterSpec(userId); Signature signer = Signature.getInstance(&#34;SM3withSM2&#34;, &#34;BC&#34;); signer.setParameter(parameterSpec); signer.initSign(privateKey, new SecureRandom()); signer.update(msg, 0, msg.length); byte[] sig = signer.sign(); return sig; } catch (Exception e) { throw new RuntimeException(e); } } public static boolean verifySm3WithSm2(byte[] msg, byte[] userId, byte[] rs, PublicKey publicKey) { return verifySm3WithSm2Asn1Rs(msg, userId, rsPlainByteArrayToAsn1(rs), publicKey); } public static boolean verifySm3WithSm2Asn1Rs(byte[] msg, byte[] userId, byte[] rs, PublicKey publicKey) { try { SM2ParameterSpec parameterSpec = new SM2ParameterSpec(userId); Signature verifier = Signature.getInstance(&#34;SM3withSM2&#34;, &#34;BC&#34;); verifier.setParameter(parameterSpec); verifier.initVerify(publicKey); verifier.update(msg, 0, msg.length); return verifier.verify(rs); } catch (Exception e) { throw new RuntimeException(e); } } public static byte[] changeC1C2C3ToC1C3C2(byte[] c1c2c3) { int c1Len = (x9ECParameters.getCurve().getFieldSize() &#43; 7) / 8 * 2 &#43; 1; byte[] result = new byte[c1c2c3.length]; System.arraycopy(c1c2c3, 0, result, 0, c1Len); System.arraycopy(c1c2c3, c1c2c3.length &amp;#8211; 32, result, c1Len, 32); System.arraycopy(c1c2c3, c1Len, result, c1Len &#43; 32, c1c2c3.length &amp;#8211; c1Len &amp;#8211; 32); return result; } public static byte[] changeC1C3C2ToC1C2C3(byte[] c1c3c2) { int c1Len = (x9ECParameters.getCurve().getFieldSize() &#43; 7) / 8 * 2 &#43; 1; byte[] result = new byte[c1c3c2.length]; System.arraycopy(c1c3c2, 0, result, 0, c1Len); System.arraycopy(c1c3c2, c1Len &#43; 32, result, c1Len, c1c3c2.length &amp;#8211; c1Len &amp;#8211; 32); System.arraycopy(c1c3c2, c1Len, result, c1c3c2.length &amp;#8211; 32, 32); return result; } public static byte[] sm2Decrypt(byte[] data, PrivateKey key) { return sm2DecryptOld(changeC1C3C2ToC1C2C3(data), key); } public static byte[] sm2Encrypt(byte[] data, PublicKey key) { return changeC1C2C3ToC1C3C2(sm2EncryptOld(data, key)); } public static byte[] sm2EncryptOld(byte[] data, PublicKey key) { BCECPublicKey localECPublicKey = (BCECPublicKey) key; ECPublicKeyParameters ecPublicKeyParameters = new ECPublicKeyParameters(localECPublicKey.getQ(), ecDomainParameters); SM2Engine sm2Engine = new SM2Engine(); sm2Engine.init(true, new ParametersWithRandom(ecPublicKeyParameters, new SecureRandom())); try { return sm2Engine.processBlock(data, 0, data.length); } catch (InvalidCipherTextException e) { throw new RuntimeException(e); } } public static byte[] sm2DecryptOld(byte[] data, PrivateKey key) { BCECPrivateKey localECPrivateKey = (BCECPrivateKey) key; ECPrivateKeyParameters ecPrivateKeyParameters = new ECPrivateKeyParameters(localECPrivateKey.getD(), ecDomainParameters); SM2Engine sm2Engine = new SM2Engine(); sm2Engine.init(false, ecPrivateKeyParameters); try { return sm2Engine.processBlock(data, 0, data.length); } catch (InvalidCipherTextException e) { throw new RuntimeException(e); } } public static byte[] sm4Encrypt(byte[] keyBytes, byte[] plain) { byte[] keyBytes0; if (keyBytes.length != 16) { keyBytes0 = new byte[16]; for (int i = 0; i &lt; keyBytes0.length; &#43;&#43;i) { if (keyBytes.length &gt; i) { keyBytes0[i] = keyBytes[i]; } } keyBytes = keyBytes0; } if (plain.length % 16 != 0) { keyBytes0 = new byte[16 * (plain.length / 16 &#43; 1)]; System.arraycopy(plain, 0, keyBytes0, 0, plain.length); plain = keyBytes0; } try { Key key = new SecretKeySpec(keyBytes, &#34;SM4&#34;); Cipher out = Cipher.getInstance(&#34;SM4/ECB/NoPadding&#34;, &#34;BC&#34;); out.init(1, key); return out.doFinal(plain); } catch (Exception e) { throw new RuntimeException(e); } } public static byte[] sm4Decrypt(byte[] keyBytes, byte[] cipher) { byte[] keyBytes0; if (keyBytes.length != 16) { keyBytes0 = new byte[16]; for (int i = 0; i &lt; keyBytes0.length; &#43;&#43;i) { if (keyBytes.length &gt; i) { keyBytes0[i] = keyBytes[i]; } } keyBytes = keyBytes0; } if (cipher.length % 16 != 0) { keyBytes0 = new byte[16 * (cipher.length / 16 &#43; 1)]; System.arraycopy(cipher, 0, keyBytes0, 0, cipher.length); cipher = keyBytes0; } try { Key key = new SecretKeySpec(keyBytes, &#34;SM4&#34;); Cipher in = Cipher.getInstance(&#34;SM4/ECB/NoPadding&#34;, &#34;BC&#34;); in.init(2, key); byte[] bytes = in.doFinal(cipher); for (int i = bytes.length &amp;#8211; 1; i &gt;= 0; &amp;#8211;i) { if (bytes[i] != 0) { byte[] bytes1 = new byte[i &#43; 1]; System.arraycopy(bytes, 0, bytes1, 0, i &#43; 1); bytes = bytes1; i = -1; } } return bytes; } catch (Exception e) { throw new RuntimeException(e); } } public static String sm4Encrypt(String key, String plan) { byte[] keyBytes = new byte[16]; byte[] keyBytes0 = key.getBytes(StandardCharsets.UTF_8); for (int i = 0; i &lt; keyBytes.length; &#43;&#43;i) { if (keyBytes0.length &gt; i) { keyBytes[i] = keyBytes0[i]; } } byte[] cipher = plan.getBytes(StandardCharsets.UTF_8); byte[] bytes = sm4Encrypt(keyBytes, cipher); return Hex.toHexString(bytes).toUpperCase(); } public static String sm4Decrypt(String key, String cipher) { byte[] keyBytes = new byte[16]; byte[] keyBytes0 = key.getBytes(StandardCharsets.UTF_8); for (int i = 0; i &lt; keyBytes.length; &#43;&#43;i) { if (keyBytes0.length &gt; i) { keyBytes[i] = keyBytes0[i]; } } byte[] cipherbytes = Hex.decode(cipher); byte[] bytes = sm4Decrypt(keyBytes, cipherbytes); return new String(bytes, StandardCharsets.UTF_8); } private static byte[] bigIntToFixexLengthBytes(BigInteger rOrS) { byte[] rs = rOrS.toByteArray(); if (rs.length == 32) { return rs; } else if (rs.length == 33 &amp;&amp; rs[0] == 0) { return Arrays.copyOfRange(rs, 1, 33); } else if (rs.length &lt; 32) { byte[] result = new byte[32]; Arrays.fill(result, (byte) 0); System.arraycopy(rs, 0, result, 32 &amp;#8211; rs.length, rs.length); return result; } else { throw new RuntimeException(&#34;err rs: &#34; &#43; Hex.toHexString(rs)); } } private static byte[] rsAsn1ToPlainByteArray(byte[] rsDer) { ASN1Sequence seq = ASN1Sequence.getInstance(rsDer); byte[] r = bigIntToFixexLengthBytes(ASN1Integer.getInstance(seq.getObjectAt(0)).getValue()); byte[] s = bigIntToFixexLengthBytes(ASN1Integer.getInstance(seq.getObjectAt(1)).getValue()); byte[] result = new byte[64]; System.arraycopy(r, 0, result, 0, r.length); System.arraycopy(s, 0, result, 32, s.length); return result; } private static byte[] rsPlainByteArrayToAsn1(byte[] sign) { if (sign.length != 64) { throw new RuntimeException(&#34;err rs. &#34;); } else { BigInteger r = new BigInteger(1, Arrays.copyOfRange(sign, 0, 32)); BigInteger s = new BigInteger(1, Arrays.copyOfRange(sign, 32, 64)); ASN1EncodableVector v = new ASN1EncodableVector(); v.add(new ASN1Integer(r)); v.add(new ASN1Integer(s)); try { return (new DERSequence(v)).getEncoded(&#34;DER&#34;); } catch (IOException var5) { throw new RuntimeException(var5); } } } public static BCECPrivateKey getPrivatekeyFromD(BigInteger d) { ECPrivateKeySpec ecPrivateKeySpec = new ECPrivateKeySpec(d, ecParameterSpec); return new BCECPrivateKey(&#34;EC&#34;, ecPrivateKeySpec, BouncyCastleProvider.CONFIGURATION); } public static PublicKey getPublickeyFromX509File(File file) { try { CertificateFactory cf = CertificateFactory.getInstance(&#34;X.509&#34;, &#34;BC&#34;); FileInputStream in = new FileInputStream(file); X509Certificate x509 = (X509Certificate) cf.generateCertificate(in); return x509.getPublicKey(); } catch (Exception var4) { throw new RuntimeException(var4); } } static { ecDomainParameters = new ECDomainParameters(x9ECParameters.getCurve(), x9ECParameters.getG(), x9ECParameters.getN()); ecParameterSpec = new ECParameterSpec(x9ECParameters.getCurve(), x9ECParameters.getG(), x9ECParameters.getN()); if (Security.getProvider(&#34;BC&#34;) == null) { Security.addProvider(new BouncyCastleProvider()); } } } ç›¸å…³é…ç½® package cn.bridgeli.demo; import lombok.Data; import org.springframework.boot.context.properties.ConfigurationProperties; import org.springframework.stereotype.Component; @Data @Component @ConfigurationProperties(prefix = &#34;xyhn&#34;) //@RefreshScope public class XyhnConfig { private String userId; private String platformId; private String appKey; private String priKey; private String wsAddr; private String namespaceURI; private String pubKeyPath; private String queryAppKey; private String queryPriKey; private String queryWsAddr; private String queryNamespaceURI; private String queryPubKeyPath; } ä»¥ä¸Šæ˜¯ä¸ŠæŠ¥å’ŒæŸ¥è¯¢æ•°æ®çš„æ ¸å¿ƒæ–¹æ³•ï¼Œä¸‹é¢æ˜¯æŸ¥è¯¢å…·ä½“æ•°æ®çš„å°è£…
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-24 06:37:18 +0000 +0000'>September 24, 2024</span>&nbsp;Â·&nbsp;<span>13 min</span>&nbsp;Â·&nbsp;<span>2571 words</span>&nbsp;Â·&nbsp;<span>Bridge Li</span></footer>
  <a class="entry-link" aria-label="post link to å…¨å›½ä¸­å°ä¼ä¸šèèµ„ç»¼åˆä¿¡ç”¨æœåŠ¡å¹³å°-çœçº§èŠ‚ç‚¹æ•°æ®æ¥å£è§„èŒƒ-æ²³å—çœè¥å•†ç¯å¢ƒå’Œç¤¾ä¼šä¿¡ç”¨å»ºè®¾ä¸­å¿ƒ" href="http://localhost:1313/posts/2024-09-24-%E5%85%A8%E5%9B%BD%E4%B8%AD%E5%B0%8F%E4%BC%81%E4%B8%9A%E8%9E%8D%E8%B5%84%E7%BB%BC%E5%90%88%E4%BF%A1%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%B9%B3%E5%8F%B0-%E7%9C%81%E7%BA%A7%E8%8A%82%E7%82%B9%E6%95%B0%E6%8D%AE/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ä½¿ç”¨ knife4j å®ç° Swagger æ–‡æ¡£å¢å¼º
    </h2>
  </header>
  <div class="entry-content">
    <p>ç›¸ä¿¡ä½¿ç”¨ Java å¼€å‘çš„äººï¼Œå¯¹ Swagger ä¸€å®šä¸ä¼šæ„Ÿåˆ°é™Œç”Ÿï¼Œä¸è¿‡ä¸ªäººå¯¹ Swagger ä¸€ç›´æ²¡æœ‰å¤ªå¤šå¥½æ„Ÿï¼Œå› ä¸ºä»–çš„ UI å®åœ¨å¤ªéš¾çœ‹äº†ï¼Œç”¨èµ·æ¥ä¹Ÿé¢‡ä¸ºä¸é¡ºæ‰‹ï¼Œæ‰€ä»¥å›½å†…æœ‰äººå¼€å‘äº† knife4j å¯¹ Swagger è¿›è¡Œå¢å¼ºï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œç°åœ¨å¾ˆå¤šé¡¹ç›®éƒ½åœ¨ä» Java8 åˆ° Java17ï¼ŒSpringBoot2 åˆ° SpringBoot3 çš„è¿ç§»ï¼Œå‘ç° knife4j ç°åœ¨ä¹Ÿå¼€å§‹åšäº†æ”¯æŒï¼Œè€Œä¸”ç”¨èµ·æ¥æ›´æ–¹ä¾¿ã€‚ä¸‹é¢ç®€å•è¯´ä¸€è¯´å¦‚ä½•ä½¿ç”¨ã€‚
å¼•å…¥ä¾èµ– &lt;dependency&gt; &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt; &lt;artifactId&gt;knife4j-openapi3-jakarta-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;4.5.0&lt;/version&gt; &lt;/dependency&gt; ä»ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ° artifactId åšäº†å…¨æ–°çš„ä¿®æ”¹ï¼Œè¿™ä¸ªéœ€è¦æ³¨æ„ã€‚å¦å¤– Spring Boot 3 åªæ”¯æŒ OpenAPI3 è§„èŒƒã€‚Knife4jæä¾›çš„ starter å·²ç»å¼•ç”¨ springdoc-openapi çš„ jarï¼Œå¤§å®¶éœ€æ³¨æ„é¿å… jar åŒ…å†²çªï¼Œå¼•å…¥ä¹‹åï¼Œå…¶ä½™çš„é…ç½®ï¼Œå¼€å‘è€…å³å¯å®Œå…¨å‚è€ƒ springdoc-openapi çš„é¡¹ç›®è¯´æ˜ï¼ŒKnife4j åªæä¾›äº†å¢å¼ºéƒ¨åˆ†ï¼Œå¦‚æœè¦å¯ç”¨ Knife4j çš„å¢å¼ºåŠŸèƒ½ï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œå¼€å¯ï¼Œå…¶å®ä¸ªäººæµ‹è¯•å°±ç®—å®Œå…¨ä¸é…ç½®ï¼Œæ­¤æ—¶ä¹Ÿå·²ç»å¯ä»¥é€šè¿‡ http://ip:port/doc.html æŸ¥çœ‹æ–‡æ¡£ï¼š
knife4j: enable: true basic: enable: true username: BridgeLi password: BridgeLi springdoc: default-flat-param-object: true æœ€åï¼Œä½¿ç”¨ OpenAPI3 çš„è§„èŒƒæ³¨è§£ï¼Œæ³¨é‡Šå„ä¸ª Spring çš„ Rest æ¥å£ã€‚
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-06-10 05:56:21 +0000 +0000'>June 10, 2024</span>&nbsp;Â·&nbsp;<span>1 min</span>&nbsp;Â·&nbsp;<span>205 words</span>&nbsp;Â·&nbsp;<span>Bridge Li</span></footer>
  <a class="entry-link" aria-label="post link to ä½¿ç”¨ knife4j å®ç° Swagger æ–‡æ¡£å¢å¼º" href="http://localhost:1313/posts/2024-06-10-%E4%BD%BF%E7%94%A8-knife4j-%E5%AE%9E%E7%8E%B0-swagger-%E6%96%87%E6%A1%A3%E5%A2%9E%E5%BC%BA/"></a>
</article>

<article class="post-entry tag-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">å¦‚ä½•æ„å»ºä¸€ä¸ªå¯é‡å¤è¯»æµ InputStream çš„ HttpServletRequestï¼Ÿ
    </h2>
  </header>
  <div class="entry-content">
    <p>ä¹‹å‰åœ¨æŸå…¬å¸å·¥ä½œçš„æ—¶å€™ï¼Œé¢†å¯¼è¦æ±‚æ‰€æœ‰å‰ç«¯å‘åç«¯ä¼ é€’çš„å‚æ•°éƒ½è¦ç»è¿‡å‰ç«¯åŠ å¯†ï¼Œåç«¯è§£å¯†ã€‚è¯´ä¸€å¥é¢˜å¤–è¯ï¼šä¸ªäººè®¤ä¸ºè¿™ç§æ“ä½œçº¯å±è„±è£¤å­æ”¾å±ï¼Œæ²¡å•¥ç”¨ã€‚å› ä¸ºå‰ç«¯ä»£ç éƒ½æ˜¯å…¬å¼€çš„ï¼Œæ— è®ºä½ é‡‡ç”¨å¯¹ç§°åŠ å¯†ã€éå¯¹ç§°åŠ å¯†ï¼Œæˆ–è€…æ‘˜è¦ç®—æ³•éªŒç­¾ç­‰ç­‰ï¼Œå¯¹äºç¨æ‡‚æŠ€æœ¯çš„äººæ¥è¯´ï¼Œç¨ç¨åˆ†æä¸€ä¸‹å°±èƒ½æ‰¾åˆ°å‰ç«¯åŠ å¯†çš„æ–¹æ³•ï¼Œç„¶åç›´æ¥ç”¨ç›¸åŒçš„æ–¹å¼åŠ å¯†å°±è¡Œï¼Œæ‰€ä»¥è¿™å°±æ˜¯éšœçœ¼æ³•ï¼Œåªèƒ½éª—éª—ä¸æ‡‚æŠ€æœ¯çš„äººã€‚ä¸è¿‡é¢†å¯¼çš„è¦æ±‚å—ï¼Œæ—¢ç„¶å®šä¸‹æ¥äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€»è¦æœä»ã€‚å› ä¸ºæ¯ä¸ªæ–¹æ³•éƒ½éœ€è¦æœ‰è¿™ä¸ªè§£å¯†æˆ–è€…éªŒç­¾çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬è‡ªç„¶è€Œç„¶æƒ³è¦åˆ°äº†é€šè¿‡ Filterã€Interceptor æˆ–è€… AOP ç­‰æŠ€æœ¯ç»Ÿä¸€æ¥åšï¼Œä¸å¯èƒ½åœ¨å„ä¸ªæ–¹æ³•ä¸­åšè¿™ä»¶äº‹ï¼Œåœ¨ä½†æ˜¯æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå¯¹äº postã€put ç­‰è¯·æ±‚ï¼Œå‚æ•°éƒ½æ˜¯æ”¾åœ¨è¯·æ±‚ä½“ä¸­çš„ï¼Œéœ€è¦é€šè¿‡æµè¯»å‡ºæ¥ï¼Œè€Œæµæ˜¯ä¸å¯ä»¥é‡å¤è¯»çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥æ€ä¹ˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¥æ„é€ ä¸€ä¸ªå¯ä»¥é‡å¤è¯»æµ InputStream çš„ HttpServletRequestã€‚
è§£å†³æ–¹æ³•ï¼šä½¿ç”¨è‡ªå®šä¹‰ç±»æ¥ç¼“å­˜ stream å³å¯ RequestWrapper ç±»ï¼šç¼“å­˜å­—èŠ‚æ•°æ®
package cn.bridgeli.filter; import cn.bridgeli.utils.http.HttpHelper; import javax.servlet.ReadListener; import javax.servlet.ServletInputStream; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletRequestWrapper; import java.io.BufferedReader; import java.io.ByteArrayInputStream; import java.io.IOException; import java.io.InputStreamReader; import java.nio.charset.StandardCharsets; /** * æ„å»ºå¯é‡å¤è¯»å–inputStreamçš„request * * @author BridgeLi */ public class RepeatedlyRequestWrapper extends HttpServletRequestWrapper { private final byte[] body; public RepeatedlyRequestWrapper(HttpServletRequest request) { super(request); body = HttpHelper.getBodyString(request).getBytes(StandardCharsets.UTF_8); } @Override public BufferedReader getReader() throws IOException { return new BufferedReader(new InputStreamReader(getInputStream())); } @Override public ServletInputStream getInputStream() throws IOException { final ByteArrayInputStream bais = new ByteArrayInputStream(body); return new ServletInputStream() { @Override public int read() throws IOException { return bais.read(); } @Override public int available() throws IOException { return body.length; } @Override public boolean isFinished() { return false; } @Override public boolean isReady() { return false; } @Override public void setReadListener(ReadListener readListener) { } }; } } package cn.bridgeli.utils.http; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import javax.servlet.ServletRequest; import java.io.BufferedReader; import java.io.IOException; import java.io.InputStream; import java.io.InputStreamReader; import java.nio.charset.StandardCharsets; /** * é€šç”¨httpå·¥å…·å°è£… * * @author BridgeLi */ public class HttpHelper { private static final Logger LOGGER = LoggerFactory.getLogger(HttpHelper.class); public static String getBodyString(ServletRequest request) { StringBuilder sb = new StringBuilder(); try (InputStream inputStream = request.getInputStream()) { BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, StandardCharsets.UTF_8)); String line = &#34;&#34;; while ((line = reader.readLine()) != null) { sb.append(line); } } catch (IOException e) { LOGGER.error(&#34;getBodyStringå‡ºç°é—®é¢˜ï¼&#34;, e); } return sb.toString(); } } ç„¶åï¼Œå¯ä»¥åœ¨ Servlet æˆ– Filter ä¸­ä½¿ç”¨ RepeatableFilter æ›¿æ¢åŸå§‹çš„ HttpServletRequestã€‚
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-05-03 11:48:02 +0000 +0000'>May 3, 2024</span>&nbsp;Â·&nbsp;<span>2 min</span>&nbsp;Â·&nbsp;<span>343 words</span>&nbsp;Â·&nbsp;<span>Bridge Li</span></footer>
  <a class="entry-link" aria-label="post link to å¦‚ä½•æ„å»ºä¸€ä¸ªå¯é‡å¤è¯»æµ InputStream çš„ HttpServletRequestï¼Ÿ" href="http://localhost:1313/posts/2024-05-03-%E5%A6%82%E4%BD%95%E6%9E%84%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%8F%AF%E9%87%8D%E5%A4%8D%E8%AF%BB%E6%B5%81-inputstream-%E7%9A%84-httpservletrequest/"></a>
</article>
<footer class="page-footer">
  <nav class="pagination">
    <a class="next" href="http://localhost:1313/categories/java/page/2/">Next&nbsp;&nbsp;Â»
    </a>
  </nav>
</footer>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="http://localhost:1313/">åˆ†äº«æŠ€æœ¯å¸¦æ¥çš„å–œæ‚¦</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
